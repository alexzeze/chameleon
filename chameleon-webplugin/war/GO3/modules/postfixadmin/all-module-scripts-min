GO.postfixadmin.AliasesGrid=function(A){if(!A){A={}}A.title=GO.postfixadmin.lang.aliases;A.layout="fit";A.autoScroll=true;A.split=true;A.store=new GO.data.JsonStore({url:GO.settings.modules.postfixadmin.url+"json.php",baseParams:{task:"aliases"},root:"results",id:"id",totalProperty:"total",fields:["id","address","goto","ctime","mtime","active"],remoteSort:true});A.disabled=true;A.paging=true;var B=new Ext.grid.ColumnModel([{header:GO.postfixadmin.lang.address,dataIndex:"address"},{header:GO.postfixadmin.lang.goto_address,dataIndex:"goto"},{header:GO.lang.strCtime,dataIndex:"ctime"},{header:GO.lang.strMtime,dataIndex:"mtime"},{header:GO.postfixadmin.lang.active,dataIndex:"active"}]);B.defaultSortable=true;A.cm=B;A.view=new Ext.grid.GridView({autoFill:true,forceFit:true,emptyText:GO.lang.strNoItems});A.sm=new Ext.grid.RowSelectionModel();A.loadMask=true;this.aliasDialog=new GO.postfixadmin.AliasDialog();this.aliasDialog.on("save",function(){this.store.reload()},this);A.tbar=[{iconCls:"btn-add",text:GO.lang.cmdAdd,cls:"x-btn-text-icon",handler:function(){this.aliasDialog.show()},scope:this},{iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.deleteSelected()},scope:this}];GO.postfixadmin.AliasesGrid.superclass.constructor.call(this,A);this.on("rowdblclick",function(D,E){var C=D.getStore().getAt(E);this.aliasDialog.show(C.data.id)},this)};Ext.extend(GO.postfixadmin.AliasesGrid,GO.grid.GridPanel,{onShow:function(){this.store.load();GO.postfixadmin.AliasesGrid.superclass.onShow.call(this)},setDomainId:function(A){this.store.baseParams.domain_id=A;this.store.loaded=false;this.aliasDialog.formPanel.baseParams.domain_id=A;this.setDisabled(A<1)}});GO.postfixadmin.AliasDialog=function(B){if(!B){B={}}this.buildForm();var A=function(){this.propertiesPanel.items.items[0].focus()};B.maximizable=true;B.layout="fit";B.modal=false;B.resizable=false;B.width=700;B.height=500;B.closeAction="hide";B.title=GO.postfixadmin.lang.alias;B.items=this.formPanel;B.focus=A.createDelegate(this);B.buttons=[{text:GO.lang.cmdOk,handler:function(){this.submitForm(true)},scope:this},{text:GO.lang.cmdApply,handler:function(){this.submitForm()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];GO.postfixadmin.AliasDialog.superclass.constructor.call(this,B);this.addEvents({save:true})};Ext.extend(GO.postfixadmin.AliasDialog,Ext.Window,{show:function(B,A){if(!this.rendered){this.render(Ext.getBody())}this.tabPanel.setActiveTab(0);if(!B){B=0}this.setAliasId(B);if(this.alias_id>0){this.formPanel.load({url:GO.settings.modules.postfixadmin.url+"json.php",success:function(C,D){GO.postfixadmin.AliasDialog.superclass.show.call(this)},failure:function(C,D){Ext.Msg.alert(GO.lang.strError,D.result.feedback)},scope:this})}else{this.formPanel.form.reset();GO.postfixadmin.AliasDialog.superclass.show.call(this)}},setAliasId:function(A){this.formPanel.form.baseParams.alias_id=A;this.alias_id=A},submitForm:function(A){this.formPanel.form.submit({url:GO.settings.modules.postfixadmin.url+"action.php",params:{task:"save_alias"},waitMsg:GO.lang.waitMsgSave,success:function(B,C){this.fireEvent("save",this);if(A){this.hide()}else{if(C.result.alias_id){this.setAliasId(C.result.alias_id)}}},failure:function(B,C){if(C.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,C.result.feedback)}},scope:this})},buildForm:function(){this.propertiesPanel=new Ext.Panel({title:GO.lang.strProperties,cls:"go-form-panel",waitMsgTarget:true,layout:"form",autoScroll:true,items:[{xtype:"textfield",name:"address",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.address},{xtype:"textarea",name:"goto",anchor:"-20",allowBlank:true,fieldLabel:GO.postfixadmin.lang.goto_address},{xtype:"checkbox",name:"active",anchor:"-20",allowBlank:false,boxLabel:GO.postfixadmin.lang.active,hideLabel:true}]});var A=[this.propertiesPanel];this.tabPanel=new Ext.TabPanel({activeTab:0,deferredRender:false,border:false,items:A,anchor:"100% 100%"});this.formPanel=new Ext.form.FormPanel({waitMsgTarget:true,url:GO.settings.modules.postfixadmin.url+"action.php",border:false,baseParams:{task:"alias"},items:this.tabPanel})}});GO.postfixadmin.DomainsGrid=function(A){if(!A){A={}}A.layout="fit";A.autoScroll=true;A.split=true;A.store=new GO.data.JsonStore({url:GO.settings.modules.postfixadmin.url+"json.php",baseParams:{task:"domains"},root:"results",id:"id",totalProperty:"total",fields:["id","user_name","domain","description","aliases","mailboxes","maxquota","quota","transport","backupmx","ctime","mtime","active","acl_read","acl_write"],remoteSort:true});A.paging=true;var B=new Ext.grid.ColumnModel([{header:GO.postfixadmin.lang.domain,dataIndex:"domain"},{header:GO.lang.strOwner,dataIndex:"user_name",sortable:false},{header:GO.lang.strDescription,dataIndex:"description"},{header:GO.postfixadmin.lang.aliases,dataIndex:"aliases"},{header:GO.postfixadmin.lang.mailboxes,dataIndex:"mailboxes"},{header:GO.postfixadmin.lang.maxquota,dataIndex:"maxquota"},{header:GO.postfixadmin.lang.quota,dataIndex:"quota"},{header:GO.postfixadmin.lang.active,dataIndex:"active"},{header:GO.postfixadmin.lang.backupmx,dataIndex:"backupmx"},{header:GO.lang.strCtime,dataIndex:"ctime"},{header:GO.lang.strMtime,dataIndex:"mtime"}]);B.defaultSortable=true;A.cm=B;A.view=new Ext.grid.GridView({autoFill:true,forceFit:true,emptyText:GO.lang.strNoItems});A.sm=new Ext.grid.RowSelectionModel();A.loadMask=true;GO.postfixadmin.domainDialog=this.domainDialog=new GO.postfixadmin.DomainDialog();this.domainDialog.on("save",function(){this.store.reload()},this);this.searchField=new GO.form.SearchField({store:A.store,width:320});if(GO.settings.modules.postfixadmin.write_permission){A.tbar=new Ext.Toolbar({cls:"go-head-tb",items:[{iconCls:"btn-add",text:GO.lang.cmdAdd,cls:"x-btn-text-icon",handler:function(){this.domainDialog.show()},scope:this},{iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.deleteSelected()},scope:this},GO.lang.strSearch+": "," ",this.searchField]})}GO.postfixadmin.DomainsGrid.superclass.constructor.call(this,A);this.on("rowdblclick",function(D,E){var C=D.getStore().getAt(E);this.domainDialog.show(C.data.id)},this)};Ext.extend(GO.postfixadmin.DomainsGrid,GO.grid.GridPanel,{afterRender:function(){this.store.load();GO.postfixadmin.DomainsGrid.superclass.afterRender.call(this)}});GO.postfixadmin.DomainDialog=function(B){if(!B){B={}}this.buildForm();var A=function(){this.propertiesPanel.items.items[0].focus()};B.maximizable=true;B.layout="fit";B.modal=false;B.resizable=false;B.width=700;B.height=500;B.closeAction="hide";B.title=GO.postfixadmin.lang.domain;B.items=this.formPanel;B.focus=A.createDelegate(this);B.buttons=[{text:GO.lang.cmdOk,handler:function(){this.submitForm(true)},scope:this},{text:GO.lang.cmdApply,handler:function(){this.submitForm()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];GO.postfixadmin.DomainDialog.superclass.constructor.call(this,B);this.addEvents({save:true})};Ext.extend(GO.postfixadmin.DomainDialog,Ext.Window,{show:function(A,B){if(!this.rendered){this.render(Ext.getBody())}this.tabPanel.setActiveTab(0);if(!A){A=0}this.setDomainId(A);if(this.domain_id>0){this.formPanel.load({url:GO.settings.modules.postfixadmin.url+"json.php",success:function(C,D){if(GO.settings.modules.postfixadmin.write_permission){this.readPermissionsTab.setAcl(D.result.data.acl_read);this.writePermissionsTab.setAcl(D.result.data.acl_write)}this.setBackupMX(D.result.data.backupmx=="1");this.selectUser.setRemoteText(D.result.data.user_name);GO.postfixadmin.DomainDialog.superclass.show.call(this)},failure:function(C,D){Ext.Msg.alert(GO.lang.strError,D.result.feedback)},scope:this})}else{this.formPanel.form.reset();this.readPermissionsTab.setAcl(0);this.writePermissionsTab.setAcl(0);GO.postfixadmin.DomainDialog.superclass.show.call(this)}},setDomainId:function(A){this.formPanel.form.baseParams.domain_id=A;this.domain_id=A;this.mailboxesGrid.setDomainId(A);this.aliasesGrid.setDomainId(A)},submitForm:function(A){this.formPanel.form.submit({url:GO.settings.modules.postfixadmin.url+"action.php",params:{task:"save_domain"},waitMsg:GO.lang.waitMsgSave,success:function(B,C){this.fireEvent("save",this);if(A){this.hide()}else{if(C.result.domain_id){this.setDomainId(C.result.domain_id);this.mailboxesGrid.setDisabled(this.formPanel.form.findField("backupmx").getValue());this.aliasesGrid.setDisabled(this.formPanel.form.findField("backupmx").getValue());this.readPermissionsTab.setAcl(C.result.acl_read);this.writePermissionsTab.setAcl(C.result.acl_write)}}},failure:function(B,C){if(C.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,C.result.feedback)}},scope:this})},setBackupMX:function(A){this.mailboxesGrid.setDisabled(A||!this.domain_id);this.aliasesGrid.setDisabled(A||!this.domain_id);var B=this.formPanel.form;B.findField("aliases").setDisabled(A);B.findField("mailboxes").setDisabled(A);B.findField("maxquota").setDisabled(A);B.findField("quota").setDisabled(A)},buildForm:function(){this.propertiesPanel=new Ext.Panel({title:GO.lang.strProperties,cls:"go-form-panel",waitMsgTarget:true,layout:"form",autoScroll:true,items:[this.selectUser=new GO.form.SelectUser({fieldLabel:GO.lang.strUser,disabled:!GO.settings.modules.postfixadmin["write_permission"],value:GO.settings.user_id,anchor:"-20"}),{xtype:"textfield",name:"domain",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.domain},{xtype:"textfield",name:"description",anchor:"-20",fieldLabel:GO.lang.strDescription},new GO.form.NumberField({decimals:"0",disabled:!GO.settings.modules.postfixadmin.write_permission,name:"aliases",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.aliases,value:"0"}),new GO.form.NumberField({decimals:"0",disabled:!GO.settings.modules.postfixadmin.write_permission,name:"mailboxes",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.mailboxes,value:"0"}),this.maxQuotaField=new GO.form.NumberField({decimals:"0",disabled:!GO.settings.modules.postfixadmin.write_permission,name:"maxquota",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.maxquota,value:"0"}),this.quotaField=new GO.form.NumberField({decimals:"0",name:"quota",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.defaultQuota,value:"0"}),{xtype:"checkbox",name:"active",anchor:"-20",allowBlank:false,boxLabel:GO.postfixadmin.lang.active,hideLabel:true,checked:true},{xtype:"checkbox",name:"backupmx",anchor:"-20",allowBlank:false,boxLabel:GO.postfixadmin.lang.backupmx,hideLabel:true,listeners:{check:function(B,C){this.setBackupMX(C)},scope:this}}]});var A=[this.propertiesPanel];this.mailboxesGrid=new GO.postfixadmin.MailboxesGrid();A.push(this.mailboxesGrid);this.aliasesGrid=new GO.postfixadmin.AliasesGrid();A.push(this.aliasesGrid);this.readPermissionsTab=new GO.grid.PermissionsPanel({title:GO.lang.strReadPermissions});this.writePermissionsTab=new GO.grid.PermissionsPanel({title:GO.lang.strWritePermissions});A.push(this.readPermissionsTab);A.push(this.writePermissionsTab);this.tabPanel=new Ext.TabPanel({activeTab:0,deferredRender:false,border:false,items:A,anchor:"100% 100%"});this.formPanel=new Ext.form.FormPanel({waitMsgTarget:true,url:GO.settings.modules.postfixadmin.url+"action.php",border:false,baseParams:{task:"domain"},items:this.tabPanel})}});GO.postfixadmin.FetchmailConfigsGrid=function(A){if(!A){A={}}A.title=GO.postfixadmin.lang.fetchmailConfigs;A.layout="fit";A.autoScroll=true;A.split=true;A.store=new GO.data.JsonStore({url:GO.settings.modules.postfixadmin.url+"json.php",baseParams:{task:"fetchmail_configs"},root:"results",id:"id",totalProperty:"total",fields:["id","mailbox","src_server","src_auth","src_user","src_password","src_folder","poll_time","fetchall","keep","protocol","extra_options","returned_text","mda","date"],remoteSort:true});A.paging=true;var B=new Ext.grid.ColumnModel([{header:GO.postfixadmin.lang.mailbox,dataIndex:"mailbox"},{header:GO.postfixadmin.lang.srcServer,dataIndex:"src_server"},{header:GO.postfixadmin.lang.srcAuth,dataIndex:"src_auth"},{header:GO.postfixadmin.lang.srcUser,dataIndex:"src_user"},{header:GO.postfixadmin.lang.srcPassword,dataIndex:"src_password"},{header:GO.postfixadmin.lang.srcFolder,dataIndex:"src_folder"},{header:GO.postfixadmin.lang.pollTime,dataIndex:"poll_time"},{header:GO.postfixadmin.lang.fetchall,dataIndex:"fetchall"},{header:GO.postfixadmin.lang.keep,dataIndex:"keep"},{header:GO.postfixadmin.lang.protocol,dataIndex:"protocol"},{header:GO.postfixadmin.lang.extraOptions,dataIndex:"extra_options"},{header:GO.postfixadmin.lang.returnedText,dataIndex:"returned_text"},{header:GO.postfixadmin.lang.mda,dataIndex:"mda"},{header:GO.postfixadmin.lang.date,dataIndex:"date"}]);B.defaultSortable=true;A.cm=B;A.view=new Ext.grid.GridView({autoFill:true,forceFit:true,emptyText:GO.lang.strNoItems});A.sm=new Ext.grid.RowSelectionModel();A.loadMask=true;this.fetchmailConfigDialog=new GO.postfixadmin.FetchmailConfigDialog();this.fetchmailConfigDialog.on("save",function(){this.store.reload()},this);A.tbar=[{iconCls:"btn-add",text:GO.lang.cmdAdd,cls:"x-btn-text-icon",handler:function(){this.fetchmailConfigDialog.show()},scope:this},{iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.deleteSelected()},scope:this}];GO.postfixadmin.FetchmailConfigsGrid.superclass.constructor.call(this,A);this.on("rowdblclick",function(D,E){var C=D.getStore().getAt(E);this.fetchmailConfigDialog.show(C.data.id)},this)};Ext.extend(GO.postfixadmin.FetchmailConfigsGrid,GO.grid.GridPanel,{});GO.postfixadmin.FetchmailConfigDialog=function(B){if(!B){B={}}this.buildForm();var A=function(){this.propertiesPanel.items.items[0].focus()};B.maximizable=true;B.layout="fit";B.modal=false;B.resizable=false;B.width=700;B.height=500;B.closeAction="hide";B.title=GO.postfixadmin.lang.fetchmailConfig;B.items=this.formPanel;B.focus=A.createDelegate(this);B.buttons=[{text:GO.lang.cmdOk,handler:function(){this.submitForm(true)},scope:this},{text:GO.lang.cmdApply,handler:function(){this.submitForm()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];GO.postfixadmin.FetchmailConfigDialog.superclass.constructor.call(this,B);this.addEvents({save:true})};Ext.extend(GO.postfixadmin.FetchmailConfigDialog,Ext.Window,{show:function(B,A){if(!this.rendered){this.render(Ext.getBody())}this.tabPanel.setActiveTab(0);if(!B){B=0}this.setFetchmailConfigId(B);if(this.fetchmail_config_id>0){this.formPanel.load({url:GO.settings.modules.postfixadmin.url+"json.php",success:function(C,D){GO.postfixadmin.FetchmailConfigDialog.superclass.show.call(this)},failure:function(C,D){Ext.Msg.alert(GO.lang.strError,D.result.feedback)},scope:this})}else{this.formPanel.form.reset();GO.postfixadmin.FetchmailConfigDialog.superclass.show.call(this)}},setFetchmailConfigId:function(A){this.formPanel.form.baseParams.fetchmail_config_id=A;this.fetchmail_config_id=A},submitForm:function(A){this.formPanel.form.submit({url:GO.settings.modules.postfixadmin.url+"action.php",params:{task:"save_fetchmail_config"},waitMsg:GO.lang.waitMsgSave,success:function(B,C){this.fireEvent("save",this);if(A){this.hide()}else{if(C.result.fetchmail_config_id){this.setFetchmailConfigId(C.result.fetchmail_config_id)}}},failure:function(B,C){if(C.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,C.result.feedback)}},scope:this})},buildForm:function(){this.propertiesPanel=new Ext.Panel({title:GO.lang.strProperties,cls:"go-form-panel",waitMsgTarget:true,layout:"form",autoScroll:true,items:[{xtype:"textfield",name:"mailbox",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.mailbox},{xtype:"textfield",name:"src_server",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.srcServer},{xtype:"textfield",name:"src_auth",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.srcAuth},{xtype:"textfield",name:"src_user",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.srcUser},{xtype:"textfield",name:"src_password",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.srcPassword},{xtype:"textfield",name:"src_folder",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.srcFolder},{xtype:"textfield",name:"poll_time",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.pollTime},{xtype:"textfield",name:"fetchall",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.fetchall},{xtype:"textfield",name:"keep",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.keep},{xtype:"textfield",name:"protocol",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.protocol},{xtype:"textarea",name:"extra_options",anchor:"-20",allowBlank:true,fieldLabel:GO.postfixadmin.lang.extraOptions},{xtype:"textarea",name:"returned_text",anchor:"-20",allowBlank:true,fieldLabel:GO.postfixadmin.lang.returnedText},{xtype:"textfield",name:"mda",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.mda},{xtype:"textfield",name:"date",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.date}]});var A=[this.propertiesPanel];this.tabPanel=new Ext.TabPanel({activeTab:0,deferredRender:false,border:false,items:A,anchor:"100% 100%"});this.formPanel=new Ext.form.FormPanel({waitMsgTarget:true,url:GO.settings.modules.postfixadmin.url+"action.php",border:false,baseParams:{task:"fetchmail_config"},items:this.tabPanel})}});GO.postfixadmin.MailboxesGrid=function(A){if(!A){A={}}A.title=GO.postfixadmin.lang.mailboxes;A.layout="fit";A.autoScroll=true;A.split=true;A.store=new GO.data.JsonStore({url:GO.settings.modules.postfixadmin.url+"json.php",baseParams:{task:"mailboxes"},root:"results",id:"id",totalProperty:"total",fields:["id","username","name","quota","ctime","mtime","active"],remoteSort:true});A.disabled=true;A.paging=true;var B=new Ext.grid.ColumnModel([{header:GO.postfixadmin.lang.username,dataIndex:"username"},{header:GO.lang.strName,dataIndex:"name"},{header:GO.postfixadmin.lang.quota,dataIndex:"quota"},{header:GO.lang.strCtime,dataIndex:"ctime"},{header:GO.lang.strMtime,dataIndex:"mtime"},{header:GO.postfixadmin.lang.active,dataIndex:"active"}]);B.defaultSortable=true;A.cm=B;A.view=new Ext.grid.GridView({autoFill:true,forceFit:true,emptyText:GO.lang.strNoItems});A.sm=new Ext.grid.RowSelectionModel();A.loadMask=true;this.mailboxDialog=new GO.postfixadmin.MailboxDialog();this.mailboxDialog.on("save",function(){this.store.reload()},this);A.tbar=[{iconCls:"btn-add",text:GO.lang.cmdAdd,cls:"x-btn-text-icon",handler:function(){this.mailboxDialog.show();this.mailboxDialog.formPanel.form.findField("quota").setValue(GO.postfixadmin.domainDialog.quotaField.getValue())},scope:this},{iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.deleteSelected()},scope:this}];GO.postfixadmin.MailboxesGrid.superclass.constructor.call(this,A);this.on("rowdblclick",function(D,E){var C=D.getStore().getAt(E);this.mailboxDialog.show(C.data.id)},this)};Ext.extend(GO.postfixadmin.MailboxesGrid,GO.grid.GridPanel,{onShow:function(){if(!this.store.loaded){this.store.load()}GO.postfixadmin.MailboxesGrid.superclass.onShow.call(this)},setDomainId:function(A){this.store.baseParams.domain_id=A;this.store.loaded=false;this.mailboxDialog.formPanel.baseParams.domain_id=A;this.setDisabled(A<1)}});GO.postfixadmin.MailboxDialog=function(B){if(!B){B={}}this.buildForm();var A=function(){this.propertiesPanel.items.items[0].focus()};B.maximizable=true;B.layout="fit";B.modal=false;B.resizable=false;B.width=700;B.height=500;B.closeAction="hide";B.title=GO.postfixadmin.lang.mailbox;B.items=this.formPanel;B.focus=A.createDelegate(this);B.buttons=[{text:GO.lang.cmdOk,handler:function(){this.submitForm(true)},scope:this},{text:GO.lang.cmdApply,handler:function(){this.submitForm()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];GO.postfixadmin.MailboxDialog.superclass.constructor.call(this,B);this.addEvents({save:true})};Ext.extend(GO.postfixadmin.MailboxDialog,Ext.Window,{show:function(B,A){if(!this.rendered){this.render(Ext.getBody())}this.tabPanel.setActiveTab(0);if(!B){B=0}this.setMailboxId(B);if(this.mailbox_id>0){this.formPanel.load({url:GO.settings.modules.postfixadmin.url+"json.php",success:function(C,D){GO.postfixadmin.MailboxDialog.superclass.show.call(this)},failure:function(C,D){Ext.Msg.alert(GO.lang.strError,D.result.feedback)},scope:this})}else{this.formPanel.form.reset();GO.postfixadmin.MailboxDialog.superclass.show.call(this)}},setMailboxId:function(A){this.formPanel.form.baseParams.mailbox_id=A;this.mailbox_id=A;this.formPanel.form.findField("username").setDisabled(A>0);this.formPanel.form.findField("password1").allowBlank=A>0;this.formPanel.form.findField("password2").allowBlank=A>0},submitForm:function(A){this.formPanel.form.submit({url:GO.settings.modules.postfixadmin.url+"action.php",params:{task:"save_mailbox"},waitMsg:GO.lang.waitMsgSave,success:function(B,C){this.fireEvent("save",this);if(A){this.hide()}else{if(C.result.mailbox_id){this.setMailboxId(C.result.mailbox_id)}}},failure:function(B,C){if(C.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,C.result.feedback)}},scope:this})},buildForm:function(){this.propertiesPanel=new Ext.Panel({title:GO.lang.strProperties,cls:"go-form-panel",waitMsgTarget:true,layout:"form",autoScroll:true,labelWidth:150,items:[{xtype:"textfield",name:"username",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.username},{xtype:"textfield",inputType:"password",name:"password1",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.password},{xtype:"textfield",inputType:"password",name:"password2",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.confirmPassword},{xtype:"textfield",name:"name",anchor:"-20",fieldLabel:GO.lang.strName},new GO.form.NumberField({decimals:"0",name:"quota",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.quota,value:0}),{xtype:"checkbox",name:"active",anchor:"-20",allowBlank:false,boxLabel:GO.postfixadmin.lang.active,hideLabel:true,checked:true}]});var A=[this.propertiesPanel];this.vacationPanel=new Ext.Panel({title:GO.postfixadmin.lang.vacation,cls:"go-form-panel",waitMsgTarget:true,layout:"form",autoScroll:true,items:[{xtype:"checkbox",name:"vacation_active",anchor:"-20",boxLabel:GO.postfixadmin.lang.vacationActive,hideLabel:true},{xtype:"textfield",name:"vacation_subject",anchor:"-20",fieldLabel:GO.postfixadmin.lang.subject},{xtype:"textarea",name:"vacation_body",anchor:"-20",fieldLabel:GO.postfixadmin.lang.body}]});A.push(this.vacationPanel);this.tabPanel=new Ext.TabPanel({activeTab:0,deferredRender:false,border:false,items:A,anchor:"100% 100%"});this.formPanel=new Ext.form.FormPanel({waitMsgTarget:true,url:GO.settings.modules.postfixadmin.url+"action.php",border:false,baseParams:{task:"mailbox"},items:this.tabPanel})}});GO.postfixadmin.VacationConfigsGrid=function(A){if(!A){A={}}A.title=GO.postfixadmin.lang.vacationConfigs;A.layout="fit";A.autoScroll=true;A.split=true;A.store=new GO.data.JsonStore({url:GO.settings.modules.postfixadmin.url+"json.php",baseParams:{task:"vacation_configs"},root:"results",id:"id",totalProperty:"total",fields:["email","subject","body","cache","domain","ctime","active"],remoteSort:true});A.paging=true;var B=new Ext.grid.ColumnModel([{header:GO.postfixadmin.lang.email,dataIndex:"email"},{header:GO.postfixadmin.lang.subject,dataIndex:"subject"},{header:GO.postfixadmin.lang.body,dataIndex:"body"},{header:GO.postfixadmin.lang.cache,dataIndex:"cache"},{header:GO.postfixadmin.lang.domain,dataIndex:"domain"},{header:GO.lang.strCtime,dataIndex:"ctime"},{header:GO.postfixadmin.lang.active,dataIndex:"active"}]);B.defaultSortable=true;A.cm=B;A.view=new Ext.grid.GridView({autoFill:true,forceFit:true,emptyText:GO.lang.strNoItems});A.sm=new Ext.grid.RowSelectionModel();A.loadMask=true;this.vacationConfigDialog=new GO.postfixadmin.VacationConfigDialog();this.vacationConfigDialog.on("save",function(){this.store.reload()},this);A.tbar=[{iconCls:"btn-add",text:GO.lang.cmdAdd,cls:"x-btn-text-icon",handler:function(){this.vacationConfigDialog.show()},scope:this},{iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.deleteSelected()},scope:this}];GO.postfixadmin.VacationConfigsGrid.superclass.constructor.call(this,A);this.on("rowdblclick",function(D,E){var C=D.getStore().getAt(E);this.vacationConfigDialog.show(C.data.id)},this)};Ext.extend(GO.postfixadmin.VacationConfigsGrid,GO.grid.GridPanel,{});GO.postfixadmin.VacationConfigDialog=function(B){if(!B){B={}}this.buildForm();var A=function(){this.propertiesPanel.items.items[0].focus()};B.maximizable=true;B.layout="fit";B.modal=false;B.resizable=false;B.width=700;B.height=500;B.closeAction="hide";B.title=GO.postfixadmin.lang.vacationConfig;B.items=this.formPanel;B.focus=A.createDelegate(this);B.buttons=[{text:GO.lang.cmdOk,handler:function(){this.submitForm(true)},scope:this},{text:GO.lang.cmdApply,handler:function(){this.submitForm()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];GO.postfixadmin.VacationConfigDialog.superclass.constructor.call(this,B);this.addEvents({save:true})};Ext.extend(GO.postfixadmin.VacationConfigDialog,Ext.Window,{show:function(A,B){if(!this.rendered){this.render(Ext.getBody())}this.tabPanel.setActiveTab(0);if(!A){A=0}this.setVacationConfigId(A);if(this.vacation_config_id>0){this.formPanel.load({url:GO.settings.modules.postfixadmin.url+"json.php",success:function(C,D){GO.postfixadmin.VacationConfigDialog.superclass.show.call(this)},failure:function(C,D){Ext.Msg.alert(GO.lang.strError,D.result.feedback)},scope:this})}else{this.formPanel.form.reset();GO.postfixadmin.VacationConfigDialog.superclass.show.call(this)}},setVacationConfigId:function(A){this.formPanel.form.baseParams.vacation_config_id=A;this.vacation_config_id=A},submitForm:function(A){this.formPanel.form.submit({url:GO.settings.modules.postfixadmin.url+"action.php",params:{task:"save_vacation_config"},waitMsg:GO.lang.waitMsgSave,success:function(B,C){this.fireEvent("save",this);if(A){this.hide()}else{if(C.result.vacation_config_id){this.setVacationConfigId(C.result.vacation_config_id)}}},failure:function(B,C){if(C.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,C.result.feedback)}},scope:this})},buildForm:function(){this.propertiesPanel=new Ext.Panel({title:GO.lang.strProperties,cls:"go-form-panel",waitMsgTarget:true,layout:"form",autoScroll:true,items:[{xtype:"textfield",name:"email",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.email},{xtype:"textfield",name:"subject",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.subject},{xtype:"textarea",name:"body",anchor:"-20",allowBlank:true,fieldLabel:GO.postfixadmin.lang.body},{xtype:"textarea",name:"cache",anchor:"-20",allowBlank:true,fieldLabel:GO.postfixadmin.lang.cache},{xtype:"textfield",name:"domain",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.domain},{xtype:"textfield",name:"active",anchor:"-20",allowBlank:false,fieldLabel:GO.postfixadmin.lang.active}]});var A=[this.propertiesPanel];this.tabPanel=new Ext.TabPanel({activeTab:0,deferredRender:false,border:false,items:A,anchor:"100% 100%"});this.formPanel=new Ext.form.FormPanel({waitMsgTarget:true,url:GO.settings.modules.postfixadmin.url+"action.php",border:false,baseParams:{task:"vacation_config"},items:this.tabPanel})}});GO.moduleManager.addModule("postfixadmin",GO.postfixadmin.DomainsGrid,{title:GO.postfixadmin.lang.postfixadmin,iconCls:"go-tab-icon-postfixadmin"});