GO.links.LinkDescriptionDialog=function(B){if(!B){B={}}this.buildForm();var A=function(){this.formPanel.items.items[0].focus()};B.collapsible=true;B.maximizable=true;B.layout="fit";B.modal=false;B.resizable=false;B.width=300;B.autoHeight=true;B.closeAction="hide";B.title=GO.links.lang.linkDescription;B.items=this.formPanel;B.focus=A.createDelegate(this);B.buttons=[{text:GO.lang.cmdOk,handler:function(){this.submitForm(true)},scope:this},{text:GO.lang.cmdApply,handler:function(){this.submitForm()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];GO.links.LinkDescriptionDialog.superclass.constructor.call(this,B);this.addEvents({save:true})};Ext.extend(GO.links.LinkDescriptionDialog,Ext.Window,{show:function(B,A){if(!this.rendered){this.render(Ext.getBody())}this.formPanel.form.reset();if(!B){B=0}this.setLinkDescriptionId(B);if(this.link_description_id>0){this.formPanel.load({url:GO.settings.modules.links.url+"json.php",waitMsg:GO.lang.waitMsgLoad,success:function(C,D){GO.links.LinkDescriptionDialog.superclass.show.call(this)},failure:function(C,D){Ext.Msg.alert(GO.lang.strError,D.result.feedback)},scope:this})}else{GO.links.LinkDescriptionDialog.superclass.show.call(this)}},setLinkDescriptionId:function(A){this.formPanel.form.baseParams.link_description_id=A;this.link_description_id=A},submitForm:function(A){this.formPanel.form.submit({url:GO.settings.modules.links.url+"action.php",params:{task:"save_link_description"},waitMsg:GO.lang.waitMsgSave,success:function(B,C){if(C.result.link_description_id){this.setLinkDescriptionId(C.result.link_description_id)}this.fireEvent("save",this,this.link_description_id);if(A){this.hide()}},failure:function(B,C){if(C.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,C.result.feedback)}},scope:this})},buildForm:function(){this.formPanel=new Ext.FormPanel({waitMsgTarget:true,baseParams:{task:"link_description"},url:GO.settings.modules.links.url+"action.php",cls:"go-form-panel",layout:"form",autoHeight:true,items:[{xtype:"textfield",name:"description",anchor:"-20",fieldLabel:GO.lang.strDescription}]})}});GO.links.LinkDescriptionsGrid=function(A){if(!A){A={}}A.layout="fit";A.autoScroll=true;A.split=true;A.closable=false;A.store=new GO.data.JsonStore({url:GO.settings.config.host+"json.php",baseParams:{task:"link_descriptions"},root:"results",id:"id",totalProperty:"total",fields:["id","description"],remoteSort:true});var B=new Ext.grid.ColumnModel([{header:GO.lang.strDescription,dataIndex:"description"}]);B.defaultSortable=true;A.cm=B;A.view=new Ext.grid.GridView({autoFill:true,forceFit:true,emptyText:GO.lang.strNoItems});A.sm=new Ext.grid.RowSelectionModel();A.loadMask=true;this.linkDescriptionDialog=new GO.links.LinkDescriptionDialog();this.linkDescriptionDialog.on("save",function(){this.store.reload()},this);A.tbar=[{iconCls:"btn-add",text:GO.lang.cmdAdd,cls:"x-btn-text-icon",handler:function(){this.linkDescriptionDialog.show()},scope:this},{iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.deleteSelected()},scope:this}];GO.links.LinkDescriptionsGrid.superclass.constructor.call(this,A);this.on("rowdblclick",function(D,E){var C=D.getStore().getAt(E);this.linkDescriptionDialog.show(C.data.id)},this)};Ext.extend(GO.links.LinkDescriptionsGrid,GO.grid.GridPanel,{afterRender:function(){GO.links.LinkDescriptionsGrid.superclass.afterRender.call(this);this.store.load()}});