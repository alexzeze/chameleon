Ext.override(Ext.menu.Menu,{showAt:function(D,B,A){this.parentMenu=B;if(!this.el){this.render()}if(A!==false){this.fireEvent("beforeshow",this);D=this.el.adjustForConstraints(D)}this.el.setXY(D);var C=Ext.getBody().getHeight()-D[1];if(!this.el.origHeight){this.el.origHeight=this.el.getHeight()}if(this.el.origHeight>C){this.el.setHeight(C);this.el.applyStyles("overflow-y: auto;")}else{}this.el.show();this.hidden=false;this.focus();this.fireEvent("show",this)}});Ext.override(Ext.grid.GridView,{scrollOffset:20});Ext.override(Ext.menu.Menu,{autoWidth:function(){var D=this.el,C=this.ul;if(!D){return }var A=this.width;if(A){D.setWidth(A)}else{if(Ext.isIE&&!Ext.isIE8){D.setWidth(this.minWidth);var B=D.dom.offsetWidth;D.setWidth(C.getWidth()+D.getFrameWidth("lr"))}}}});Ext.apply(Ext.form.VTypes,{password:function(C,B){if(B.initialPassField){var A=Ext.getCmp(B.initialPassField);return(C==A.getValue())}return true},passwordText:GO.lang.passwordMatchError});Ext.Window.override({constrainHeader:true});Ext.override(Ext.Editor,{doAutoSize:function(){if(this.autoSize){var B=this.boundEl.getSize(),A=this.field.getSize();switch(this.autoSize){case"width":this.setSize(B.width,A.height);break;case"height":this.setSize(A.width,B.height);break;case"none":this.setSize(A.width,A.height);break;default:this.setSize(B.width,B.height)}}}});Ext.MessageBox.buttonText.yes=GO.lang.cmdYes;Ext.MessageBox.buttonText.no=GO.lang.cmdNo;Ext.MessageBox.buttonText.ok=GO.lang.cmdOk;Ext.MessageBox.buttonText.cancel=GO.lang.cmdCancel;Ext.override(Ext.DatePicker,{startDay:parseInt(GO.settings.first_weekday)});Ext.override(Ext.Element,{findParent:function(H,C,B){var A=this.dom,G=document.body,E=0,D=Ext.DomQuery,I;C=C||50;if(typeof C!="number"){I=Ext.getDom(C);C=10}try{while(A&&A.nodeType==1&&E<C&&A!=G&&A!=I){if(D.is(A,H)){return B?Ext.get(A):A}E++;A=A.parentNode}}catch(F){}return null}});Ext.override(Ext.tree.TreeEventModel,{initEvents:function(){var A=this.tree.getTreeEl();A.on("click",this.delegateClick,this);if(this.tree.trackMouseOver!==false){var B=Ext.fly(A.dom.firstChild);B.on("mouseover",this.delegateOver,this);B.on("mouseout",this.delegateOut,this)}A.on("dblclick",this.delegateDblClick,this);A.on("contextmenu",this.delegateContextMenu,this)}});Ext.override(Ext.Element,{printCSS:"",printStyle:false,printTitle:document.title,print:function(E){Ext.apply(this,E);var C=Ext.get(this.id).dom;var I=document.getElementById("printcontainer");var D=document.getElementById("printframe");var G='<HTML><HEAD>{0}<TITLE>{1}</TITLE></HEAD><BODY onload="{2}" style="background-color:white;">{3}</BODY></HTML>';var B="";var J;var H;if(D!=null){I.removeChild(D)}if(I!=null){C.removeChild(I)}for(var F=0;F<C.attributes.length;F++){if(Ext.isEmpty(C.attributes[F].value)||C.attributes[F].value.toLowerCase()!="null"){J=Ext.isEmpty(C.attributes[F].value)?'{0}="true" ':'{0}="{1}" ';if(this.printStyle?this.printStyle:C.attributes[F].name.toLowerCase()!="style"){B+=String.format(J,C.attributes[F].name,C.attributes[F].value)}}}for(var F=0;F<document.styleSheets.length;F++){this.printCSS+='<link rel="stylesheet" type="text/css" href="'+document.styleSheets[F].href+'"/>'}H=String.format(G,Ext.isEmpty(this.printCSS)?"#":this.printCSS,this.printTitle,Ext.isIE?"document.execCommand('print');":"window.print();",C.innerHTML);var A=window.open("about:blank");if(!A.opener){A.opener=self}A.document.write(H);A.document.close();A.focus()}});Ext.override(Ext.Component,{printEl:function(A){this.el.print(Ext.isEmpty(A)?this.initialConfig:A)},printBody:function(A){this.body.print(Ext.isEmpty(A)?this.initialConfig:A)}});Ext.override(Ext.grid.GridPanel,{applyState:function(F){var B=this.colModel;var E=F.columns;if(E){for(var C=0,A=E.length;C<A;C++){var D=E[C];var H=B.getColumnById(D.id);if(H){H.hidden=D.hidden;H.width=D.width;var G=B.getIndexById(D.id);if(G!=C){B.moveColumn(G,C)}}}}if(F.sort){this.store[this.store.remoteSort?"setDefaultSort":"sort"](F.sort.field,F.sort.direction)}Ext.apply(this,F)}});Ext.decode=Ext.util.JSON.decode=function(json){try{return eval("("+json+")")}catch(e){GO.errorDialog.show(GO.lang.serverError,json)}};Date.prototype.getLastSunday=function(){var A=this.getDay();return this.add(Date.DAY,-A)};var deployJava={debug:null,myInterval:null,preInstallJREList:null,returnPage:null,brand:null,locale:null,installType:null,EAInstallEnabled:false,EarlyAccessURL:null,getJavaURL:"http://java.sun.com/webapps/getjava/BrowserRedirect?host=java.com",appleRedirectPage:"http://www.apple.com/support/downloads/",mimeType:"application/npruntime-scriptable-plugin;DeploymentToolkit",launchButtonPNG:"http://java.sun.com/products/jfc/tsc/articles/swing2d/webstart.png",getJREs:function(){var D=new Array();if(deployJava.isPluginInstalled()){var C=deployJava.getPlugin();for(var B=0;B<C.jvms.getLength();B++){D[B]=C.jvms.get(B).version}}else{var A=deployJava.getBrowser();if(A=="MSIE"){if(deployJava.testUsingActiveX("1.8.0")){D[0]="1.8.0"}else{if(deployJava.testUsingActiveX("1.7.0")){D[0]="1.7.0"}else{if(deployJava.testUsingActiveX("1.6.0")){D[0]="1.6.0"}else{if(deployJava.testUsingActiveX("1.5.0")){D[0]="1.5.0"}else{if(deployJava.testUsingActiveX("1.4.2")){D[0]="1.4.2"}else{if(deployJava.testForMSVM()){D[0]="1.1"}}}}}}}else{if(A=="Netscape Family"){if(deployJava.testUsingMimeTypes("1.8")){D[0]="1.8.0"}else{if(deployJava.testUsingMimeTypes("1.7")){D[0]="1.7.0"}else{if(deployJava.testUsingMimeTypes("1.6")){D[0]="1.6.0"}else{if(deployJava.testUsingMimeTypes("1.5")){D[0]="1.5.0"}else{if(deployJava.testUsingMimeTypes("1.4.2")){D[0]="1.4.2"}}}}}}else{if(A=="Safari"){if(deployJava.testUsingPluginsArray("1.8.0")){D[0]="1.8.0"}else{if(deployJava.testUsingPluginsArray("1.7.0")){D[0]="1.7.0"}else{if(deployJava.testUsingPluginsArray("1.6.0")){D[0]="1.6.0"}else{if(deployJava.testUsingPluginsArray("1.5.0")){D[0]="1.5.0"}else{if(deployJava.testUsingPluginsArray("1.4.2")){D[0]="1.4.2"}}}}}}}}}if(deployJava.debug){for(var B=0;B<D.length;++B){alert("We claim to have detected Java SE "+D[B])}}return D},installJRE:function(B){var A=false;if(deployJava.isPluginInstalled()){if(deployJava.getPlugin().installJRE(B)){deployJava.refresh();if(deployJava.returnPage!=null){document.location=deployJava.returnPage}return true}else{return false}}else{return deployJava.installLatestJRE()}},installLatestJRE:function(){if(deployJava.isPluginInstalled()){if(deployJava.getPlugin().installLatestJRE()){deployJava.refresh();if(deployJava.returnPage!=null){document.location=deployJava.returnPage}return true}else{return false}}else{var B=deployJava.getBrowser();var A=navigator.platform.toLowerCase();if((deployJava.EAInstallEnabled=="true")&&(A.indexOf("win")!=-1)&&(deployJava.EarlyAccessURL!=null)){deployJava.preInstallJREList=deployJava.getJREs();if(deployJava.returnPage!=null){deployJava.myInterval=setInterval("deployJava.poll()",3000)}location.href=deployJava.EarlyAccessURL;return false}else{if(B=="MSIE"){return deployJava.IEInstall()}else{if((B=="Netscape Family")&&(A.indexOf("win32")!=-1)){return deployJava.FFInstall()}else{location.href=deployJava.getJavaURL+((deployJava.returnPage!=null)?("&returnPage="+deployJava.returnPage):"")+((deployJava.locale!=null)?("&locale="+deployJava.locale):"")+((deployJava.brand!=null)?("&brand="+deployJava.brand):"")}}return false}}},runApplet:function(B,F,D){if(D=="undefined"||D==null){D="1.1"}var E="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var A=D.match(E);if(deployJava.returnPage==null){deployJava.returnPage=document.location}if(A!=null){var C=deployJava.getBrowser();if((C!="?")&&(C!="Safari")){if(deployJava.versionCheck(D+"+")){deployJava.writeAppletTag(B,F)}else{if(deployJava.installJRE(D+"+")){deployJava.refresh();location.href=document.location;deployJava.writeAppletTag(B,F)}}}else{deployJava.writeAppletTag(B,F)}}else{if(deployJava.debug){alert("Invalid minimumVersion argument to runApplet():"+D)}}},writeAppletTag:function(A,D){var B="<applet ";for(var C in A){B+=(" "+C+'="'+A[C]+'"')}B+=">";document.write(B);if(D!="undefined"&&D!=null){for(var E in D){B='<param name="'+E+'" value="'+D[E]+'">';document.write(B)}}document.write("</applet>")},versionCheck:function(H){var C=0;var F="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?(\\*|\\+)?$";var A=H.match(F);if(A!=null){var E=true;var B=new Array();for(var D=1;D<A.length;++D){if((typeof A[D]=="string")&&(A[D]!="")){B[C]=A[D];C++}}if(B[B.length-1]=="+"){E=false;B.length--}else{if(B[B.length-1]=="*"){B.length--}}var G=deployJava.getJREs();for(var D=0;D<G.length;++D){if(deployJava.compareVersionToPattern(G[D],B,E)){return true}}return false}else{alert("Invalid versionPattern passed to versionCheck: "+H);return false}},isWebStartInstalled:function(D){var C=deployJava.getBrowser();if((C=="?")||(C=="Safari")){return true}if(D=="undefined"||D==null){D="1.4.2"}var B=false;var E="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var A=D.match(E);if(A!=null){B=deployJava.versionCheck(D+"+")}else{if(deployJava.debug){alert("Invalid minimumVersion argument to isWebStartInstalled(): "+D)}B=deployJava.versionCheck("1.4.2+")}return B},createWebStartLaunchButton:function(C,B){if(deployJava.returnPage==null){deployJava.returnPage=C}var A="javascript:if (!deployJava.isWebStartInstalled(&quot;"+B+"&quot;)) {if (deployJava.installLatestJRE()) {if (deployJava.launch(&quot;"+C+"&quot;)) {}}} else {if (deployJava.launch(&quot;"+C+"&quot;)) {}}";document.write('<a href="'+A+'" onMouseOver="window.status=\'\'; return true;"><img src="'+deployJava.launchButtonPNG+'" border="0" /></a>')},launch:function(A){if(deployJava.isPluginInstalled()){return deployJava.getPlugin().launch(A)}else{document.location=A;return true}},isPluginInstalled:function(){var A=deployJava.getPlugin();if(A&&A.jvms){return true}else{return false}},isAutoUpdateEnabled:function(){if(deployJava.isPluginInstalled()){return deployJava.getPlugin().isAutoUpdateEnabled()}return false},setAutoUpdateEnabled:function(){if(deployJava.isPluginInstalled()){return deployJava.getPlugin().setAutoUpdateEnabled()}return false},setInstallerType:function(A){deployJava.installType=A;if(deployJava.isPluginInstalled()){return deployJava.getPlugin().setInstallerType(A)}return false},setAdditionalPackages:function(A){if(deployJava.isPluginInstalled()){return deployJava.getPlugin().setAdditionalPackages(A)}return false},setEarlyAccess:function(A){deployJava.EAInstallEnabled=A},isPlugin2:function(){if(deployJava.isPluginInstalled()){try{return deployJava.getPlugin().isPlugin2()}catch(A){}}return false},getPlugin:function(){deployJava.refresh();var A=document.getElementById("deployJavaPlugin");return A},compareVersionToPattern:function(F,B,C){var G="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var H=F.match(G);if(H!=null){var E=0;var I=new Array();for(var D=1;D<H.length;++D){if((typeof H[D]=="string")&&(H[D]!="")){I[E]=H[D];E++}}var A=Math.min(I.length,B.length);if(C){for(var D=0;D<A;++D){if(I[D]!=B[D]){return false}}return true}else{for(var D=0;D<A;++D){if(I[D]<B[D]){return false}else{if(I[D]>B[D]){return true}}}return true}}else{return false}},getBrowser:function(){var A=navigator.userAgent.toLowerCase();if(deployJava.debug){alert("userAgent -> "+A)}if((navigator.vendor)&&(navigator.vendor.toLowerCase().indexOf("apple")!=-1)&&(A.indexOf("safari")!=-1)){if(deployJava.debug){alert('We claim to have detected "Safari".')}return"Safari"}else{if(A.indexOf("msie")!=-1){if(deployJava.debug){alert('We claim to have detected "IE".')}return"MSIE"}else{if((A.indexOf("mozilla")!=-1)||(A.indexOf("firefox")!=-1)){if(deployJava.debug){alert("We claim to have detected a Netscape family browser.")}return"Netscape Family"}else{if(deployJava.debug){alert("We claim to have failed to detect a browser.")}return"?"}}}},testUsingActiveX:function(A){var C="JavaWebStart.isInstalled."+A+".0";if(!ActiveXObject){if(deployJava.debug){alert("Browser claims to be IE, but no ActiveXObject object?")}return false}try{return(new ActiveXObject(C)!=null)}catch(B){return false}},testForMSVM:function(){var B="{08B0E5C0-4FCB-11CF-AAA5-00401C608500}";if(typeof oClientCaps!="undefined"){var A=oClientCaps.getComponentVersion(B,"ComponentID");if((A=="")||(A=="5,0,5000,0")){return false}else{return true}}else{return false}},testUsingMimeTypes:function(B){if(!navigator.mimeTypes){if(deployJava.debug){alert("Browser claims to be Netscape family, but no mimeTypes[] array?")}return false}for(var C=0;C<navigator.mimeTypes.length;++C){s=navigator.mimeTypes[C].type;var A=s.match(/^application\/x-java-applet\x3Bversion=(1\.8|1\.7|1\.6|1\.5|1\.4\.2)$/);if(A!=null){if(deployJava.compareVersions(A[1],B)){return true}}}return false},testUsingPluginsArray:function(A){if((!navigator.plugins)||(!navigator.plugins.length)){if(deployJava.debug){alert("Browser claims to be Safari, but no plugins[] array?")}return false}for(var B=0;B<navigator.plugins.length;++B){s=navigator.plugins[B].description;if(s.search(/^Java Switchable Plug-in/)!=-1){return true}m=s.match(/^Java (1\.4\.2|1\.5|1\.6|1\.7).* Plug-in/);if(m!=null){if(deployJava.compareVersions(m[1],A)){return true}}}return false},IEInstall:function(){location.href=deployJava.getJavaURL+((deployJava.returnPage!=null)?("&returnPage="+deployJava.returnPage):"")+((deployJava.locale!=null)?("&locale="+deployJava.locale):"")+((deployJava.brand!=null)?("&brand="+deployJava.brand):"")+((deployJava.installType!=null)?("&type="+deployJava.installType):"");return false},done:function(B,A){},FFInstall:function(){location.href=deployJava.getJavaURL+((deployJava.returnPage!=null)?("&returnPage="+deployJava.returnPage):"")+((deployJava.locale!=null)?("&locale="+deployJava.locale):"")+((deployJava.brand!=null)?("&brand="+deployJava.brand):"")+((deployJava.installType!=null)?("&type="+deployJava.installType):"");return false},compareVersions:function(D,E){var B=D.split(".");var A=E.split(".");for(var C=0;C<B.length;++C){B[C]=Number(B[C])}for(var C=0;C<A.length;++C){A[C]=Number(A[C])}if(B.length==2){B[2]=0}if(B[0]>A[0]){return true}if(B[0]<A[0]){return false}if(B[1]>A[1]){return true}if(B[1]<A[1]){return false}if(B[2]>A[2]){return true}if(B[2]<A[2]){return false}return true},enableAlerts:function(){deployJava.debug=true},poll:function(){deployJava.refresh();var A=deployJava.getJREs();if((deployJava.preInstallJREList.length==0)&&(A.length!=0)){clearInterval(deployJava.myInterval);if(deployJava.returnPage!=null){location.href=deployJava.returnPage}}if((deployJava.preInstallJREList.length!=0)&&(A.length!=0)&&(deployJava.preInstallJREList[0]!=A[0])){clearInterval(deployJava.myInterval);if(deployJava.returnPage!=null){location.href=deployJava.returnPage}}},writePluginTag:function(){var A=deployJava.getBrowser();if(A=="MSIE"){document.write('<object classid="clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA" id="deployJavaPlugin" width="0" height="0"></object>')}else{if(A=="Netscape Family"){if(navigator.mimeTypes!=null){for(var B=0;B<navigator.mimeTypes.length;B++){if(navigator.mimeTypes[B].type==deployJava.mimeType){if(navigator.mimeTypes[B].enabledPlugin){document.write('<embed id="deployJavaPlugin" type="'+deployJava.mimeType+'" hidden="true" />')}}}}}}},refresh:function(){navigator.plugins.refresh(false);var A=deployJava.getBrowser();if(A=="Netscape Family"){var C=document.getElementById("deployJavaPlugin");if(C==null){if(navigator.mimeTypes!=null){for(var B=0;B<navigator.mimeTypes.length;B++){if(navigator.mimeTypes[B].type==deployJava.mimeType){if(navigator.mimeTypes[B].enabledPlugin){document.write('<embed id="deployJavaPlugin" type="'+deployJava.mimeType+'" hidden="true" />')}}}}}}},do_initialize:function(){deployJava.writePluginTag();if(deployJava.locale==null){var B=null;if(B==null){try{B=navigator.userLanguage}catch(A){}}if(B==null){try{B=navigator.systemLanguage}catch(A){}}if(B==null){try{B=navigator.language}catch(A){}}if(B!=null){B.replace("-","_");deployJava.locale=B}}}};deployJava.do_initialize();GO.MainLayout=function(){this.addEvents({ready:true,render:true});this.resumeEvents()};Ext.extend(GO.MainLayout,Ext.util.Observable,{ready:false,fullscreenPopup:false,onReady:function(B,A){if(!this.ready){this.on("ready",B,A)}else{B.call(A,this)}},launchFullscreen:function(A){this.fullscreenPopup=GO.util.popup({url:A,target:"groupoffice"})},login:function(){this.fireReady();GO.loginDialog=new GO.dialog.LoginDialog({modal:false});this.createLoginCallback();GO.loginDialog.show();this.removeLoadMask()},logout:function(A){if(!A||Ext.Ajax.isLoading()){this.logout.defer(200,this,[true])}else{document.location=GO.settings.config.host+"index.php?task=logout"}},createLoginCallback:function(){GO.loginDialog.addCallback(function(){var A=GO.afterLoginUrl?GO.afterLoginUrl:GO.settings.config.host;if(GO.loginDialog.fullscreenField.getValue()&&window.name!="groupoffice"){this.launchFullscreen(A);GO.loginDialog.hideDialog=false;GO.loginDialog.on("callbackshandled",this.createLoginCallback,this)}else{document.location.href=A}},this)},fireReady:function(){this.fireEvent("ready",this);this.ready=true},createTabPanel:function(A){this.tabPanel=new Ext.TabPanel({region:"center",titlebar:false,border:false,activeTab:"go-module-panel-"+GO.settings.start_module,tabPosition:"top",items:A,layoutOnTabChange:true})},getModulePanel:function(A){var B="go-module-panel-"+A;if(this.tabPanel.items.map[B]){return this.tabPanel.items.map[B]}else{return false}},init:function(){this.fireReady();var I=GO.moduleManager.getAllPanels();if(I.length==0){I=new Ext.Panel({id:"go-module-panel-"+GO.settings.start_module,region:"center",border:false,cls:"go-form-panel",title:"No modules",html:"<h1>No modules available</h1>You have a valid Group-Office account but you don't have access to any of the modules. Please contact the administrator if you feel this is an error."})}this.createTabPanel(I);var G=new Ext.Panel({region:"north",contentEl:"mainNorthPanel",cls:"go-top-panel",height:28,titlebar:false,border:false});var H=new Ext.Viewport({layout:"border",border:false,items:[G,this.tabPanel]});var C=Ext.get("admin-menu-link");var J=GO.moduleManager.getAllAdminPanelConfigs();if(C&&J.length>0){C.setDisplayed(true);var D=new Ext.menu.Menu({id:"adminMenu"});for(var E=0;E<J.length;E++){D.add({moduleName:J[E].moduleName,text:J[E].title,iconCls:"go-menu-icon-"+J[E].moduleName,handler:function(O,P){var N="go-module-panel-"+O.moduleName;if(!this.tabPanel.items.map[N]){var M=GO.moduleManager.getAdminPanel(O.moduleName);M.id=N;this.tabPanel.add(M)}else{var M=this.tabPanel.items.map[N]}M.show()},scope:this})}C.on("click",function(){var M=C.getX();var N=G.el.getY()+G.el.getHeight();D.showAt([M,N])},this)}else{C.setDisplayed(false)}var A=Ext.get("configuration-link");if(A){A.on("click",function(){if(!this.personalSettingsDialog){this.personalSettingsDialog=new GO.PersonalSettingsDialog()}this.personalSettingsDialog.show()},this)}var F=Ext.get("help-link");if(F){var L=new Ext.menu.Menu({id:"helpMenu",items:[{iconCls:"btn-help",text:GO.lang.strHelpContents,handler:function(){var M=window.open("http://www.group-office.com/wiki/");M.focus()},scope:this},{iconCls:"btn-forum",text:GO.lang.strCommunityForum,handler:function(){var M=window.open("http://www.group-office.com/forum/");M.focus()},scope:this},"-",{iconCls:"btn-support",text:GO.lang.contactSupportDesk,handler:function(){GO.supportLink=GO.settings.config.webmaster_email;if(Ext.form.VTypes.email(GO.supportLink)){if(GO.email&&GO.settings.modules.email.read_permission){GO.email.showComposer({values:{to:GO.supportLink}})}else{document.location="mailto:"+GO.supportLink}}else{window.open(GO.supportLink)}},scope:this},{iconCls:"btn-report-bug",text:GO.lang.strReportBug,handler:function(){var M=window.open("https://sourceforge.net/tracker2/?func=add&group_id=76359&atid=547651");M.focus()},scope:this},"-",{iconCls:"btn-info",text:GO.lang.strAbout,handler:function(){if(!this.aboutDialog){this.aboutDialog=new GO.dialog.AboutDialog()}this.aboutDialog.show()},scope:this}]});F.on("click",function(){var M=F.getX();var N=G.el.getY()+G.el.getHeight();L.showAt([M,N])},this)}var B=this.tabPanel.getLayout().activeItem;if(!B){this.tabPanel.setActiveTab(0)}GO.checker=new GO.Checker();GO.checker.init.defer(2000,GO.checker);GO.checker.on("alert",function(M){if(M.notification_area){Ext.get("notification-area").update(M.notification_area)}},this);var K=new Ext.form.TextField({name:"search_query",enableKeyEvents:true,emptyText:GO.lang.strSearch+"...",listeners:{scope:this,keypress:function(N,M){if(M.getKey()==Ext.EventObject.ENTER){this.addSearchPanel(N.getValue())}},blur:function(M){M.reset()}},renderTo:"search_query"});Ext.QuickTips.init();Ext.apply(Ext.QuickTips.getQuickTip(),{dismissDelay:0,maxWidth:500});this.fireEvent("render");this.removeLoadMask()},setAdminMenu:function(){var A=Ext.get("adminMenuLink");if(A){A.on("click",function(){var B=A.getX();var C=top.el.getY()+top.el.getHeight();adminMenu.showAt([B,C])},this)}},removeLoadMask:function(){var B=Ext.get("loading");var A=Ext.get("loading-mask");A.setOpacity(0.8);A.shift({xy:B.getXY(),width:B.getWidth(),height:B.getHeight(),remove:true,duration:1,opacity:0.3,easing:"bounceOut",callback:function(){B.fadeOut({duration:0.2,remove:true})}})},addSearchPanel:function(B){var A=new GO.grid.SearchPanel({query:B});this.tabPanel.add(A);A.show()}});GO.mainLayout=new GO.MainLayout();GO.layout.ColumnFitLayout=Ext.extend(Ext.layout.ColumnLayout,{onLayout:function(D,G){GO.layout.ColumnFitLayout.superclass.onLayout.apply(this,arguments);var F=D.items.items,A=F.length,H,C;var B=Ext.isIE&&G.dom!=Ext.getBody().dom?G.getStyleSize():G.getViewSize();var E=B.height-G.getPadding("tb");for(C=0;C<A;C++){H=F[C];H.setHeight(E+(H.footer?H.footer.getHeight():0))}}});Ext.Container.LAYOUTS.columnfit=GO.layout.ColumnFitLayout;GO.ExportQueryDialog=Ext.extend(Ext.Window,{initComponent:function(){Ext.apply(this,{title:GO.lang.cmdExport,items:this.formPanel=new Ext.FormPanel({items:this.formPanelItems,bodyStyle:"padding:5px"}),autoHeight:true,closeAction:"hide",closeable:true,height:400,width:400,buttons:[{text:GO.lang.strEmail,handler:function(){this.hide();this.beforeRequest();GO.email.showComposer({loadUrl:BaseHref+"json.php",loadParams:this.loadParams})},scope:this},{text:GO.lang.download,handler:function(){this.beforeRequest();var B="";for(var A in this.loadParams){if(B==""){B=BaseHref+"export_query.php?"}else{B+="&"}B+=A+"="+encodeURIComponent(this.loadParams[A])}document.location=B;this.hide()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}]});GO.ExportQueryDialog.superclass.initComponent.call(this)},loadParams:{},downloadUrl:"",formPanelItems:[{autoHeight:true,xtype:"radiogroup",fieldLabel:GO.lang.strType,items:[{boxLabel:"CSV",name:"type",inputValue:"CSV",checked:true},{boxLabel:"PDF",name:"type",inputValue:"PDF"}]},{xtype:"checkbox",name:"export_hidden",hideLabel:true,boxLabel:GO.lang.exportHiddenColumns}],show:function(A){GO.ExportQueryDialog.superclass.show.call(this);var A=A||{};Ext.apply(this,A)},beforeRequest:function(){var C=[];var E=this.formPanel.form.findField("export_hidden").getValue();if(this.colModel){for(var B=0;B<this.colModel.getColumnCount();B++){var D=this.colModel.config[B];if(E||!D.hidden){C.push(D.dataIndex+":"+D.header)}}}if(GO.util.empty(this.title)){this.title=this.query}this.loadParams={task:"email_export_query",query:this.query,columns:C.join(","),title:this.title};if(this.subtitle){this.loadParams.subtitle=this.subtitle}if(this.text){this.loadParams.text=this.text}var A=this.formPanel.form.getValues();Ext.apply(this.loadParams,A)}});GO.users.TimeZones=[["Africa/Abidjan"],["Africa/Accra"],["Africa/Addis_Ababa"],["Africa/Algiers"],["Africa/Asmara"],["Africa/Asmera"],["Africa/Bamako"],["Africa/Bangui"],["Africa/Banjul"],["Africa/Bissau"],["Africa/Blantyre"],["Africa/Brazzaville"],["Africa/Bujumbura"],["Africa/Cairo"],["Africa/Casablanca"],["Africa/Ceuta"],["Africa/Conakry"],["Africa/Dakar"],["Africa/Dar_es_Salaam"],["Africa/Djibouti"],["Africa/Douala"],["Africa/El_Aaiun"],["Africa/Freetown"],["Africa/Gaborone"],["Africa/Harare"],["Africa/Johannesburg"],["Africa/Kampala"],["Africa/Khartoum"],["Africa/Kigali"],["Africa/Kinshasa"],["Africa/Lagos"],["Africa/Libreville"],["Africa/Lome"],["Africa/Luanda"],["Africa/Lubumbashi"],["Africa/Lusaka"],["Africa/Malabo"],["Africa/Maputo"],["Africa/Maseru"],["Africa/Mbabane"],["Africa/Mogadishu"],["Africa/Monrovia"],["Africa/Nairobi"],["Africa/Ndjamena"],["Africa/Niamey"],["Africa/Nouakchott"],["Africa/Ouagadougou"],["Africa/Porto-Novo"],["Africa/Sao_Tome"],["Africa/Timbuktu"],["Africa/Tripoli"],["Africa/Tunis"],["Africa/Windhoek"],["America/Adak"],["America/Anchorage"],["America/Anguilla"],["America/Antigua"],["America/Araguaina"],["America/Argentina/Buenos_Aires"],["America/Argentina/Catamarca"],["America/Argentina/ComodRivadavia"],["America/Argentina/Cordoba"],["America/Argentina/Jujuy"],["America/Argentina/La_Rioja"],["America/Argentina/Mendoza"],["America/Argentina/Rio_Gallegos"],["America/Argentina/San_Juan"],["America/Argentina/Tucuman"],["America/Argentina/Ushuaia"],["America/Aruba"],["America/Asuncion"],["America/Atikokan"],["America/Atka"],["America/Bahia"],["America/Barbados"],["America/Belem"],["America/Belize"],["America/Blanc-Sablon"],["America/Boa_Vista"],["America/Bogota"],["America/Boise"],["America/Buenos_Aires"],["America/Cambridge_Bay"],["America/Campo_Grande"],["America/Cancun"],["America/Caracas"],["America/Catamarca"],["America/Cayenne"],["America/Cayman"],["America/Chicago"],["America/Chihuahua"],["America/Coral_Harbour"],["America/Cordoba"],["America/Costa_Rica"],["America/Cuiaba"],["America/Curacao"],["America/Danmarkshavn"],["America/Dawson"],["America/Dawson_Creek"],["America/Denver"],["America/Detroit"],["America/Dominica"],["America/Edmonton"],["America/Eirunepe"],["America/El_Salvador"],["America/Ensenada"],["America/Fort_Wayne"],["America/Fortaleza"],["America/Glace_Bay"],["America/Godthab"],["America/Goose_Bay"],["America/Grand_Turk"],["America/Grenada"],["America/Guadeloupe"],["America/Guatemala"],["America/Guayaquil"],["America/Guyana"],["America/Halifax"],["America/Havana"],["America/Hermosillo"],["America/Indiana/Indianapolis"],["America/Indiana/Knox"],["America/Indiana/Marengo"],["America/Indiana/Petersburg"],["America/Indiana/Vevay"],["America/Indiana/Vincennes"],["America/Indiana/Winamac"],["America/Indianapolis"],["America/Inuvik"],["America/Iqaluit"],["America/Jamaica"],["America/Jujuy"],["America/Juneau"],["America/Kentucky/Louisville"],["America/Kentucky/Monticello"],["America/Knox_IN"],["America/La_Paz"],["America/Lima"],["America/Los_Angeles"],["America/Louisville"],["America/Maceio"],["America/Managua"],["America/Manaus"],["America/Martinique"],["America/Mazatlan"],["America/Mendoza"],["America/Menominee"],["America/Merida"],["America/Mexico_City"],["America/Miquelon"],["America/Moncton"],["America/Monterrey"],["America/Montevideo"],["America/Montreal"],["America/Montserrat"],["America/Nassau"],["America/New_York"],["America/Nipigon"],["America/Nome"],["America/Noronha"],["America/North_Dakota/Center"],["America/North_Dakota/New_Salem"],["America/Panama"],["America/Pangnirtung"],["America/Paramaribo"],["America/Phoenix"],["America/Port-au-Prince"],["America/Port_of_Spain"],["America/Porto_Acre"],["America/Porto_Velho"],["America/Puerto_Rico"],["America/Rainy_River"],["America/Rankin_Inlet"],["America/Recife"],["America/Regina"],["America/Resolute"],["America/Rio_Branco"],["America/Rosario"],["America/Santiago"],["America/Santo_Domingo"],["America/Sao_Paulo"],["America/Scoresbysund"],["America/Shiprock"],["America/St_Johns"],["America/St_Kitts"],["America/St_Lucia"],["America/St_Thomas"],["America/St_Vincent"],["America/Swift_Current"],["America/Tegucigalpa"],["America/Thule"],["America/Thunder_Bay"],["America/Tijuana"],["America/Toronto"],["America/Tortola"],["America/Vancouver"],["America/Virgin"],["America/Whitehorse"],["America/Winnipeg"],["America/Yakutat"],["America/Yellowknife"],["Antarctica/Casey"],["Antarctica/Davis"],["Antarctica/DumontDUrville"],["Antarctica/Mawson"],["Antarctica/McMurdo"],["Antarctica/Palmer"],["Antarctica/Rothera"],["Antarctica/South_Pole"],["Antarctica/Syowa"],["Antarctica/Vostok"],["Arctic/Longyearbyen"],["Asia/Aden"],["Asia/Almaty"],["Asia/Amman"],["Asia/Anadyr"],["Asia/Aqtau"],["Asia/Aqtobe"],["Asia/Ashgabat"],["Asia/Ashkhabad"],["Asia/Baghdad"],["Asia/Bahrain"],["Asia/Baku"],["Asia/Bangkok"],["Asia/Beirut"],["Asia/Bishkek"],["Asia/Brunei"],["Asia/Calcutta"],["Asia/Choibalsan"],["Asia/Chongqing"],["Asia/Chungking"],["Asia/Colombo"],["Asia/Dacca"],["Asia/Damascus"],["Asia/Dhaka"],["Asia/Dili"],["Asia/Dubai"],["Asia/Dushanbe"],["Asia/Gaza"],["Asia/Harbin"],["Asia/Hong_Kong"],["Asia/Hovd"],["Asia/Irkutsk"],["Asia/Istanbul"],["Asia/Jakarta"],["Asia/Jayapura"],["Asia/Jerusalem"],["Asia/Kabul"],["Asia/Kamchatka"],["Asia/Karachi"],["Asia/Kashgar"],["Asia/Katmandu"],["Asia/Krasnoyarsk"],["Asia/Kuala_Lumpur"],["Asia/Kuching"],["Asia/Kuwait"],["Asia/Macao"],["Asia/Macau"],["Asia/Magadan"],["Asia/Makassar"],["Asia/Manila"],["Asia/Muscat"],["Asia/Nicosia"],["Asia/Novosibirsk"],["Asia/Omsk"],["Asia/Oral"],["Asia/Phnom_Penh"],["Asia/Pontianak"],["Asia/Pyongyang"],["Asia/Qatar"],["Asia/Qyzylorda"],["Asia/Rangoon"],["Asia/Riyadh"],["Asia/Saigon"],["Asia/Sakhalin"],["Asia/Samarkand"],["Asia/Seoul"],["Asia/Shanghai"],["Asia/Singapore"],["Asia/Taipei"],["Asia/Tashkent"],["Asia/Tbilisi"],["Asia/Tehran"],["Asia/Tel_Aviv"],["Asia/Thimbu"],["Asia/Thimphu"],["Asia/Tokyo"],["Asia/Ujung_Pandang"],["Asia/Ulaanbaatar"],["Asia/Ulan_Bator"],["Asia/Urumqi"],["Asia/Vientiane"],["Asia/Vladivostok"],["Asia/Yakutsk"],["Asia/Yekaterinburg"],["Asia/Yerevan"],["Atlantic/Azores"],["Atlantic/Bermuda"],["Atlantic/Canary"],["Atlantic/Cape_Verde"],["Atlantic/Faeroe"],["Atlantic/Faroe"],["Atlantic/Jan_Mayen"],["Atlantic/Madeira"],["Atlantic/Reykjavik"],["Atlantic/South_Georgia"],["Atlantic/St_Helena"],["Atlantic/Stanley"],["Australia/ACT"],["Australia/Adelaide"],["Australia/Brisbane"],["Australia/Broken_Hill"],["Australia/Canberra"],["Australia/Currie"],["Australia/Darwin"],["Australia/Eucla"],["Australia/Hobart"],["Australia/LHI"],["Australia/Lindeman"],["Australia/Lord_Howe"],["Australia/Melbourne"],["Australia/North"],["Australia/NSW"],["Australia/Perth"],["Australia/Queensland"],["Australia/South"],["Australia/Sydney"],["Australia/Tasmania"],["Australia/Victoria"],["Australia/West"],["Australia/Yancowinna"],["Brazil/Acre"],["Brazil/DeNoronha"],["Brazil/East"],["Brazil/West"],["Canada/Atlantic"],["Canada/Central"],["Canada/East-Saskatchewan"],["Canada/Eastern"],["Canada/Mountain"],["Canada/Newfoundland"],["Canada/Pacific"],["Canada/Saskatchewan"],["Canada/Yukon"],["CET"],["Chile/Continental"],["Chile/EasterIsland"],["CST6CDT"],["Cuba"],["EET"],["Egypt"],["Eire"],["EST"],["EST5EDT"],["Etc/GMT"],["Etc/GMT0"],["Etc/Greenwich"],["Etc/UCT"],["Etc/Universal"],["Etc/UTC"],["Etc/Zulu"],["Europe/Amsterdam"],["Europe/Andorra"],["Europe/Athens"],["Europe/Belfast"],["Europe/Belgrade"],["Europe/Berlin"],["Europe/Bratislava"],["Europe/Brussels"],["Europe/Bucharest"],["Europe/Budapest"],["Europe/Chisinau"],["Europe/Copenhagen"],["Europe/Dublin"],["Europe/Gibraltar"],["Europe/Guernsey"],["Europe/Helsinki"],["Europe/Isle_of_Man"],["Europe/Istanbul"],["Europe/Jersey"],["Europe/Kaliningrad"],["Europe/Kiev"],["Europe/Lisbon"],["Europe/Ljubljana"],["Europe/London"],["Europe/Luxembourg"],["Europe/Madrid"],["Europe/Malta"],["Europe/Mariehamn"],["Europe/Minsk"],["Europe/Monaco"],["Europe/Moscow"],["Europe/Nicosia"],["Europe/Oslo"],["Europe/Paris"],["Europe/Podgorica"],["Europe/Prague"],["Europe/Riga"],["Europe/Rome"],["Europe/Samara"],["Europe/San_Marino"],["Europe/Sarajevo"],["Europe/Simferopol"],["Europe/Skopje"],["Europe/Sofia"],["Europe/Stockholm"],["Europe/Tallinn"],["Europe/Tirane"],["Europe/Tiraspol"],["Europe/Uzhgorod"],["Europe/Vaduz"],["Europe/Vatican"],["Europe/Vienna"],["Europe/Vilnius"],["Europe/Volgograd"],["Europe/Warsaw"],["Europe/Zagreb"],["Europe/Zaporozhye"],["Europe/Zurich"],["Factory"],["GB"],["GB-Eire"],["GMT+0"],["GMT-0"],["GMT0"],["Greenwich"],["Hongkong"],["HST"],["Iceland"],["Indian/Antananarivo"],["Indian/Chagos"],["Indian/Christmas"],["Indian/Cocos"],["Indian/Comoro"],["Indian/Kerguelen"],["Indian/Mahe"],["Indian/Maldives"],["Indian/Mauritius"],["Indian/Mayotte"],["Indian/Reunion"],["Iran"],["Israel"],["Jamaica"],["Japan"],["Kwajalein"],["Libya"],["MET"],["Mexico/BajaNorte"],["Mexico/BajaSur"],["Mexico/General"],["MST"],["MST7MDT"],["Navajo"],["NZ"],["NZ-CHAT"],["Pacific/Apia"],["Pacific/Auckland"],["Pacific/Chatham"],["Pacific/Easter"],["Pacific/Efate"],["Pacific/Enderbury"],["Pacific/Fakaofo"],["Pacific/Fiji"],["Pacific/Funafuti"],["Pacific/Galapagos"],["Pacific/Gambier"],["Pacific/Guadalcanal"],["Pacific/Guam"],["Pacific/Honolulu"],["Pacific/Johnston"],["Pacific/Kiritimati"],["Pacific/Kosrae"],["Pacific/Kwajalein"],["Pacific/Majuro"],["Pacific/Marquesas"],["Pacific/Midway"],["Pacific/Nauru"],["Pacific/Niue"],["Pacific/Norfolk"],["Pacific/Noumea"],["Pacific/Pago_Pago"],["Pacific/Palau"],["Pacific/Pitcairn"],["Pacific/Ponape"],["Pacific/Port_Moresby"],["Pacific/Rarotonga"],["Pacific/Saipan"],["Pacific/Samoa"],["Pacific/Tahiti"],["Pacific/Tarawa"],["Pacific/Tongatapu"],["Pacific/Truk"],["Pacific/Wake"],["Pacific/Wallis"],["Pacific/Yap"],["Poland"],["Portugal"],["PRC"],["PST8PDT"],["ROC"],["ROK"],["Singapore"],["Turkey"],["UCT"],["Universal"],["US/Alaska"],["US/Aleutian"],["US/Arizona"],["US/Central"],["US/East-Indiana"],["US/Eastern"],["US/Hawaii"],["US/Indiana-Starke"],["US/Michigan"],["US/Mountain"],["US/Pacific"],["US/Pacific-New"],["US/Samoa"],["W-SU"],["WET"],["Zulu"]];GO.PersonalSettingsDialog=function(A){if(!A){A={}}this.buildForm();A.layout="fit";A.modal=false;A.resizable=true;A.maxizable=true;A.width=900;A.height=450;A.closeAction="hide";A.title=GO.lang.settings;A.items=this.formPanel;A.buttons=[{text:GO.lang.cmdOk,handler:function(){this.submitForm(true)},scope:this},{text:GO.lang.cmdApply,handler:function(){this.submitForm()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];GO.PersonalSettingsDialog.superclass.constructor.call(this,A);this.addEvents({save:true})};Ext.extend(GO.PersonalSettingsDialog,Ext.Window,{reload:false,show:function(){this.reload=false;if(!this.rendered){this.render(Ext.getBody());this.tabPanel.items.items[0].languageCombo.on("change",function(){this.reload=true},this);if(this.tabPanel.items.items[1].themeCombo){this.tabPanel.items.items[1].themeCombo.on("change",function(){this.reload=true},this)}}this.formPanel.form.baseParams.user_id=GO.settings.user_id;this.user_id=GO.settings.user_id;if(!this.loaded){this.formPanel.load({url:BaseHref+"json.php",success:function(D,E){this.loaded=true;GO.PersonalSettingsDialog.superclass.show.call(this);for(var B=0;B<this.tabPanel.items.getCount();B++){var A=this.tabPanel.items.itemAt(B);if(A.onLoadSettings){var C=A.onLoadSettings.createDelegate(A,[E]);C.call()}}},failure:function(A,B){Ext.Msg.alert(GO.lang.strError,B.result.feedback)},scope:this})}else{GO.PersonalSettingsDialog.superclass.show.call(this)}},setWritePermission:function(A){this.buttons[0].setDisabled(!A);this.buttons[1].setDisabled(!A);this.linksPanel.setWritePermission(A)},submitForm:function(A){this.formPanel.form.submit({url:BaseHref+"action.php",params:{task:"save_settings"},waitMsg:GO.lang.waitMsgSave,success:function(E,F){this.fireEvent("save",this);for(var C=0;C<this.tabPanel.items.getCount();C++){var B=this.tabPanel.items.itemAt(C);if(B.onSaveSettings){var D=B.onSaveSettings.createDelegate(B,[F]);D.call()}}if(this.reload){document.location=GO.settings.config.host}else{if(A){this.hide()}}},failure:function(B,C){if(C.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,C.result.feedback)}},scope:this})},buildForm:function(){this.tabPanel=new Ext.TabPanel({activeTab:0,deferredRender:false,anchor:"100% 100%",border:false,items:GO.moduleManager.getAllSettingsPanels()});this.formPanel=new Ext.form.FormPanel({items:this.tabPanel,baseParams:{task:"settings"},waitMsgTarget:true,border:false})}});GO.users.RegionalSettingsPanel=function(D){if(!D){D={}}this.autoScroll=true;var E=new Ext.data.SimpleStore({fields:["id","date_format"],data:[["dmY",GO.users.lang.dmy],["mdY",GO.users.lang.mdy],["Ymd",GO.users.lang.jmd]]});var F=new Ext.data.SimpleStore({fields:["id","date_separator"],data:[["-","-"],[".","."],["/","/"]]});var B=new Ext.data.SimpleStore({fields:["id","time_format"],data:[["G:i",GO.users.lang.fullhourformat],["g:i a",GO.users.lang.halfhourformat]]});var C=new Ext.data.SimpleStore({fields:["id","first_weekday"],data:[["0",GO.users.lang.sunday],["1",GO.users.lang.monday]]});var A=GO.settings.date_format.substring(0,1)+GO.settings.date_format.substring(2,3)+GO.settings.date_format.substring(4,5);D.border=false;D.hideLabel=true;D.title=GO.users.lang.regionalSettings;D.layout="column";D.defaults={columnWidth:0.5,cls:"go-form-panel",border:false};D.labelWidth=190;D.items=[{columnWidth:1,items:[{border:false,layout:"form",autoHeight:true,defaults:{anchor:"100%"},items:[this.languageCombo=new Ext.form.ComboBox({fieldLabel:GO.users.lang.cmdFormLabelLanguage,name:"language_id",store:new Ext.data.SimpleStore({fields:["id","language"],data:GO.Languages}),displayField:"language",valueField:"id",hiddenName:"language",mode:"local",triggerAction:"all",editable:false,selectOnFocus:true,forceSelection:true,value:GO.settings.language}),new Ext.form.ComboBox({fieldLabel:GO.users.lang.cmdFormLabelTimezone,name:"timezone",store:new Ext.data.SimpleStore({fields:["timezone"],data:GO.users.TimeZones}),displayField:"timezone",mode:"local",triggerAction:"all",selectOnFocus:true,forceSelection:true,value:GO.settings.timezone}),new Ext.form.ComboBox({fieldLabel:GO.users.lang.cmdFormLabelDateFormat,name:"date_format",store:E,displayField:"date_format",value:A,valueField:"id",hiddenName:"date_format",mode:"local",triggerAction:"all",editable:false,selectOnFocus:true,forceSelection:true}),new Ext.form.ComboBox({fieldLabel:GO.users.lang.cmdFormLabelDateSeperator,name:"date_separator_name",store:F,displayField:"date_separator",value:GO.settings.date_separator,valueField:"id",hiddenName:"date_separator",mode:"local",triggerAction:"all",editable:false,selectOnFocus:true,forceSelection:true}),new Ext.form.ComboBox({fieldLabel:GO.users.lang.timeFormat,name:"time_format_name",store:B,displayField:"time_format",valueField:"id",hiddenName:"time_format",mode:"local",triggerAction:"all",editable:false,selectOnFocus:true,value:GO.settings.time_format,forceSelection:true}),new Ext.form.ComboBox({fieldLabel:GO.users.lang.cmdFormLabelFirstWeekday,name:"first_weekday_name",store:C,displayField:"first_weekday",valueField:"id",hiddenName:"first_weekday",mode:"local",triggerAction:"all",editable:false,selectOnFocus:true,forceSelection:true,value:GO.settings.first_weekday})]}]},{items:[{xtype:"fieldset",defaults:{width:50},autoHeight:true,title:GO.users.lang.numberFormat,items:[{xtype:"textfield",fieldLabel:GO.users.lang.cmdFormLabelThousandSeperator,name:"thousands_separator",value:GO.settings.thousands_separator},{xtype:"textfield",fieldLabel:GO.users.lang.cmdFormLabelDecimalSeperator,name:"decimal_separator",value:GO.settings.decimal_separator},{xtype:"textfield",fieldLabel:GO.users.lang.cmdFormLabelCurrency,name:"currency",value:GO.settings.currency}]}]},{items:[{xtype:"fieldset",defaults:{width:50},autoHeight:true,title:GO.users.lang.importExport,items:[{xtype:"textfield",fieldLabel:GO.users.lang.listSeparator,name:"list_separator",value:GO.settings.list_separator},{xtype:"textfield",fieldLabel:GO.users.lang.textSeparator,name:"text_separator",value:GO.settings.text_separator}]}]}];GO.users.RegionalSettingsPanel.superclass.constructor.call(this,D)};Ext.extend(GO.users.RegionalSettingsPanel,Ext.Panel,{});GO.users.LookAndFeelPanel=function(B){if(!B){B={}}this.autoScroll=true;B.border=false;B.hideLabel=true;B.title=GO.users.lang.cmdPanelLookFeel;B.layout="form";B.defaults={anchor:"100%"};B.defaultType="textfield";B.cls="go-form-panel";B.labelWidth=190;var A=new GO.data.JsonStore({url:GO.settings.modules.users.url+"non_admin_json.php",baseParams:{task:"themes"},root:"results",totalProperty:"total",fields:["theme"],remoteSort:true});this.modulesStore=new GO.data.JsonStore({url:GO.settings.modules.users.url+"non_admin_json.php",baseParams:{task:"start_module",user_id:0},root:"results",totalProperty:"total",id:"id",fields:["id","name"],remoteSort:true});B.items=[];if(GO.settings.config.allow_themes){B.items.push(this.themeCombo=new Ext.form.ComboBox({fieldLabel:GO.users.lang.cmdFormLabelTheme,name:"theme",store:A,displayField:"theme",valueField:"theme",mode:"remote",triggerAction:"all",editable:false,selectOnFocus:true,forceSelection:true,value:GO.settings.config.theme}))}B.items.push(this.startModuleField=new GO.form.ComboBox({fieldLabel:GO.users.lang.cmdFormLabelStartModule,name:"start_module_name",hiddenName:"start_module",store:this.modulesStore,displayField:"name",valueField:"id",mode:"remote",triggerAction:"all",editable:false,selectOnFocus:true,forceSelection:true,value:GO.settings.start_module}));B.items.push({xtype:"combo",fieldLabel:GO.users.lang.cmdFormLabelMaximunRows,store:new Ext.data.SimpleStore({fields:["value"],data:[["10"],["15"],["20"],["25"],["30"],["50"]]}),displayField:"value",valueField:"value",name:"max_rows_list",mode:"local",triggerAction:"all",editable:false,selectOnFocus:true,forceSelection:true,value:30});B.items.push({xtype:"combo",fieldLabel:GO.users.lang.cmdFormLabelSortNamesBy,store:new Ext.data.SimpleStore({fields:["value","text"],data:[["first_name","First name"],["last_name","Last name"]]}),displayField:"text",valueField:"value",hiddenName:"sort_name",mode:"local",triggerAction:"all",editable:false,selectOnFocus:true,forceSelection:true,value:GO.settings.sort_name});B.items.push({xtype:"checkbox",hideLabel:true,boxLabel:GO.users.lang.muteSound,name:"mute_sound"});GO.users.LookAndFeelPanel.superclass.constructor.call(this,B)};Ext.extend(GO.users.LookAndFeelPanel,Ext.Panel,{onLoadSettings:function(A){this.startModuleField.setRemoteText(A.result.data.start_module_name)}});GO.users.PasswordPanel=function(A){if(!A){A={}}A.autoScroll=true;A.border=false;A.hideLabel=true;A.title=GO.users.lang.changePassword;A.layout="form";A.defaults={anchor:"100%"};A.defaultType="textfield";A.cls="go-form-panel";A.labelWidth=140;this.currentPasswordField=new Ext.form.TextField({inputType:"password",fieldLabel:GO.users.lang.currentPassword,name:"current_password"});this.passwordField1=new Ext.form.TextField({inputType:"password",fieldLabel:GO.users.lang.newPassword,name:"password1"});this.passwordField2=new Ext.form.TextField({inputType:"password",fieldLabel:GO.users.lang.confirmPassword,name:"password2"});A.items=[this.currentPasswordField,this.passwordField1,this.passwordField2];GO.users.PasswordPanel.superclass.constructor.call(this,A)};Ext.extend(GO.users.PasswordPanel,Ext.Panel);GO.mainLayout.onReady(function(){GO.moduleManager.addSettingsPanel("regional",GO.users.RegionalSettingsPanel);GO.moduleManager.addSettingsPanel("look_and_feel",GO.users.LookAndFeelPanel);if(GO.settings.config.allow_password_change){GO.moduleManager.addSettingsPanel("password",GO.users.PasswordPanel)}});GO.Window=Ext.extend(Ext.Window,{temporaryListeners:[],addListenerTillHide:function(A,C,B){this.on(A,C,B);this.temporaryListeners.push({eventName:A,fn:C,scope:B})},hide:function(){for(var A=0;A<this.temporaryListeners.length;A++){this.un(this.temporaryListeners[A].eventName,this.temporaryListeners[A].fn,this.temporaryListeners[A].scope)}this.temporaryListeners=[];GO.Window.superclass.hide.call(this)}});GO.LogoComponent=Ext.extend(Ext.BoxComponent,{onRender:function(B,A){this.el=B.createChild({tag:"div",cls:"go-app-logo"})}});GO.dialog.AboutDialog=function(A){Ext.apply(this,A);GO.dialog.AboutDialog.superclass.constructor.call(this,{modal:false,layout:"fit",height:500,width:520,resizable:false,closeAction:"hide",title:GO.lang.strAbout,items:new Ext.Panel({border:false,layout:"fit",autoLoad:"about.php",autoScroll:true}),buttons:[{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}]})};Ext.extend(GO.dialog.AboutDialog,Ext.Window,{});GO.LogoComponent=Ext.extend(Ext.BoxComponent,{onRender:function(B,A){this.el=B.createChild({tag:"div",cls:"go-app-logo"})}});GO.dialog.LoginDialog=function(B){if(!B){B={}}if(typeof (B.modal)=="undefined"){B.modal=true}Ext.apply(this,B);var A=new Ext.form.ComboBox({fieldLabel:GO.lang.strLanguage,name:"language_text",store:new Ext.data.SimpleStore({fields:["id","language"],data:GO.Languages}),anchor:"100%",hiddenName:"language",displayField:"language",valueField:"id",mode:"local",triggerAction:"all",forceSelection:true,editable:false,value:GO.settings.language});A.on("select",function(){document.location=BaseHref+"index.php?SET_LANGUAGE="+A.getValue()},this);this.formPanel=new Ext.FormPanel({labelWidth:120,url:"action.php",defaultType:"textfield",autoHeight:true,waitMsgTarget:true,bodyStyle:"padding:5px 10px 5px 10px",items:[new GO.LogoComponent(),A,{fieldLabel:GO.lang.strUsername,name:"username",allowBlank:false,anchor:"100%"},{fieldLabel:GO.lang.strPassword,name:"password",inputType:"password",allowBlank:false,anchor:"100%"},{xtype:"checkbox",hideLabel:true,boxLabel:GO.lang.remindPassword,name:"remind"},this.fullscreenField=new Ext.form.Checkbox({hideLabel:true,boxLabel:GO.lang.fullscreen,checked:GO.fullscreen,name:"fullscreen"})]});GO.dialog.LoginDialog.superclass.constructor.call(this,{layout:"fit",autoHeight:true,width:400,resizable:false,closeAction:"hide",title:GO.lang.strLogin,closable:false,focus:function(){this.formPanel.form.findField("username").focus(true)}.createDelegate(this),items:[this.formPanel],buttons:[{text:GO.lang.lostPassword,handler:function(){Ext.Msg.prompt(GO.lang.lostPassword,GO.lang.lostPasswordText,function(C,D){if(C=="ok"){Ext.Ajax.request({url:"action.php",params:{task:"lost_password",email:D},callback:function(F,H,E){if(!H){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strRequestError)}else{var G=Ext.decode(E.responseText);if(!G.success){Ext.MessageBox.alert(GO.lang.strError,G.feedback)}else{Ext.MessageBox.alert(GO.lang.strSuccess,G.feedback)}}}})}})},scope:this},{text:GO.lang.cmdOk,handler:this.doLogin,scope:this}],keys:[{key:Ext.EventObject.ENTER,fn:this.doLogin,scope:this}]});this.addEvents({callbackshandled:true})};Ext.extend(GO.dialog.LoginDialog,Ext.Window,{callbacks:new Array(),hideDialog:true,addCallback:function(B,A){this.callbacks.push({callback:B,scope:A})},doLogin:function(){this.formPanel.form.submit({url:BaseHref+"action.php",params:{task:"login"},waitMsg:GO.lang.waitMsgLoad,success:function(A,B){if(GO.settings.user_id>0&&B.result.user_id!=GO.settings.user_id){document.location=document.location;return true}if(B.result.name==""){this.completeProfileDialog()}else{this.handleCallbacks()}if(this.hideDialog){this.hide()}},failure:function(A,B){if(B.result){Ext.MessageBox.alert(GO.lang.strError,B.result.feedback,function(){this.formPanel.form.findField("username").focus(true)},this)}},scope:this})},handleCallbacks:function(){for(var A=0;A<this.callbacks.length;A++){if(this.callbacks[A].callback){var B=this.callbacks[A].scope?this.callbacks[A].scope:this;this.callbacks[A].callback.call(B)}}this.callbacks=[];this.fireEvent("callbackshandled",this)},completeProfileDialog:function(){var A=new Ext.form.FormPanel({waitMsgTarget:true,url:BaseHref+"action.php",border:false,autoHeight:true,cls:"go-form-panel",baseParams:{task:"complete_profile"},defaults:{xtype:"textfield",anchor:"100%"},items:[{fieldLabel:GO.lang.strFirstName,name:"first_name",allowBlank:false},{fieldLabel:GO.lang.strMiddleName,name:"middle_name"},{fieldLabel:GO.lang.strLastName,name:"last_name",allowBlank:false}]});var B=function(){A.items.items[0].focus()};this.completeProfileDialog=new Ext.Window({width:400,autoHeight:true,title:GO.lang.completeProfile,items:A,closable:false,focus:B.createDelegate(this),buttons:[{text:GO.lang.cmdOk,handler:function(){A.form.submit({waitMsg:GO.lang.waitMsgSave,success:function(C,D){this.handleCallbacks()},failure:function(C,D){if(D.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,D.result.feedback)}},scope:this})},scope:this}]});this.completeProfileDialog.show()}});GO.mainLayout.onReady(function(){GO.loginDialog=new GO.dialog.LoginDialog()});GO.data.Connection=Ext.extend(Ext.data.Connection,{timeout:60000,request:function(A){if(!GO.checkerIcon){GO.checkerIcon=Ext.get("checker-icon")}if(GO.checkerIcon){GO.checkerIcon.setDisplayed(true)}if(A.callback){A.originalCallback=A.callback}A.loginCallback=function(){var B=A;B.callback=A.originalCallback;this.request(B)};A.loginCallbackScope=this;A.callback=this.authHandler;GO.data.Connection.superclass.request.call(this,A)},authHandler:function(B,D,A){if(GO.checkerIcon){GO.checkerIcon.setDisplayed(false)}if(!D){Ext.callback(B.originalCallback,B.scope,[B,D,A])}else{if(A.responseText.substr(0,1)=="{"){var C=Ext.decode(A.responseText)}else{var C={}}if(C.authError){switch(C.authError){case"UNAUTHORIZED":Ext.Msg.alert(GO.lang.strUnauthorized,GO.lang.strUnauthorizedText);break;case"NOTLOGGEDIN":GO.loginDialog.addCallback(B.loginCallback,B.loginCallbackScope);GO.loginDialog.show();break}return false}else{Ext.callback(B.originalCallback,B.scope,[B,D,A])}}}});Ext.Ajax=new GO.data.Connection({autoAbort:false,serializeForm:function(A){return Ext.lib.Ajax.serializeForm(A)}});GO.data.JsonStore=function(A){GO.data.JsonStore.superclass.constructor.call(this,A);this.on("load",function(){this.loaded=true},this);this.on("loadexception",function(D,C,B,E){if(B.status==0){GO.errorDialog.show(GO.lang.strRequestError,"")}else{if(!this.reader.jsonData||GO.jsonAuthHandler(this.reader.jsonData,this.load,this)){var F=GO.lang.serverError;if(this.reader.jsonData&&this.reader.jsonData.feedback){F+="<br /><br />"+this.reader.jsonData.feedback}GO.errorDialog.show(F,B.responseText)}}},this)};Ext.extend(GO.data.JsonStore,Ext.data.JsonStore,{loaded:false});GO.grid.GridPanel=function(A){if(!A){A={}}if(!A.keys){A.keys=[]}if(!A.store){A.store=A.ds}A.keys.push({key:Ext.EventObject.DELETE,fn:function(B,C){if(C.target.tagName!="INPUT"){this.deleteSelected(this.deleteConfig)}},scope:this});if(A.paging){if(!A.bbar){A.bbar=new Ext.PagingToolbar({cls:"go-paging-tb",store:A.store,pageSize:parseInt(GO.settings.max_rows_list),displayInfo:true,displayMsg:GO.lang.displayingItems,emptyMsg:GO.lang.strNoItems})}if(!A.store.baseParams){A.store.baseParams={}}A.store.baseParams.limit=parseInt(GO.settings.max_rows_list)}GO.grid.GridPanel.superclass.constructor.call(this,A);if(!this.deleteConfig){this.deleteConfig={}}this.addEvents({delayedrowselect:true});this.on("rowcontextmenu",function(B,E,C){C.stopEvent();this.rowClicked=true;var D=this.getSelectionModel();if(D.isSelected(E)!==true){D.clearSelections();D.selectRow(E)}},this);this.on("rowclick",function(C,E,D){if(!D.ctrlKey&&!D.shiftKey){var B=this.getSelectionModel().getSelected();this.fireEvent("delayedrowselect",this,E,B)}this.rowClicked=true},this);this.getSelectionModel().on("rowselect",function(E,D,C){if(!this.rowClicked){var B=this.getSelectionModel().getSelected();if(B==C){this.fireEvent("delayedrowselect",this,D,C)}}this.rowClicked=false},this,{delay:400})};Ext.extend(GO.grid.GridPanel,Ext.grid.GridPanel,{paging:false,deleteSelected:function(B){if(!B){B=this.deleteConfig}if(!B.deleteParam){B.deleteParam="delete_keys"}var C=this.selModel.selections.keys;var D={};D[B.deleteParam]=Ext.encode(this.selModel.selections.keys);var A={store:this.store,params:D,count:this.selModel.selections.keys.length};if(B.callback){A.callback=B.callback}if(B.success){A.success=B.success}if(B.failure){A.failure=B.failure}if(B.scope){A.scope=B.scope}GO.deleteItems(A)},getGridData:function(){var D={};for(var B=0;B<this.store.data.items.length;B++){var C=this.store.data.items[B].data;D[B]={};for(var A in C){D[B][A]=C[A]}}return D},numberRenderer:function(A){return GO.util.numberFormat(A)}});GO.menu.RecordsContextMenu=Ext.extend(Ext.menu.Menu,{records:[],showAt:function(E,B){this.records=B;var A=this.records.length>1;for(var C=0;C<this.items.getCount();C++){var D=this.items.get(C);D.setDisabled(!D.multiple&&A)}GO.menu.RecordsContextMenu.superclass.showAt.call(this,E)}});GO.grid.SimpleSelectList=function(B){if(!B){B={}}if(!B.tpl){var A="";if(B.title){A+="<b>"+B.title+":</b>"}A+='<tpl for="."><div id="{dom_id}" class="go-item-wrap">{name}</div></tpl>';B.tpl=new Ext.XTemplate(A)}else{var A=B.tpl}B.singleSelect=true;B.autoHeight=true;B.overClass="go-view-over";B.itemSelector="div.go-item-wrap";B.selectedClass="go-view-selected";GO.grid.SimpleSelectList.superclass.constructor.call(this,B)};Ext.extend(GO.grid.SimpleSelectList,Ext.DataView,{onRender:function(B,A){this.el=B.createChild({tag:"div",cls:"go-select-list"});GO.grid.SimpleSelectList.superclass.onRender.apply(this,arguments)}});GO.grid.CheckColumn=function(A){Ext.apply(this,A);if(!this.id){this.id=Ext.id()}this.renderer=this.renderer.createDelegate(this);this.addEvents({change:true});GO.grid.CheckColumn.superclass.constructor.call(this)};Ext.extend(GO.grid.CheckColumn,Ext.util.Observable,{disabled_field:"disabled",init:function(A){this.grid=A;this.grid.on("render",function(){var B=this.grid.getView();B.mainBody.on("mousedown",this.onMouseDown,this)},this)},onMouseDown:function(F,C){if(C.className&&C.className.indexOf("x-grid3-cc-"+this.id)!=-1){F.stopEvent();var B=this.grid.getView().findRowIndex(C);var A=this.grid.store.getAt(B);var D=A.get(this.disabled_field);if(!D){var E=A.data[this.dataIndex]=="1"?"0":"1";A.set(this.dataIndex,E);this.fireEvent("change",A,E)}}},renderer:function(C,E,B){E.css+=" x-grid3-check-col-td";var D=B.get(this.disabled_field);if(C=="1"){if(D){var A="-on x-item-disabled"}else{var A="-on"}}else{if(D){var A=" x-item-disabled"}else{var A=""}}return'<div class="x-grid3-check-col'+A+" x-grid3-cc-"+this.id+'">&#160;</div>'}});Ext.namespace("GO.util");GO.util.empty=function(A){if(!A){return true}if(A==""){return true}if(A=="0"){return true}if(A=="undefined"){return true}if(A=="null"){return true}return false};GO.mailTo=function(A){if(GO.email&&GO.settings.modules.email.read_permission){return'<a href="#" onclick="GO.email.showAddressMenu(event, \''+A+"','');\">"+A+"</a>"}else{return'<a href="mailto:'+A+'">'+A+"</a>"}};GO.util.getFileExtension=function(A){var C=A.lastIndexOf(".");var B="";if(C){B=A.substr(C+1)}return B.toLowerCase()};GO.playAlarm=function(){if(GO.util.empty(GO.settings.mute_sound)){var A=GO.util.getFlashMovieObject("alarmSound");if(A){A.Play()}}};GO.util.nl2br=function(A){return A.replace(/\n/g,"<br />")};GO.util.clone=function(C){if("object"!==typeof C){return C}var D="function"===typeof C.pop?[]:{};var B,A;for(B in C){A=C[B];if("object"===typeof A){D[B]=GO.util.clone(A)}else{D[B]=A}}return D};GO.jsonAuthHandler=function(A,C,B){if(A.authError){switch(A.authError){case"UNAUTHORIZED":alert(GO.lang.strUnauthorizedText);return false;case"NOTLOGGEDIN":if(C){GO.loginDialog.addCallback(C,B)}GO.loginDialog.show();return false}}return true};GO.deleteItems=function(A){switch(A.count){case 0:alert(GO.lang.noItemSelected);return false;case 1:var C=GO.lang.strDeleteSelectedItem;break;default:var B=new Ext.Template(GO.lang.strDeleteSelectedItems);var C=B.applyTemplate({count:A.count});break}if(confirm(C)){if(A.store){for(var D in A.params){A.store.baseParams[D]=A.params[D]}A.store.reload({callback:function(){if(!this.reader.jsonData.deleteSuccess){if(A.failure){callback=A.failure.createDelegate(A.scope);callback.call(A.scope,A)}alert(this.reader.jsonData.deleteFeedback)}else{if(A.success){callback=A.success.createDelegate(A.scope);callback.call(A.scope,A)}}if(A.callback){callback=A.callback.createDelegate(A.scope);callback.call(this,A)}}});for(var D in A.params){delete A.store.baseParams[D]}}else{Ext.Ajax.request({url:A.url,params:A.params,callback:function(F,H,E){var G=Ext.decode(E.responseText);if(!G.success){if(A.failure){callback=A.failure.createDelegate(A.scope);callback.call(this,G)}alert(G.feedback)}else{if(A.success){callback=A.success.createDelegate(A.scope);callback.call(this,G)}}if(A.callback){callback=A.callback.createDelegate(A.scope);callback.call(this,G)}}})}}};GO.util.getFlashMovieObject=function(A){if(window.document[A]){return window.document[A]}if(navigator.appName.indexOf("Microsoft Internet")==-1){if(document.embeds&&document.embeds[A]){return document.embeds[A]}}else{return document.getElementById(A)}};GO.util.unlocalizeNumber=function(C,A,D){if(!A){A=GO.settings.decimal_separator}if(!D){D=GO.settings.thousands_separator}C=C+"";var B=new RegExp("["+D+"]","g");C=C.replace(B,"");return C.replace(A,".")};String.prototype.regexpEscape=function(){var A=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];var B=new RegExp("(\\"+A.join("|\\")+")","g");return this.replace(B,"\\$1")};GO.util.numberFormat=function(F,C,I,D){if(typeof (C)=="undefined"){C=2}if(!I){I=GO.settings.decimal_separator}if(!D){D=GO.settings.thousands_separator}if(F==""){return""}var J=parseFloat(F);J=J.toFixed(C);if(C>0){var B=J.indexOf(".");if(!B){J=J+".";B=J.indexOf(".")}var G=J.length-B;for(i=G;i<=C;i++){J=J+"0"}var H=I+J.substring(B+1);var E=C;while(H.substring(H.length-1)=="0"&&E>C){E--;H=H.substring(0,H.length-1)}}else{var H="";var B=J.length}var A=0;for(i=B-1;i>=0;i--){if(A==3&&J.substr(i,1)!="-"){H=D+H;A=0}H=J.substr(i,1)+H;A++}if(H==",NaN"){H=GO.util.numberFormat("0",C,I,D)}return H};GO.util.popup=function(C){if(!C.width){C.width=screen.availWidth;C.height=screen.availHeight}if(!C.target){C.target="_blank"}var B;x=(screen.availWidth-C.width)/2;y=(screen.availHeight-C.height)/2;B=",width="+C.width+",height="+C.height+",left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no";var A=window.open(C.url,C.target,B);if(!A){alert(GO.lang.popupBlocker);return false}if(!A.opener){A.opener=self}A.focus();return A};GO.util.get_html_translation_table=function(I,F){var D={},H={},C=0,A="";var E={},B={};var J={},G={};J=(I?I.toUpperCase():"HTML_SPECIALCHARS");G=(F?F.toUpperCase():"ENT_COMPAT");E[0]="HTML_SPECIALCHARS";E[1]="HTML_ENTITIES";B[0]="ENT_NOQUOTES";B[2]="ENT_COMPAT";B[3]="ENT_QUOTES";if(!isNaN(J)){J=E[J]}if(!isNaN(G)){G=B[G]}if(J=="HTML_SPECIALCHARS"){D["38"]="&amp;";D["60"]="&lt;";D["62"]="&gt;"}else{if(J=="HTML_ENTITIES"){D["38"]="&amp;";D["60"]="&lt;";D["62"]="&gt;";D["160"]="&nbsp;";D["161"]="&iexcl;";D["162"]="&cent;";D["163"]="&pound;";D["164"]="&curren;";D["165"]="&yen;";D["166"]="&brvbar;";D["167"]="&sect;";D["168"]="&uml;";D["169"]="&copy;";D["170"]="&ordf;";D["171"]="&laquo;";D["172"]="&not;";D["173"]="&shy;";D["174"]="&reg;";D["175"]="&macr;";D["176"]="&deg;";D["177"]="&plusmn;";D["178"]="&sup2;";D["179"]="&sup3;";D["180"]="&acute;";D["181"]="&micro;";D["182"]="&para;";D["183"]="&middot;";D["184"]="&cedil;";D["185"]="&sup1;";D["186"]="&ordm;";D["187"]="&raquo;";D["188"]="&frac14;";D["189"]="&frac12;";D["190"]="&frac34;";D["191"]="&iquest;";D["192"]="&Agrave;";D["193"]="&Aacute;";D["194"]="&Acirc;";D["195"]="&Atilde;";D["196"]="&Auml;";D["197"]="&Aring;";D["198"]="&AElig;";D["199"]="&Ccedil;";D["200"]="&Egrave;";D["201"]="&Eacute;";D["202"]="&Ecirc;";D["203"]="&Euml;";D["204"]="&Igrave;";D["205"]="&Iacute;";D["206"]="&Icirc;";D["207"]="&Iuml;";D["208"]="&ETH;";D["209"]="&Ntilde;";D["210"]="&Ograve;";D["211"]="&Oacute;";D["212"]="&Ocirc;";D["213"]="&Otilde;";D["214"]="&Ouml;";D["215"]="&times;";D["216"]="&Oslash;";D["217"]="&Ugrave;";D["218"]="&Uacute;";D["219"]="&Ucirc;";D["220"]="&Uuml;";D["221"]="&Yacute;";D["222"]="&THORN;";D["223"]="&szlig;";D["224"]="&agrave;";D["225"]="&aacute;";D["226"]="&acirc;";D["227"]="&atilde;";D["228"]="&auml;";D["229"]="&aring;";D["230"]="&aelig;";D["231"]="&ccedil;";D["232"]="&egrave;";D["233"]="&eacute;";D["234"]="&ecirc;";D["235"]="&euml;";D["236"]="&igrave;";D["237"]="&iacute;";D["238"]="&icirc;";D["239"]="&iuml;";D["240"]="&eth;";D["241"]="&ntilde;";D["242"]="&ograve;";D["243"]="&oacute;";D["244"]="&ocirc;";D["245"]="&otilde;";D["246"]="&ouml;";D["247"]="&divide;";D["248"]="&oslash;";D["249"]="&ugrave;";D["250"]="&uacute;";D["251"]="&ucirc;";D["252"]="&uuml;";D["253"]="&yacute;";D["254"]="&thorn;";D["255"]="&yuml;"}else{throw Error("Table: "+J+" not supported");return false}}if(G!="ENT_NOQUOTES"){D["34"]="&quot;"}if(G=="ENT_QUOTES"){D["39"]="&#039;"}for(C in D){A=String.fromCharCode(C);H[A]=D[C]}return H};GO.util.html_entity_decode=function(B,F){B+="";var E={},D="",A="",C=0;A=B.toString();if(false===(E=GO.util.get_html_translation_table("HTML_ENTITIES",F))){return false}for(D in E){entity=E[D];A=A.split(entity).join(D)}return A};GO.util.add_slashes=function(A){return(A+"").replace(/([\\"'])/g,"\\$1").replace(/\0/g,"\\0")};GO.util.basename=function(A){var B=A.lastIndexOf("/");if(B){A=A.substring(B+1)}return A};GO.util.dirname=function(A){var B=A.lastIndexOf("/");if(B){A=A.substring(0,B)}return A};GO.state.HttpProvider=function(A){GO.state.HttpProvider.superclass.constructor.call(this);this.url=BaseHref+"state.php";Ext.apply(this,A);this.state=this.readValues()};Ext.extend(GO.state.HttpProvider,Ext.state.Provider,{set:function(A,B){if(A.substr(0,4)!="ext-"){if(typeof B=="undefined"||B===null){this.clear(A);return }this.setValue(A,B);GO.state.HttpProvider.superclass.set.call(this,A,B)}},clear:function(A){this.clearValue(A);GO.state.HttpProvider.superclass.clear.call(this,A)},readValues:function(){var B={};for(var A in GO.settings.state){if(A!="remove"){B[A]=this.decodeValue(GO.settings.state[A])}}return B},setValue:function(A,C){var B=new Ext.data.Connection();Ext.Ajax.request({url:this.url,params:{task:"set",name:A,value:this.encodeValue(C),index:GO.settings.state_index}})},clearValue:function(A){var B=new Ext.data.Connection();B.request({url:this.url,params:{task:"set",name:A,value:"null"}})}});Ext.DataView.DragSelector=function(G){G=G||{};var J,D,I,L;var E,K,M=new Ext.lib.Region(0,0,0,0);var B=G.dragSafe===true;this.init=function(Q){J=Q;J.on("render",P)};function N(){E=[];J.all.each(function(Q){E[E.length]=Q.getRegion()});K=J.el.getRegion()}function F(){return false}function H(Q){return !B||Q.target==J.el.dom}function O(Q){J.on("containerclick",F,J,{single:true});if(!I){I=J.el.createChild({cls:"x-view-selector"})}else{I.setDisplayed("block")}N();J.clearSelections()}function C(V){var W=L.startXY;var a=L.getXY();var Y=Math.min(W[0],a[0]);var X=Math.min(W[1],a[1]);var Z=Math.abs(W[0]-a[0]);var T=Math.abs(W[1]-a[1]);M.left=Y;M.top=X;M.right=Y+Z;M.bottom=X+T;M.constrainTo(K);I.setRegion(M);for(var S=0,U=E.length;S<U;S++){var Q=E[S],R=M.intersect(Q);if(R&&!Q.selected){Q.selected=true;J.select(S,true)}else{if(!R&&Q.selected){Q.selected=false;J.deselect(S)}}}}function A(Q){if(I){I.setDisplayed(false)}}function P(Q){L=new Ext.dd.DragTracker({onBeforeStart:H,onStart:O,onDrag:C,onEnd:A});L.initEl(Q.el)}};GO.plugins.HtmlEditorImageInsert=function(A){A=A||{};Ext.apply(this,A);this.init=function(B){this.editor=B;this.editor.on("render",this.onRender,this)};this.addEvents({insert:true})};Ext.extend(GO.plugins.HtmlEditorImageInsert,Ext.util.Observable,{onRender:function(){if(!Ext.isSafari){this.editor.tb.add({itemId:"htmlEditorImage",cls:"x-btn-icon go-edit-insertimage",enableToggle:false,scope:this,handler:function(){this.showFileBrowser()},clickEvent:"mousedown",tabIndex:-1,tooltip:{title:GO.lang.image,text:GO.lang.insertImage}})}},showFileBrowser:function(){if(!GO.files){alert(GO.lang.noFilesModule);return false}if(!this.fileBrowser){this.fileBrowser=new GO.files.FileBrowser({border:false,fileClickHandler:this.selectImage,filesFilter:"jpg,png,gif,jpeg,bmp",scope:this});this.fileBrowserWindow=new Ext.Window({title:"Select files",height:480,width:680,layout:"fit",border:false,closeAction:"hide",items:this.fileBrowser,buttons:[{text:GO.lang.cmdOk,handler:this.selectImage,scope:this},{text:GO.lang.cmdClose,handler:function(){this.fileBrowserWindow.hide()},scope:this}]})}this.fileBrowserWindow.show.defer(200,this.fileBrowserWindow)},selectImage:function(){var A=this.fileBrowser.getSelectedGridRecords();if(A.length){this.selectedPath=A[0].data.path;this.selectedUrl=GO.settings.modules.files.url+"download.php?path="+encodeURIComponent(this.selectedPath);var B='<img src="'+this.selectedUrl+'" border="0" />';this.fireEvent("insert",this);this.editor.insertAtCursor(B)}this.fileBrowserWindow.hide()}});GO.DisplayPanel=Ext.extend(Ext.Panel,{link_type:0,newMenuButton:false,template:"",templateConfig:{notEmpty:function(A){if(A&&A.length){return true}}},loadParams:{},idParam:"",loadUrl:"",data:{},saveHandlerAdded:false,addSaveHandler:function(A){if(!this.saveHandlerAdded){A.on("save",this.onSave,this);this.saveHandlerAdded=true}},createTopToolbar:function(){this.newMenuButton=new GO.NewMenuButton();var A=[];A.push(this.editButton=new Ext.Button({iconCls:"btn-edit",text:GO.lang.cmdEdit,cls:"x-btn-text-icon",handler:this.editHandler,scope:this,disabled:true}));A.push(this.linkBrowseButton=new Ext.Button({iconCls:"btn-link",cls:"x-btn-text-icon",text:GO.lang.cmdBrowseLinks,handler:function(){GO.linkBrowser.show({link_id:this.data.id,link_type:this.link_type,folder_id:"0"});GO.linkBrowser.on("hide",this.reload,this,{single:true})},scope:this}));if(GO.files){A.push(this.fileBrowseButton=new Ext.Button({iconCls:"go-menu-icon-files",cls:"x-btn-text-icon",text:GO.files.lang.files,handler:function(){GO.files.openFolder(this.data.files_folder_id);GO.files.fileBrowserWin.on("hide",this.reload,this,{single:true})},scope:this,disabled:true}))}A.push(this.newMenuButton);A.push("-");A.push({iconCls:"btn-refresh",tooltip:GO.lang.cmdRefresh,handler:this.reload,scope:this});A.push({iconCls:"btn-print",tooltip:GO.lang.cmdPrint,handler:function(){this.body.print()},scope:this});return A},initComponent:function(){this.autoScroll=true;this.split=true;this.tbar=this.createTopToolbar();this.xtemplate=new Ext.XTemplate(this.template,this.templateConfig);this.xtemplate.compile();GO.DisplayPanel.superclass.initComponent.call(this)},afterRender:function(){this.getTopToolbar().setDisabled(true);GO.DisplayPanel.superclass.afterRender.call(this)},getLinkName:function(){return this.data.name},onSave:function(A,B){if(B>0&&this.data.id==B){this.reload()}},gridDeleteCallback:function(A){if(this.data){var C=Ext.decode(A.params.delete_keys);for(var B=0;B<C.length;B++){if(this.data.id==C[B]){this.reset()}}}},reset:function(){this.body.removeAllListeners();this.body.update("");this.getTopToolbar().setDisabled(true)},setData:function(A){this.body.removeAllListeners();A.link_type=this.link_type;this.data=A;this.getTopToolbar().setDisabled(false);this.editButton.setDisabled(!A.write_permission);if(A.write_permission){this.newMenuButton.setLinkConfig({id:this.data.id,type:this.link_type,text:this.getLinkName(),callback:this.reload,scope:this})}else{this.newMenuButton.setDisabled(true)}if(GO.files){this.fileBrowseButton.setDisabled(A.files_folder_id<1)}this.xtemplate.overwrite(this.body,A);this.body.on("click",this.onBodyClick,this)},onBodyClick:function(F,G){if(G.tagName!="A"){G=Ext.get(G).findParent("A",10);if(!G){return false}}if(G.tagName=="A"){var A=G.attributes.href.value;if(GO.email&&A.substr(0,6)=="mailto"){var K=A.indexOf("?");if(K>0){var H=A.substr(7,K-8)}else{var H=A.substr(7)}F.preventDefault();GO.email.addressContextMenu.showAt(F.getXY(),H)}else{var I=A.indexOf("#link_");if(I>-1){F.preventDefault();var E=A.substr(I+6,A.length);var J=this.data.links[E];if(J.link_type=="folder"){GO.linkBrowser.show({link_id:J.parent_link_id,link_type:J.parent_link_type,folder_id:J.id})}else{GO.linkHandlers[J.link_type].call(this,J.id,{data:J})}}else{I=A.indexOf("#files_");if(I>-1){var E=A.substr(I+7,A.length);var C=this.data.files[E];if(C.extension=="folder"){var B=GO.files.openFolder(this.data.files_folder_id,C.id)}else{var D=new GO.files.FileRecord(C);GO.files.filePropertiesDialog.show(D.get("id"))}}}}}},load:function(B,A){if(this.data.id!=B||A){this.loadParams[this.idParam]=B;this.body.mask(GO.lang.waitMsgLoad);Ext.Ajax.request({url:this.loadUrl,params:this.loadParams,callback:function(D,F,C){this.body.unmask();if(!F){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strRequestError)}else{var E=Ext.decode(C.responseText);this.setData(E.data)}},scope:this})}},reload:function(){if(this.data.id){this.load(this.data.id,true)}},editHandler:function(){}});GO.panel.IFrameComponent=Ext.extend(Ext.BoxComponent,{onRender:function(B,A){if(!this.name){this.name=""}this.el=B.createChild({tag:"iframe",id:this.id,frameBorder:0,src:this.url,name:this.name})},setUrl:function(A){this.el.set({src:A})}});GO.dialog.SelectGroups=function(A){Ext.apply(this,A);this.store=new GO.data.JsonStore({url:BaseHref+"json.php",root:"results",totalProperty:"total",id:"id",fields:["id","name","user_id","user_name"],remoteSort:true,baseParams:{task:"groups"}});this.grid=new GO.grid.GridPanel({paging:true,border:false,store:this.store,view:new Ext.grid.GridView({autoFill:true,forceFit:true}),columns:[{header:GO.lang.strName,dataIndex:"name",css:"white-space:normal;",sortable:true}],sm:new Ext.grid.RowSelectionModel()});this.grid.on("rowdblclick",function(){this.callHandler(true)},this);this.store.load();Ext.Window.superclass.constructor.call(this,{layout:"fit",modal:false,height:400,width:600,closeAction:"hide",title:GO.lang.strSelectGroups,items:this.grid,buttons:[{text:GO.lang.cmdOk,handler:function(){this.callHandler(true)},scope:this},{text:GO.lang.cmdAdd,handler:function(){this.callHandler(false)},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}],keys:[{key:Ext.EventObject.ENTER,fn:function(){this.callHandler(true)},scope:this}]})};Ext.extend(GO.dialog.SelectGroups,Ext.Window,{callHandler:function(A){if(this.handler){if(!this.scope){this.scope=this}var B=this.handler.createDelegate(this.scope,[this.grid]);B.call()}if(A){this.hide()}}});GO.dialog.SelectUsers=function(A){Ext.apply(this,A);this.store=new GO.data.JsonStore({url:GO.settings.modules.users.url+"non_admin_json.php",root:"results",totalProperty:"total",id:"id",fields:["id","name","email"],remoteSort:true,baseParams:{task:"users"}});this.searchField=new GO.form.SearchField({store:this.store,width:320});this.grid=new GO.grid.GridPanel({paging:true,border:false,store:this.store,view:new Ext.grid.GridView({autoFill:true,forceFit:true}),columns:[{header:GO.lang.strName,dataIndex:"name",sortable:true},{header:GO.lang.strEmail,dataIndex:"email",sortable:true}],sm:new Ext.grid.RowSelectionModel(),tbar:[GO.lang.strSearch+": "," ",this.searchField]});this.grid.on("rowdblclick",function(){this.callHandler(true)},this);var B=function(){this.searchField.focus(true)};GO.dialog.SelectUsers.superclass.constructor.call(this,{layout:"fit",modal:false,height:400,width:600,closeAction:"hide",focus:B.createDelegate(this),title:GO.lang.strSelectUsers,items:this.grid,buttons:[{text:GO.lang.cmdOk,handler:function(){this.callHandler(true)},scope:this},{text:GO.lang.cmdAdd,handler:function(){this.callHandler(false)},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}]})};Ext.extend(GO.dialog.SelectUsers,Ext.Window,{show:function(){if(!this.grid.store.loaded){this.grid.store.load()}GO.dialog.SelectUsers.superclass.show.call(this)},callHandler:function(A){if(this.handler){if(!this.scope){this.scope=this}var B=this.handler.createDelegate(this.scope,[this.grid]);B.call()}if(A){this.hide()}}});GO.dialog.SelectEmail=function(B){Ext.apply(this,B);var A=Array();this.usersStore=new GO.data.JsonStore({url:GO.settings.modules.users.url+"non_admin_json.php",baseParams:{task:"users"},id:"id",root:"results",totalProperty:"total",fields:["id","username","name","company","logins","lastlogin","registration_time","address","zip","city","state","country","phone","email","waddress","wzip","wcity","wstate","wcountry","wphone"],remoteSort:true});this.usersSearchField=new GO.form.SearchField({store:this.usersStore,width:320});this.usersGrid=new GO.grid.GridPanel({id:"select-users-grid",title:GO.addressbook.lang.users,paging:true,border:false,store:this.usersStore,view:new Ext.grid.GridView({autoFill:true,forceFit:true}),columns:[{header:GO.lang.strName,dataIndex:"name",css:"white-space:normal;",sortable:true},{header:GO.lang.strEmail,dataIndex:"email",css:"white-space:normal;",sortable:true}],sm:new Ext.grid.RowSelectionModel(),tbar:[GO.lang.strSearch+": "," ",this.usersSearchField]});this.usersGrid.on("show",function(){this.usersStore.load()},this);this.usersGrid.on("rowdblclick",function(){this.callHandler(true)},this);A.push(this.usersGrid);if(GO.addressbook){this.contactsStore=new GO.data.JsonStore({url:GO.settings.modules.addressbook.url+"json.php",baseParams:{task:"contacts"},root:"results",id:"id",totalProperty:"total",fields:["id","name","company_name","email","home_phone","work_phone","work_fax","cellular"],remoteSort:true});this.contactsSearchField=new GO.form.SearchField({store:this.contactsStore,width:320});this.contactsGrid=new GO.grid.GridPanel({id:"select-contacts-grid",title:GO.addressbook.lang.contacts,paging:true,border:false,store:this.contactsStore,view:new Ext.grid.GridView({autoFill:true,forceFit:true}),columns:[{header:GO.lang.strName,dataIndex:"name",css:"white-space:normal;",sortable:true},{header:GO.lang.strEmail,dataIndex:"email",css:"white-space:normal;",sortable:true}],sm:new Ext.grid.RowSelectionModel(),tbar:[GO.lang.strSearch+": "," ",this.contactsSearchField]});this.contactsGrid.on("show",function(){this.contactsStore.load()},this);this.contactsGrid.on("rowdblclick",function(){this.callHandler(true)},this);this.companiesStore=new GO.data.JsonStore({url:GO.settings.modules.addressbook.url+"json.php",baseParams:{task:"companies"},totalProperty:"total",root:"results",id:"id",fields:["id","name","city","email","phone","homepage","address","zip"],remoteSort:true});this.companySearchField=new GO.form.SearchField({store:this.companiesStore,width:320});this.companyGrid=new GO.grid.GridPanel({id:"select-companies-grid",title:GO.addressbook.lang.companies,paging:true,border:false,store:this.companiesStore,view:new Ext.grid.GridView({autoFill:true,forceFit:true}),columns:[{header:GO.lang.strName,dataIndex:"name",css:"white-space:normal;",sortable:true},{header:GO.lang.strEmail,dataIndex:"email",css:"white-space:normal;",sortable:true}],sm:new Ext.grid.RowSelectionModel(),tbar:[GO.lang.strSearch+": "," ",this.companySearchField]});this.companyGrid.on("show",function(){this.companiesStore.load()},this);this.companyGrid.on("rowdblclick",function(){this.callHandler(true)},this);A.push(this.contactsGrid);A.push(this.companyGrid)}this.tabPanel=new Ext.TabPanel({activeTab:0,items:A});Ext.Window.superclass.constructor.call(this,{layout:"fit",modal:false,height:400,width:600,closeAction:"hide",title:GO.lang.strSelectEmail,items:this.tabPanel,buttons:[{text:GO.lang.cmdOk,handler:function(){this.callHandler(true)},scope:this},{text:GO.lang.cmdAdd,handler:function(){this.callHandler(false)},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}]})};Ext.extend(GO.dialog.SelectEmail,Ext.Window,{callHandler:function(A){if(this.handler){if(!this.scope){this.scope=this}var C;switch(this.tabPanel.getLayout().activeItem.id){case"select-users-grid":C=this.usersGrid;break;case"select-contacts-grid":C=this.contactsGrid;break;case"select-companies-grid":C=this.companiesGrid;break}var B=this.handler.createDelegate(this.scope,[C]);B.call()}if(A){this.hide()}}});GO.ErrorDialog=function(A){A=A||{};Ext.apply(A,{width:550,height:300,autoHeight:true,closeAction:"hide",plain:true,border:false,closable:true,title:GO.lang.strError,modal:false,items:[this.messagePanel=new Ext.FormPanel({region:"center",cls:"go-error-dialog",autoHeight:true,html:""}),this.detailPanel=new Ext.Panel({region:"south",collapsible:true,collapsed:true,height:150,title:GO.lang.errorDetails,titleCollapse:true,autoScroll:true,html:""})],buttons:[{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}]});GO.ErrorDialog.superclass.constructor.call(this,A)};Ext.extend(GO.ErrorDialog,GO.Window,{show:function(A,B){if(!this.rendered){this.render(Ext.getBody())}this.detailPanel.collapse();this.messagePanel.body.update(A);if(GO.util.empty(B)){this.detailPanel.hide()}else{this.detailPanel.show();this.detailPanel.body.update("<pre>"+B+"</pre>")}GO.ErrorDialog.superclass.show.call(this)}});GO.errorDialog=new GO.ErrorDialog();GO.form.TreeSelect=Ext.extend(Ext.form.TriggerField,{triggerClass:"go-form-tree-select",onTriggerClick:function(){if(!this.treeSelectWindow){this.treeSelectWindow=new GO.form.TreeSelectWindow({textfield:this})}this.treeSelectWindow.show()}});GO.form.TreeSelectWindow=Ext.extend(function(A){A=A||{};A.title=A.textfield.windowTitle||"";this.treePanel=new Ext.tree.TreePanel({layout:"fit",loader:A.textfield.treeLoader,containerScroll:true,autoScroll:true,rootVisible:false,root:{nodeType:"async",id:"root"}});A.layout="fit";A.items=[this.treePanel];A.modal=true;A.width=640;A.height=400;A.closeAction="hide";A.closable=true;A.buttons=[{text:GO.lang.cmdOk,handler:function(){var D=[],B=this.treePanel.getChecked();var G=this.textfield.getValue();var C=G.split(",");for(var E=0;E<C.length;E++){if(C[E]!=""){var F=this.treePanel.getNodeById(C[E]);if(!F){D.push(C[E])}}}Ext.each(B,function(H){D.push(H.id)});this.textfield.setValue(D.join(","));this.hide()},scope:this}];GO.form.TreeSelectWindow.superclass.constructor.call(this,A);this.treePanel.on("load",function(D){var B=this.textfield.getValue();var C=B.split(",");Ext.each(D.childNodes,function(F){var E=C.indexOf(F.id);if(E>-1){F.attributes.checked=true}})},this);this.on("show",function(){var B=this.textfield.getValue();var D=B.split(",");this.clearChecked();for(var C=0;C<D.length;C++){var E=this.treePanel.getNodeById(D[C]);if(E){E.getUI().toggleCheck(true)}}},this)},GO.Window,{clearChecked:function(){var A=this.treePanel.getChecked();Ext.each(A,function(B){B.getUI().toggleCheck(false)})}});Ext.reg("treeselect",GO.form.TreeSelect);GO.form.SearchField=Ext.extend(Ext.form.TwinTriggerField,{initComponent:function(){GO.form.SearchField.superclass.initComponent.call(this);this.on("specialkey",function(A,B){if(B.getKey()==B.ENTER){this.onTrigger2Click()}},this);this.on("focus",function(){this.focus(true)},this)},validationEvent:false,validateOnBlur:false,trigger1Class:"x-form-clear-trigger",trigger2Class:"x-form-search-trigger",width:180,hasSearch:false,paramName:"query",onTrigger1Click:function(){if(this.hasSearch){this.store.baseParams[this.paramName]="";this.store.load();this.el.dom.value="";this.hasSearch=false}},onTrigger2Click:function(){var A=this.getRawValue();if(A.length<1){this.onTrigger1Click();return }this.store.baseParams[this.paramName]=A;this.store.load();this.hasSearch=true},afterRender:function(){GO.form.SearchField.superclass.afterRender.call(this);if(Ext.isIE8){this.el.setTop(1)}},setValue:function(A){GO.form.SearchField.superclass.setValue.call(this,A);if(A!=""){this.hasSearch=true;if(this.rendered){}}}});GO.form.ComboBox=Ext.extend(Ext.form.ComboBox,{setRemoteText:function(E){var D=this.findRecord(this.valueField,this.value);if(!D){var C=Ext.data.Record.create([{name:this.valueField},{name:this.displayField}]);var B={};B[this.valueField]=this.value;B[this.displayField]=E;var A=new C(B);this.store.add(A);this.setValue(this.value)}},initValue:function(){GO.form.ComboBox.superclass.initValue.call(this);this.setRawValue(this.lastSelectionText)},selectFirst:function(){if(this.store.getCount()){var A=this.store.getRange(0,1);this.setValue(A[0].get(this.valueField))}},clearLastSearch:function(){this.lastQuery=false;this.hasSearch=false}});Ext.reg("combo",GO.form.ComboBox);GO.form.ColorField=Ext.extend(function(A){this.menu=new Ext.menu.ColorMenu();this.menu.palette.on("select",this.handleSelect,this);this.menu.on("show",function(){this.menu.palette.select(this.curColor)},this);this.menu.on(Ext.apply({},this.menuListeners,{scope:this}));if(A.colors){this.menu.palette.colors=A.colors}GO.form.ColorField.superclass.constructor.call(this,A)},Ext.form.TriggerField,{showHexValue:false,defaultAutoCreate:{tag:"input",type:"text",size:"1",autocomplete:"off",maxlength:"6"},lengthText:"Color hex values must be either 3 or 6 characters.",blankText:"Must have a hexidecimal value in the format ABCDEF.",maskRe:/[a-f0-9]/i,regex:/[a-f0-9]/i,curColor:"ffffff",validateValue:function(A){if(!this.showHexValue){return true}if(A.length<1){this.el.setStyle({"background-color":"#"+this.defaultColor});if(!this.allowBlank){this.markInvalid(String.format(this.blankText,A));return false}return true}if(A.length!=3&&A.length!=6){this.markInvalid(String.format(this.lengthText,A));return false}this.setColor(A);return true},validateBlur:function(){return !this.menu||!this.menu.isVisible()},markInvalid:function(A){GO.form.ColorField.superclass.markInvalid.call(this,A);this.el.setStyle({"background-image":"url(../lib/resources/images/default/grid/invalid_line.gif)"})},setValue:function(A){GO.form.ColorField.superclass.setValue.call(this,A);this.setColor(A)},initValue:function(){GO.form.ColorField.superclass.initValue.call(this);this.setColor(this.value)},setColor:function(A){if(this.rendered){this.curColor=A;this.el.setStyle({"background-color":"#"+A,"background-image":"none"});if(!this.showHexValue){this.el.setStyle({"text-indent":"-100px"});if(Ext.isIE){this.el.setStyle({"margin-left":"100px"})}}}},menuListeners:{select:function(A,B){this.setValue(B)},show:function(){this.onFocus()},hide:function(){this.focus();var A=this.menuListeners;this.menu.un("select",A.select,this);this.menu.un("show",A.show,this);this.menu.un("hide",A.hide,this)}},handleSelect:function(B,A){this.setValue(A)},onTriggerClick:function(){if(this.disabled){return }this.menu.show(this.el,"tl-bl?")}});Ext.reg("colorfield",GO.form.ColorField);GO.form.ComboBoxReset=Ext.extend(GO.form.ComboBox,{initComponent:Ext.form.TwinTriggerField.prototype.initComponent,getTrigger:Ext.form.TwinTriggerField.prototype.getTrigger,initTrigger:Ext.form.TwinTriggerField.prototype.initTrigger,trigger1Class:"x-form-clear-trigger",onViewClick:Ext.form.ComboBox.prototype.onViewClick.createSequence(function(){}),onTrigger2Click:function(){this.onTriggerClick()},onTrigger1Click:function(){var A=this.getValue();this.clearValue();this.fireEvent("change",this,this.getValue(),A);this.fireEvent("clear",this)},setValue:function(A){GO.form.ComboBoxReset.superclass.setValue.call(this,A);if(this.rendered){}},afterRender:function(){GO.form.ComboBoxReset.superclass.afterRender.call(this);if(Ext.isIE8){this.el.setTop(1)}}});Ext.reg("comboboxreset",GO.form.ComboBoxReset);GO.form.ComboBoxMulti=function(A){if(!A.sep){A.sep=","}A.typeAhead=false;A.minChars=2;A.hideTrigger=true;A.defaultAutoCreate={tag:"textarea",autocomplete:"off"};GO.form.ComboBoxMulti.superclass.constructor.call(this,A);this.on("focus",function(){this.focused=true},this);this.on("blur",function(){this.focused=false},this)};Ext.extend(GO.form.ComboBoxMulti,Ext.form.ComboBox,{focused:false,getCursorPosition:function(){if(document.selection){var A=document.selection.createRange();var B=A.duplicate();B.moveToElementText(this.el.dom);B.setEndPoint("EndToEnd",A);return B.text.length}else{return this.el.dom.selectionEnd}},getActiveRange:function(){var B=this.sep;var D=this.getCursorPosition();var A=this.getRawValue();var C=D;while(C>0&&A.charAt(C)!=B){--C}if(C>0){C++}return{left:C,right:D}},getActiveEntry:function(){var A=this.getActiveRange();return this.getRawValue().substring(A.left,A.right).replace(/^s+|s+$/g,"")},replaceActiveEntry:function(C){var B=this.getActiveRange();var A=this.getRawValue();if(this.preventDuplicates&&A.indexOf(C)>=0){return }var E=(this.sep==" "?"":" ");this.setValue(A.substring(0,B.left)+(B.left>0?E:"")+C+this.sep+E+A.substring(B.right));var D=B.left+C.length+2+E.length;this.selectText.defer(200,this,[D,D])},onSelect:function(A,B){if(this.fireEvent("beforeselect",this,A,B)!==false){var C=Ext.util.Format.htmlDecode(A.data[this.valueField||this.displayField]);if(this.sep){this.replaceActiveEntry(C)}else{this.setValue(C)}this.collapse();this.fireEvent("select",this,A,B)}},initQuery:function(){if(this.focused){this.doQuery(this.sep?this.getActiveEntry():this.getRawValue())}}});GO.form.UploadFile=function(A){if(!A.cls){A.cls=""}if(!A.addText){A.addText=GO.lang.browse}this.inputs=new Ext.util.MixedCollection();GO.form.UploadFile.superclass.constructor.call(this,A);this.addEvents({fileAdded:true})};Ext.extend(GO.form.UploadFile,Ext.BoxComponent,{defaultAutoCreate:{tag:"div"},fileCls:"filetype",max:0,onRender:function(B,A){this.id=Ext.id();this.el=B.createChild({tag:"div",id:this.id,cls:this.cls});this.createButtons();this.createUploadInput()},createUploadInput:function(){if(!this.inputName){this.inputName=Ext.id()}var B=Ext.id();var A=this.inputWrap.createChild({tag:"input",type:"file",cls:"x-uf-input",size:0,id:B,name:this.inputName+"[]"});A.on("change",this.onFileAdded,this);this.inputs.add(A);return A},createButtons:function(){this.buttonsWrap=this.el.createChild({tag:"div",cls:"x-uf-buttons-ct",children:[{tag:"div",cls:"x-uf-input-ct",children:[{tag:"div",cls:"x-uf-bbtn-ct"},{tag:"div",cls:"x-uf-input-wrap"}]}]});this.inputWrap=this.buttonsWrap.select("div.x-uf-input-wrap").item(0);this.addBtnCt=this.buttonsWrap.select("div.x-uf-input-ct").item(0);var A=this.buttonsWrap.select("div.x-uf-bbtn-ct").item(0);this.browseBtn=new Ext.Button({renderTo:A,text:this.addText})},onFileAdded:function(B,A){this.inputs.each(function(C){C.setDisplayed(false)});if(!this.table){this.table=this.el.createChild({tag:"table",cls:"x-uf-table",children:[{tag:"tbody"}]});this.tbody=this.table.select("tbody").item(0);this.table.on({click:{scope:this,fn:this.onDeleteFile,delegate:"a"}})}var A=this.inputs.itemAt(this.inputs.getCount()-1);A.un("change",this.onFileAdded,this);this.appendRow(A);this.createUploadInput();if(this.max>0&&this.max<=this.inputs.getCount()){this.setDisabled(true)}this.fireEvent("filesChanged",this,this.inputs)},appendRow:function(C){var A=C.getValue();var D={id:C.id,fileCls:this.getFileCls(A),fileName:Ext.util.Format.ellipsis(A.split(/[\/\\]/).pop(),this.maxNameLength),fileQtip:A};var B=new Ext.Template(['<tr id="r-{id}">','<td class="x-unselectable">','<span class="filetype-link {fileCls}" unselectable="on" qtip="{fileQtip}">{fileName}</span>',"</td>",'<td id="m-{id}" class="x-uf-filedelete"><a id="d-{id}" href="#"><div class="go-icon btn-delete"></div></a>',"</td>","</tr>"]);C.row=B.append(this.tbody,D,true)},onDeleteFile:function(B,A){this.removeFile(A.id.substr(2))},removeFile:function(B){if(this.uploading){return }var A=this.inputs.get(B);if(A&&A.row){A.row.remove()}if(A){A.remove()}this.inputs.removeKey(B);this.setDisabled(false);this.fireEvent("filesChanged",this,this.inputs)},getFileCls:function(A){var B=A.split(".");if(1===B.length){return this.fileCls}else{return this.fileCls+"-"+B.pop()}},clearQueue:function(){this.inputs.each(function(A){if(!A.isVisible()){this.removeFile(A.id,true)}},this)},setDisabled:function(A){if(A){this.addBtnCt.mask()}else{this.addBtnCt.unmask()}}});GO.form.PlainField=Ext.extend(Ext.form.Field,{defaultAutoCreate:{tag:"div",cls:"x-form-plainfield"},initComponent:function(){GO.form.PlainField.superclass.initComponent.call(this);if(this.boxLabel&&GO.util.empty(this.fieldLabel)){this.fieldLabel=this.boxLabel;this.hideLabel=false}this.addEvents("load")},getName:function(){return this.name},initValue:function(){if(this.value!==undefined){this.setValue(this.value)}else{if(this.el.dom.innerHTML.length>0){this.setValue(this.el.dom.value)}}},setValue:function(A){if(this.boxLabel){if(A=="1"){A=GO.lang.cmdYes}else{A=GO.lang.cmdNo}}this.value=A;if(this.rendered){this.el.update(A)}}});Ext.reg("plainfield",GO.form.PlainField);GO.form.SelectUser=function(A){A=A||{};if(typeof (A.allowBlank)=="undefined"){A.allowBlank=false}Ext.apply(this,A);this.store=new GO.data.JsonStore({url:GO.settings.modules.users.url+"non_admin_json.php",baseParams:{task:"users"},root:"results",totalProperty:"total",id:"id",fields:["id","name","email","username"],remoteSort:true});this.store.setDefaultSort("name","asc");if(!this.hiddenName){this.hiddenName="user_id"}this.setRemoteValue(GO.settings.user_id,GO.settings.name);GO.form.SelectUser.superclass.constructor.call(this,{displayField:"name",value:GO.settings.user_id,valueField:"id",triggerAction:"all",selectOnFocus:true,forceSelection:true,pageSize:parseInt(GO.settings.max_rows_list)})};Ext.extend(GO.form.SelectUser,GO.form.ComboBoxReset,{setRemoteValue:function(A,B){var D=Ext.data.Record.create([{name:"id"},{name:"name"}]);var C=new D({id:A,name:B});this.store.add(C);this.setValue(A)}});Ext.reg("selectuser",GO.form.SelectUser);GO.form.SelectGroup=function(A){Ext.apply(this,A);this.store=new GO.data.JsonStore({url:GO.settings.modules.groups.url+"non_admin_json.php",baseParams:{task:"groups"},root:"results",totalProperty:"total",id:"id",fields:["id","name","email","groupname"],remoteSort:true});this.store.setDefaultSort("name","asc");this.setRemoteValue(GO.settings.group_id,GO.settings.name);GO.form.SelectGroup.superclass.constructor.call(this,{displayField:"name",hiddenName:"group_id",value:GO.settings.group_id,valueField:"id",triggerAction:"all",selectOnFocus:true,forceSelection:true,pageSize:parseInt(GO.settings.max_rows_list)})};Ext.extend(GO.form.SelectGroup,GO.form.ComboBox,{setRemoteValue:function(C,B){var D=Ext.data.Record.create([{name:"id"},{name:"name"}]);var A=new D({id:C,name:B});this.store.add(A);this.setValue(C)}});Ext.reg("selectgroup",GO.form.SelectGroup);GO.form.SelectCountry=function(B){if(!GO.countriesStore){var A=[];for(var C in GO.lang.countries){A.push([C,GO.lang.countries[C]])}GO.countriesStore=new Ext.data.SimpleStore({fields:["iso","name"],data:A});GO.countriesStore.sort("name")}Ext.apply(this,B);GO.form.SelectCountry.superclass.constructor.call(this,{store:GO.countriesStore,valueField:"iso",displayField:"name",triggerAction:"all",editable:true,mode:"local",selectOnFocus:true,forceSelection:true,emptyText:GO.lang.strNoCountrySelected})};Ext.extend(GO.form.SelectCountry,Ext.form.ComboBox);Ext.form.FileUploadField=Ext.extend(Ext.form.TextField,{buttonText:"Browse...",buttonOnly:false,buttonOffset:3,readOnly:false,autoSize:Ext.emptyFn,initComponent:function(){Ext.form.FileUploadField.superclass.initComponent.call(this);this.addEvents("fileselected")},onRender:function(C,A){Ext.form.FileUploadField.superclass.onRender.call(this,C,A);this.wrap=this.el.wrap({cls:"x-form-field-wrap x-form-file-wrap"});this.el.addClass("x-form-file-text");this.el.dom.removeAttribute("name");this.fileInput=this.wrap.createChild({id:this.getFileInputId(),name:this.name||this.getId(),cls:"x-form-file",tag:"input",type:"file",size:1});var B=Ext.applyIf(this.buttonCfg||{},{text:this.buttonText});this.button=new Ext.Button(Ext.apply(B,{renderTo:this.wrap,cls:"x-form-file-btn"+(B.iconCls?" x-btn-icon":"")}));if(this.buttonOnly){this.el.hide();this.wrap.setWidth(this.button.getEl().getWidth())}this.fileInput.on("change",function(){var D=this.fileInput.dom.value;this.setValue(D);this.fireEvent("fileselected",this,D)},this)},getFileInputId:function(){return this.id+"-file"},onResize:function(A,B){Ext.form.FileUploadField.superclass.onResize.call(this,A,B);this.wrap.setWidth(A);if(!this.buttonOnly){var A=this.wrap.getWidth()-this.button.getEl().getWidth()-this.buttonOffset;this.el.setWidth(A)}},preFocus:Ext.emptyFn,getResizeEl:function(){return this.wrap},getPositionEl:function(){return this.wrap},alignErrorIcon:function(){this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])}});Ext.reg("fileuploadfield",Ext.form.FileUploadField);GO.form.HtmlComponent=Ext.extend(Ext.BoxComponent,{onRender:function(B,A){this.el=B.createChild({tag:"div",html:this.html,cls:this.cls,style:this.style})}});Ext.reg("htmlcomponent",GO.form.HtmlComponent);GO.form.NumberField=Ext.extend(Ext.form.TextField,{decimals:2,initComponent:function(){GO.form.NumberField.superclass.initComponent.call(this);this.style="text-align:right";this.on("blur",function(A){var B=GO.util.unlocalizeNumber(A.getValue());A.setValue(GO.util.numberFormat(B,this.decimals))});this.on("focus",function(A){A.focus(true)})}});Ext.reg("numberfield",GO.form.NumberField);GO.grid.PermissionsPanel=Ext.extend(Ext.Panel,{changed:false,loaded:false,initComponent:function(){this.header=false;this.layout="anchor";this.border=false;this.anchor="100% 100%";this.disabled=true;this.aclGroupsStore=new GO.data.JsonStore({url:BaseHref+"json.php",baseParams:{task:"groups_in_acl",acl_id:0},root:"results",totalProperty:"total",id:"id",fields:["id","name"],remoteSort:true});this.aclGroupsStore.setDefaultSort("name","ASC");this.aclGroupsGrid=new GO.grid.GridPanel({anchor:"100% 50%",title:GO.lang.strAuthorizedGroups,store:this.aclGroupsStore,border:false,columns:[{header:GO.lang.strName,dataIndex:"name",menuDisabled:true}],view:new Ext.grid.GridView({autoFill:true,forceFit:true}),loadMask:{msg:GO.lang.waitMsgLoad},sm:new Ext.grid.RowSelectionModel({}),layout:"fit",tbar:[{iconCls:"btn-add",text:GO.lang.cmdAdd,cls:"x-btn-text-icon",handler:function(){this.showAddGroupsDialog()},scope:this},{iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.aclGroupsGrid.deleteSelected()},scope:this}]});this.aclUsersStore=new GO.data.JsonStore({url:BaseHref+"json.php",baseParams:{task:"users_in_acl",acl_id:0},root:"results",totalProperty:"total",id:"id",fields:["id","name"],remoteSort:true});this.aclUsersStore.setDefaultSort("name","ASC");this.aclUsersGrid=new GO.grid.GridPanel({anchor:"100% 50%",title:GO.lang.strAuthorizedUsers,store:this.aclUsersStore,border:false,columns:[{header:GO.lang.strName,dataIndex:"name",menuDisabled:true}],view:new Ext.grid.GridView({autoFill:true,forceFit:true}),loadMask:{msg:GO.lang.waitMsgLoad},sm:new Ext.grid.RowSelectionModel({}),layout:"fit",tbar:[{iconCls:"btn-add",text:GO.lang.cmdAdd,cls:"x-btn-text-icon",handler:function(){this.showAddUsersDialog()},scope:this},{iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.aclUsersGrid.deleteSelected()},scope:this}]});this.items=[this.aclGroupsGrid,this.aclUsersGrid];GO.grid.PermissionsPanel.superclass.initComponent.call(this)},setAcl:function(A){this.acl_id=A?A:0;this.loaded=false;this.aclGroupsStore.baseParams.acl_id=A;this.aclUsersStore.baseParams.acl_id=A;this.setDisabled(A==0);if(this.isVisible()){this.aclGroupsStore.load();this.aclUsersStore.load();this.loaded=true}},onShow:function(){GO.grid.PermissionsPanel.superclass.onShow.call(this);if(!this.loaded){this.aclGroupsStore.load();this.aclUsersStore.load();this.loaded=true}},afterRender:function(){GO.grid.PermissionsPanel.superclass.afterRender.call(this);if(this.isVisible()&&!this.loaded){this.aclGroupsStore.load();this.aclUsersStore.load();this.loaded=true}},showAddGroupsDialog:function(){if(!this.addGroupsDialog){this.addGroupsDialog=new GO.dialog.SelectGroups({handler:function(A){if(A.selModel.selections.keys.length>0){this.aclGroupsStore.baseParams.add_groups=Ext.encode(A.selModel.selections.keys);this.aclGroupsStore.load({callback:function(){if(!this.reader.jsonData.addSuccess){alert(this.reader.jsonData.addFeedback)}}});delete this.aclGroupsStore.baseParams.add_groups}},scope:this})}this.addGroupsDialog.show()},showAddUsersDialog:function(){if(!this.addUsersDialog){this.addUsersDialog=new GO.dialog.SelectUsers({handler:function(A){if(A.selModel.selections.keys.length>0){this.aclUsersStore.baseParams.add_users=Ext.encode(A.selModel.selections.keys);this.aclUsersStore.load({callback:function(){if(!this.reader.jsonData.addSuccess){alert(this.reader.jsonData.addFeedback)}}});delete this.aclUsersStore.baseParams.add_users}},scope:this})}this.addUsersDialog.show()}});GO.ModuleManager=Ext.extend(function(){this.addEvents({moduleReady:true});this.resumeEvents()},Ext.util.Observable,{modules:{},modulePanels:{},panelConfigs:{},sortOrder:Array(),adminModulePanels:{},adminPanelConfigs:{},adminSortOrder:Array(),settingsPanels:{},settingsPanelConfigs:{},settingsSortOrder:Array(),readyFunctions:{},addSettingsPanel:function(B,A,C){this.settingsPanels[B]=A;this.settingsPanelConfigs[B]=C;this.settingsSortOrder.push(B)},getSettingsPanel:function(A){if(this.settingsPanels[A]){return new this.settingsPanels[A](this.settingsPanelConfigs[A])}else{return false}},getAllSettingsPanels:function(){var A=[];for(var B=0;B<this.settingsSortOrder.length;B++){A.push(this.getSettingsPanel(this.settingsSortOrder[B]))}return A},addModule:function(B,A,C){this.modules[B]=true;if(A){C.moduleName=B;C.id="go-module-panel-"+C.moduleName;this.modulePanels[B]=A;this.panelConfigs[B]=C;this.sortOrder.push(B)}this.onAddModule(B)},onAddModule:function(A){if(this.readyFunctions[A]){for(var B=0;B<this.readyFunctions[A].length;B++){var C=this.readyFunctions[A][B];C.fn.call(C.fn.scope,A,this)}}},onModuleReady:function(A,C,B){B=B||window;if(!this.modules[A]){this.readyFunctions[A]=this.readyFunctions[A]||[];this.readyFunctions[A].push({fn:C,scope:B})}else{C.call(B,A,this)}},addAdminModule:function(B,A,C){C.moduleName=B;this.modules[B]=true;this.adminModulePanels[B]=A;this.adminPanelConfigs[B]=C;this.adminSortOrder.push(B);this.onAddModule(B)},getAdminPanel:function(A){if(this.adminModulePanels[A]){return new this.adminModulePanels[A](this.adminPanelConfigs[A])}else{return false}},getAllAdminPanels:function(){var A=[];for(var B=0;B<this.adminSortOrder.length;B++){A.push(this.getAdminPanel(this.adminSortOrder[B]))}return A},getAllAdminPanelConfigs:function(){var B=[];for(var A=0;A<this.adminSortOrder.length;A++){B.push(this.adminPanelConfigs[this.adminSortOrder[A]])}return B},getPanel:function(A){if(this.modulePanels[A]){return new this.modulePanels[A](this.panelConfigs[A])}else{return false}},getAllPanels:function(){var A=[];for(var B=0;B<this.sortOrder.length;B++){A.push(this.getPanel(this.sortOrder[B]))}return A}});GO.moduleManager=new GO.ModuleManager();GO.NewMenuButton=Ext.extend(Ext.Button,{initComponent:function(){this.menu=new Ext.menu.Menu({items:GO.newMenuItems});this.text=GO.lang.cmdNew;this.iconCls="btn-add";this.disabled=true;this.hidden=GO.newMenuItems.length==0;GO.NewMenuButton.superclass.initComponent.call(this)},setLinkConfig:function(A){this.menu.link_config=A;this.menu.link_config.type_id=A.type+":"+A.id;if(!this.menu.link_config.scope){this.menu.link_config.scope=this}if(this.menu.link_config.callback){this.menu.link_config.callback=this.menu.link_config.callback.createDelegate(this.menu.link_config.scope)}this.setDisabled(false)}});GO.LinkFolderWindow=function(A){if(!A){A={}}var B=function(){this.newFolderNameField.focus(true)};this.newFolderNameField=new Ext.form.TextField({fieldLabel:GO.lang.strName,name:"name",value:"New folder",allowBlank:false,anchor:"100%"});this.formPanel=new Ext.form.FormPanel({defaultType:"textfield",labelWidth:75,cls:"go-form-panel",waitMsgTarget:true,items:this.newFolderNameField,autoHeight:true,baseParams:{task:"link_folder",folder_id:0}});A.layout="fit";A.modal=false;A.resizable=false;A.width=400;A.autHeight=true;A.closeAction="hide";A.title="New folder";A.items=this.formPanel;A.focus=B.createDelegate(this);A.buttons=[{text:GO.lang.cmdOk,handler:function(){this.submitForm(true)},scope:this},{text:GO.lang.cmdApply,handler:function(){this.submitForm()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];GO.LinkFolderWindow.superclass.constructor.call(this,A);this.addEvents({save:true})};Ext.extend(GO.LinkFolderWindow,Ext.Window,{show:function(A){if(!this.rendered){this.render(Ext.getBody())}if(!A.folder_id){A.folder_id=0}this.link_id=A.link_id?A.link_id:0;this.link_type=A.link_type?A.link_type:0;this.parent_id=A.parent_id?A.parent_id:0;this.setLinkFolderId(A.folder_id);if(this.folder_id>0){this.formPanel.load({url:BaseHref+"json.php",success:function(B,C){this.setLinkFolderId(C.result.data.id);this.link_id=C.result.data.link_id;this.link_type=C.result.data.link_type;this.parent_id=C.result.data.parent_id;GO.LinkFolderWindow.superclass.show.call(this)},failure:function(B,C){Ext.Msg.alert(GO.lang.strError,C.result.feedback)},scope:this})}else{this.formPanel.form.reset();GO.LinkFolderWindow.superclass.show.call(this)}},setLinkFolderId:function(A){if(!A){A=0}this.formPanel.form.baseParams.folder_id=A;this.folder_id=A},submitForm:function(A){this.formPanel.form.submit({url:BaseHref+"action.php",params:{task:"save_link_folder",link_id:this.link_id,link_type:this.link_type,parent_id:this.parent_id},waitMsg:GO.lang.waitMsgSave,success:function(B,C){this.fireEvent("save",this);if(A){this.hide()}else{if(C.result.folder_id){this.setLinkFolderId(C.result.folder_id)}}},failure:function(B,C){if(C.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,C.result.feedback)}},scope:this})}});GO.form.SelectLink=function(A){A=A||{};A.store=new GO.data.JsonStore({url:BaseHref+"json.php",baseParams:{query:"",task:"links"},root:"results",totalProperty:"total",fields:["link_id","link_type","link_and_type","type_name"],remoteSort:true});A.displayField="type_name";A.valueField="link_and_type",A.hiddenName="link";A.triggerAction="all";A.width=400;A.selectOnFocus=false;A.fieldLabel=GO.lang.cmdLink;A.pageSize=parseInt(GO.settings.max_rows_list);GO.form.SelectLink.superclass.constructor.call(this,A)};Ext.extend(GO.form.SelectLink,GO.form.ComboBox);GO.LinksTree=function(A){if(!A){A={}}A.title=GO.lang.folders;A.layout="fit";A.split=true;A.autoScroll=true;A.width=200;A.animate=true;A.loader=new Ext.tree.TreeLoader({dataUrl:BaseHref+"json.php",baseParams:{task:"link_folders_tree",link_type:0,link_id:0},preloadChildren:true});A.collapsed=A.treeCollapsed;A.containerScroll=true;A.rootVisible=true;A.collapsible=true;A.ddAppendOnly=true;A.containerScroll=true;A.ddGroup="LinksDD";A.enableDD=true;GO.LinksTree.superclass.constructor.call(this,A);this.rootNode=new Ext.tree.AsyncTreeNode({text:"Root",draggable:false,iconCls:"folder-default",expanded:false});this.setRootNode(this.rootNode)};Ext.extend(GO.LinksTree,Ext.tree.TreePanel,{loadLinks:function(A,B){this.loader.baseParams.link_id=A;this.loader.baseParams.link_type=B;if(this.rootNode.isExpanded()){this.rootNode.reload()}else{this.rootNode.expand()}}});GO.grid.LinksGrid=function(A){var B;if(!A){A={}}if(!A.link_id){A.link_id=0}if(!A.link_type){A.link_type=0}if(!A.folder_id){A.folder_id=0}A.hideMode="offsets";A.store=new GO.data.JsonStore({url:BaseHref+"json.php",baseParams:{task:"links",link_id:this.link_id,link_type:this.link_type,folder_id:this.folder_id},root:"results",totalProperty:"total",id:"link_and_type",fields:["icon","link_and_type","link_type","name","type","url","mtime","id","module","description","iconCls","link_description"],remoteSort:true});A.store.setDefaultSort("mtime","desc");if(!A.noSearchField){this.searchField=new GO.form.SearchField({store:A.store,width:320});A.tbar=[GO.lang.strSearch+": "," ",this.searchField]}A.clicksToEdit=1;A.enableDragDrop=true;A.ddGroup="LinksDD";A.columns=[{header:"",hideable:false,width:28,dataIndex:"icon",renderer:this.iconRenderer},{header:GO.lang.strName,dataIndex:"name",css:"white-space:normal;",sortable:true},{header:GO.lang.strDescription,dataIndex:"link_description",sortable:true,editor:new GO.form.LinkDescriptionField()},{header:GO.lang.strType,dataIndex:"type",sortable:true,hidden:true},{header:GO.lang.strMtime,dataIndex:"mtime",sortable:true,width:80}];A.bbar=new Ext.PagingToolbar({cls:"go-paging-tb",store:A.store,pageSize:parseInt(GO.settings.max_rows_list),displayInfo:true,displayMsg:GO.lang.displayingItems,emptyMsg:GO.lang.strNoItems});A.layout="fit";A.view=new Ext.grid.GridView({enableRowBody:true,showPreview:true,autoFill:true,forceFit:true,emptyText:GO.lang.strNoItems,getRowClass:function(C,F,E,D){if(this.showPreview&&C.data.description.length){E.body='<div class="go-links-panel-description">'+C.data.description+"</div>";return"x-grid3-row-expanded"}return"x-grid3-row-collapsed"}});A.loadMask={msg:GO.lang.waitMsgLoad};A.sm=new Ext.grid.RowSelectionModel({});GO.grid.LinksGrid.superclass.constructor.call(this,A);this.addEvents({folderOpened:true,folderDrop:true})};Ext.extend(GO.grid.LinksGrid,Ext.grid.EditorGridPanel,{write_permission:false,afterRender:function(){GO.grid.LinksGrid.superclass.afterRender.call(this);var A=new Ext.dd.DropTarget(this.getView().mainBody,{ddGroup:"LinksDD",copy:false,notifyOver:this.onGridNotifyOver,notifyDrop:this.onGridNotifyDrop.createDelegate(this)});this.on("afteredit",function(B){Ext.Ajax.request({url:GO.settings.config.host+"action.php",params:{task:"updatelink",link_id1:this.store.baseParams.link_id,link_type1:this.store.baseParams.link_type,link_id2:B.record.get("id"),link_type2:B.record.get("link_type"),description:B.record.get("link_description")},success:function(C,D){var E=Ext.decode(C.responseText);if(!E.success){alert(E.feedback)}else{this.store.commitChanges()}},scope:this})},this)},deleteSelected:function(B){if(!B){B=this.deleteConfig}if(!B.deleteParam){B.deleteParam="delete_keys"}var C=this.selModel.selections.keys;var D={};D[B.deleteParam]=Ext.encode(this.selModel.selections.keys);var A={store:this.store,params:D,count:this.selModel.selections.keys.length};if(B.callback){A.callback=B.callback}if(B.success){A.success=B.success}if(B.failure){A.failure=B.failure}if(B.scope){A.scope=B.scope}GO.deleteItems(A)},onGridNotifyOver:function(A,E,C){var D=A.getDragData(E);if(C.grid&&this.write_permission){var B=C.grid.store.data.items[D.rowIndex];if(B){if(B.data.link_type=="folder"){return this.dropAllowed}}}return false},onGridNotifyDrop:function(A,F,D){if(D.grid&&this.write_permission){var G=D.grid.getSelectionModel();var C=G.getSelections();var E=A.getDragData(F);var B=D.grid.store.data.items[E.rowIndex];if(B.data.link_type=="folder"){this.fireEvent("folderDrop",this,D.selections,B)}}else{return false}},iconRenderer:function(C,A,B){return'<div class="go-icon '+B.data.iconCls+' "></div>'}});GO.dialog.LinksDialog=function(A){Ext.apply(this,A);this.grid=new GO.grid.SearchPanel({noTitle:true,noOpenLinks:true});this.grid.searchGrid.on("rowdblclick",this.linkItems,this);var B=function(){this.grid.searchField.focus(true)};GO.dialog.LinksDialog.superclass.constructor.call(this,{layout:"fit",focus:B.createDelegate(this),modal:false,minWidth:300,minHeight:300,height:500,width:700,border:false,plain:true,closeAction:"hide",title:GO.lang.strLinkItems,items:this.grid,buttons:[{text:GO.lang.cmdOk,handler:function(){this.linkItems()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}]});this.addEvents({link:true})};Ext.extend(GO.dialog.LinksDialog,Ext.Window,{folder_id:0,setLinkRecords:function(B){this.fromLinks=[];for(var A=0;A<B.length;A++){this.fromLinks.push({link_id:B[A].data.link_id,link_type:B[A].data.link_type})}},setSingleLink:function(A,B){this.fromLinks=[{link_id:A,link_type:B}]},linkItems:function(){var A=this.grid.searchGrid.getSelectionModel();var C=A.getSelections();var B=[];for(var D=0;D<C.length;D++){B.push({link_id:C[D].data.id,link_type:C[D].data.link_type})}Ext.Ajax.request({url:BaseHref+"action.php",params:{task:"link",fromLinks:Ext.encode(this.fromLinks),toLinks:Ext.encode(B),description:this.grid.linkDescriptionField.getValue(),folder_id:this.folder_id},callback:function(F,G,E){if(!G){Ext.MessageBox.alert(GO.lang.strError,E.result.errors)}else{this.fireEvent("link");this.hide()}},scope:this})}});GO.grid.LinksPanel=function(A){if(!A){A={}}if(!this.link_id){this.link_id=0}if(!this.link_type){this.link_type=0}if(!this.folder_id){this.folder_id=0}this.linksDialog=new GO.dialog.LinksDialog({linksStore:A.store});this.linksDialog.on("link",function(){this.linksGrid.store.reload()},this);this.linksTree=new GO.LinksTree({region:"west",split:true,title:GO.lang.folders});this.linksTree.on("click",function(B){this.setFolder(B.id.substr(10))},this);this.linksTree.on("contextmenu",function(C,E){E.stopEvent();var B=C.id.substr(10);if(B!=""){var D=E.getXY();this.linksContextMenu.showAt([D[0],D[1]],["folder:"+B],"folder")}},this);this.linksTree.on("beforenodedrop",function(G){if(!this.write_permission){return false}var F={folder_id:G.target.id.substr(10),link_id:this.link_id,link_type:this.link_type};var C=[];if(G.data.selections){for(var B=0;B<G.data.selections.length;B++){if(G.data.selections[B].data.link_and_type.substr(0,6)=="folder"){var H=G.data.selections[B].data.link_and_type.substr(7);var D=this.linksTree.getNodeById("lt-folder-"+H);var E=this.linksTree.getNodeById("lt-folder-"+F.folder_id);E.appendChild(D)}C.push(G.data.selections[B].data.link_and_type)}}else{var C=["folder:"+G.data.node.id.substr(10)]}this.moveSelections(C,F)},this);this.linksGrid=new GO.grid.LinksGrid({region:"center",deleteConfig:{scope:this,success:function(){var B=this.linksTree.getNodeById("lt-folder-"+this.folder_id);if(B){B.reload()}else{this.linksTree.getRootNode().reload()}}}});this.linksGrid.on("folderDrop",function(D,E,B){var G={folder_id:B.data.id,link_id:this.link_id,link_type:this.link_type};var F=[];for(var C=0;C<E.length;C++){F.push(E[C].data.link_and_type)}this.moveSelections(F,G)},this);this.linksGrid.on("rowcontextmenu",function(B,G,F){var D="";var C=selModel.getSelections();if(C.length=="1"){D=C[0].data.link_type}var E=F.getXY();this.linksContextMenu.showAt([E[0],E[1]],selModel.selections.keys,D)},this);this.linksGrid.store.on("load",function(){this.setWritePermission(this.linksGrid.store.reader.jsonData.write_permission)},this);this.folderWindow=new GO.LinkFolderWindow();this.folderWindow.on("save",function(){this.linksGrid.store.reload();var B=this.linksTree.getNodeById("lt-folder-"+this.folder_id);if(B){delete B.attributes.children;B.reload()}else{this.linksTree.rootNode.reload()}},this);A.items=[this.linksTree,this.linksGrid];this.linksContextMenu=new GO.LinksContextMenu();this.linksContextMenu.on("properties",function(E,C){var D=C[0].indexOf(":");var B=C[0].substr(D+1);this.folderWindow.show({folder_id:B})},this);this.linksContextMenu.on("delete",function(C,B){},this);this.linksContextMenu.on("unlink",function(C,B){this.linksGrid.store.baseParams.unlinks=Ext.encode(B);this.linksGrid.store.reload();delete this.linksGrid.store.baseParams.unlinks},this);A.layout="border";A.border=false;A.hideMode="offsets";A.tbar=[this.linkButton=new Ext.Button({iconCls:"btn-link",text:GO.lang.cmdLink,cls:"x-btn-text-icon",handler:function(){this.linksDialog.show()},scope:this}),this.unlinkButton=new Ext.Button({iconCls:"btn-unlink",text:GO.lang.cmdUnlink,cls:"x-btn-text-icon",handler:function(){var D=[];var B=this.linksGrid.getSelectionModel();var C=B.getSelections();if(C.length>0){this.linksGrid.store.baseParams.unlinks=Ext.encode(B.selections.keys);this.linksGrid.store.reload();delete this.linksGrid.store.baseParams.unlinks}},scope:this}),this.newFolderButton=new Ext.Button({id:"unlink",iconCls:"btn-add",text:GO.lang.newFolder,cls:"x-btn-text-icon",handler:function(){this.folderWindow.show({link_id:this.link_id,link_type:this.link_type,parent_id:this.folder_id})},scope:this}),this.deleteButton=new Ext.Button({iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.linksGrid.deleteSelected()},scope:this})];if(GO.links&&GO.links.LinkDescriptionsGrid){A.tbar.push("-");A.tbar.push({text:GO.links.lang.linkDescriptions,scope:this,iconCls:"btn-settings",handler:function(){if(!this.settingsWindow){this.settingsWindow=new GO.Window({height:400,width:300,layout:"fit",title:GO.links.lang.linkDescriptions,closeAction:"hide",items:new GO.links.LinkDescriptionsGrid(),buttons:[{text:GO.lang.cmdClose,handler:function(){this.settingsWindow.hide()},scope:this}]})}this.settingsWindow.show()}})}this.linksGrid.on("rowdblclick",this.rowDoulbleClicked,this);GO.grid.LinksPanel.superclass.constructor.call(this,A)};Ext.extend(GO.grid.LinksPanel,Ext.Panel,{afterRender:function(){GO.grid.LinksPanel.superclass.afterRender.call(this);this.on("rowdblclick",this.rowDoulbleClicked,this);if(this.isVisible()){this.onShow()}},moveSelections:function(A,B){Ext.Ajax.request({url:BaseHref+"action.php",params:{task:"move_links",selections:Ext.encode(A),target:Ext.encode(B)},callback:function(E,H,D){if(!H){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strRequestError)}else{var G=Ext.decode(D.responseText);if(G.moved_links){for(var F=0;F<G.moved_links.length;F++){var C=this.linksGrid.store.getById(G.moved_links[F]);if(C){this.linksGrid.store.remove(C)}}}}},scope:this})},rowDoulbleClicked:function(C,D,E){var A=C.getSelectionModel();var B=A.getSelected();if(B.data.link_type=="folder"){this.setFolder(B.data.id)}else{if(GO.linkHandlers[B.data.link_type]){GO.linkHandlers[B.data.link_type].call(this,B.data.id)}else{Ext.Msg.alert(GO.lang.strError,"No handler definded for link type: "+B.data.link_type)}}},onShow:function(){GO.grid.LinksPanel.superclass.onShow.call(this);if(!this.loaded&&this.link_id>0){this.linksGrid.store.load();var A=this.linksTree.getRootNode();if(A.isExpanded()){A.reload()}else{A.expand()}this.loaded=true}},setWritePermission:function(A){this.linkButton.setDisabled(!A);this.unlinkButton.setDisabled(!A);this.newFolderButton.setDisabled(!A);this.deleteButton.setDisabled(!A);this.write_permission=A;this.linksGrid.write_permission=A},setFolder:function(A){var B=this.linksTree.getNodeById("lt-folder-"+A);if(B){B.expand()}this.linksDialog.folder_id=A;this.folder_id=A;this.linksGrid.store.baseParams.folder_id=A;this.linksGrid.store.load()},loadLinks:function(B,C,A){if(B>0){this.setDisabled(false)}else{this.setDisabled(true)}if(this.link_id!=B||this.link_type!=C){this.link_id=this.linksGrid.store.baseParams.link_id=B;this.link_type=this.linksGrid.store.baseParams.link_type=C;this.linksGrid.store.baseParams.folder_id=A;this.linksTree.loadLinks(B,C);this.linksDialog.setSingleLink(this.link_id,this.link_type);this.loaded=false}}});GO.linksTemplate='<tpl if="links.length"><table class="display-panel" cellpadding="0" cellspacing="0" border="0"><tr><td colspan="4" class="display-panel-heading">'+GO.lang.latestLinks+'</td></tr><tr><td style="width:16px" class="display-panel-links-header">&nbsp;</td><td style="width: 100%" class="table_header_links">'+GO.lang.strName+'</td><td class="table_header_links" style="white-space:nowrap">'+GO.lang.strMtime+'</td></tr><tpl for="links"><tr><td><div class="go-icon {iconCls}" ext:qtip="{type}"></div></td><td><a href="#link_{[xindex-1]}">{name}</a><tpl if="link_description.length"><br />{link_description}</tpl></td><td style="white-space:nowrap">{mtime}</td></tr><tpl if="description.length"><tr class="display-panel-link-description"><td>&nbsp;</td><td colspan="3">{description}</td></tr></tpl></tpl></tpl>';GO.linksTemplateConfig={};GO.LinksContextMenu=function(A){if(!A){A={}}A.shadow="frame";A.minWidth=180;this.deleteButton=new Ext.menu.Item({iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.fireEvent("delete",this,this.selected)},scope:this});this.unlinkButton=new Ext.menu.Item({iconCls:"btn-unlink",text:GO.lang.cmdUnlink,cls:"x-btn-text-icon",handler:function(){this.fireEvent("unlink",this,this.selected)},scope:this});this.propertiesButton=new Ext.menu.Item({iconCls:"btn-properties",text:GO.lang.strProperties,handler:function(){this.fireEvent("properties",this,this.selected)},scope:this});A.items=[this.propertiesButton,this.deleteButton,this.unlinkButton];GO.LinksContextMenu.superclass.constructor.call(this,A);this.addEvents({properties:true,unlink:true,"delete":true})};Ext.extend(GO.LinksContextMenu,Ext.menu.Menu,{clickedAt:"grid",showAt:function(D,A){this.link_type=C;this.selected=A;if(this.selected.length>1){C="mixed"}else{var B=A[0].indexOf(":");var C=A[0].substr(0,B)}switch(C){case"folder":this.propertiesButton.show();this.unlinkButton.hide();break;default:this.propertiesButton.hide();this.unlinkButton.show();break}GO.LinksContextMenu.superclass.showAt.call(this,D)}});GO.LinkBrowser=function(A){Ext.apply(this,A);this.linksPanel=new GO.grid.LinksPanel();GO.LinkBrowser.superclass.constructor.call(this,{layout:"fit",modal:false,minWidth:300,minHeight:300,height:500,width:750,border:false,plain:true,maximizable:true,collapsible:true,closeAction:"hide",title:GO.lang.cmdBrowseLinks,items:this.linksPanel,buttons:[{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}]});this.addEvents({link:true})};Ext.extend(GO.LinkBrowser,Ext.Window,{show:function(A){this.linksPanel.loadLinks(A.link_id,A.link_type);if(A.folder_id){this.linksPanel.setFolder(A.folder_id)}GO.LinkBrowser.superclass.show.call(this)}});GO.mainLayout.onReady(function(){GO.linkBrowser=new GO.LinkBrowser()});GO.LinkViewWindow=function(A){if(!A){A={}}A.collapsible=true;A.maximizable=true;A.layout="fit";A.modal=false;A.resizable=true;if(!A.width){A.width=500}if(!A.height){A.height=500}A.buttons=[{text:GO.lang.cmdClose,handler:function(){this.close()},scope:this}];GO.LinkViewWindow.superclass.constructor.call(this,A);this.render(Ext.getBody())};Ext.extend(GO.LinkViewWindow,Ext.Window);GO.linkTypeStore=new GO.data.JsonStore({url:BaseHref+"json.php",baseParams:{task:"link_types"},root:"results",totalProperty:"total",id:"id",fields:["id","name","checked"],remoteSort:true});GO.LinkTypeFilterPanel=function(B){if(!B){B={}}B.autoScroll=true;var C=new GO.grid.CheckColumn({header:"&nbsp;",dataIndex:"checked",width:30});B.title=GO.lang.strType;this.filterGrid=new GO.grid.GridPanel({cls:"go-grid3-hide-headers",autoHeight:true,border:false,loadMask:true,store:GO.linkTypeStore,columns:[C,{header:GO.lang.strName,dataIndex:"name"}],plugins:[C],autoExpandColumn:1});var A=new Ext.Button({text:GO.lang.cmdApply,handler:function(){var E=[];for(var D=0;D<this.filterGrid.store.data.items.length;D++){var F=this.filterGrid.store.data.items[D].get("checked");if(F=="1"){E.push(this.filterGrid.store.data.items[D].get("id"))}}this.fireEvent("change",this,E);this.filterGrid.store.commitChanges()},scope:this});B.items=[this.filterGrid,new Ext.Panel({border:false,cls:"go-form-panel",items:[new GO.form.HtmlComponent({html:"<br />"}),A]})];GO.LinkTypeFilterPanel.superclass.constructor.call(this,B);this.addEvents({change:true})};Ext.extend(GO.LinkTypeFilterPanel,Ext.Panel);GO.form.LinkDescriptionField=Ext.extend(function(A){A=A||{};A.store=new GO.data.JsonStore({url:GO.settings.config.host+"json.php",baseParams:{task:"link_descriptions"},root:"results",id:"id",totalProperty:"total",fields:["id","description"],remoteSort:true});A.displayField="description";A.triggerAction="all";A.selectOnFocus=false;A.pageSize=parseInt(GO.settings.max_rows_list);GO.form.LinkDescriptionField.superclass.constructor.call(this,A)},GO.form.ComboBoxReset,{hiddenName:"description",maxLength:100});GO.LinksAccordion=Ext.extend(Ext.Panel,{link_id:0,link_type:0,title:GO.lang.strLinks,disabled:true,initComponent:function(){this.layout="accordion";this.items=[];if(GO.calendar){var A=new GO.grid.LinksGrid({title:GO.calendar.lang.appointments,noSearchField:true});A.store.baseParams.types=Ext.encode([1]);this.items.push(A)}if(GO.tasks){var B=new GO.grid.LinksGrid({title:GO.tasks.lang.tasks,noSearchField:true});B.store.baseParams.types=Ext.encode([12]);this.items.push(B)}if(GO.notes){var D=new GO.grid.LinksGrid({title:GO.notes.lang.notes,noSearchField:true});D.store.baseParams.types=Ext.encode([4]);this.items.push(D)}var E;for(var C=0;C<this.items.length;C++){E=this.items[C];E.store.baseParams.no_filter_save=true;E.on("expand",function(){if(!E.store.loaded){E.store.load()}},this)}this.on("show",this.loadActivePanel,this);GO.LinksAccordion.superclass.initComponent.call(this)},setLinkID:function(A,B){this.setDisabled(GO.util.empty(A));this.link_id=A;this.items.each(function(C){C.store.loaded=false;C.store.baseParams.link_id=A;C.store.baseParams.link_type=B;C.store.baseParams.type_filter=true});if(this.isVisible()){this.loadActivePanel()}},loadActivePanel:function(){var A=this.layout.activeItem;if(!A.store.loaded){A.store.load()}}});GO.grid.SearchPanel=function(A){A=A||{};if(!this.query){this.query=""}A.border=false;if(!A.noTitle){A.title=GO.lang.strSearch+': "'+Ext.util.Format.htmlEncode(this.query)+'"'}A.closable=true;A.iconCls="go-search-icon-tab";A.layout="border";this.filterPanel=new GO.LinkTypeFilterPanel({region:"west",collapsible:true,split:true,border:true,width:120});this.filterPanel.on("change",function(D,C){this.searchGrid.store.baseParams.types=Ext.encode(C);this.searchGrid.store.load();delete this.searchGrid.store.baseParams.types},this);this.store=new GO.data.JsonStore({url:BaseHref+"json.php",baseParams:{task:"links",link_id:this.link_id,link_type:this.link_type,folder_id:this.folder_id,type_filter:"true"},root:"results",totalProperty:"total",id:"link_and_type",fields:["icon","link_and_type","link_type","name","type","url","mtime","id","module","description","iconCls"],remoteSort:true});this.searchField=new GO.form.SearchField({store:this.store,width:320});var B={border:true,region:"center",tbar:[GO.lang.strSearch+": "," ",this.searchField,"-",{iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.searchGrid.deleteSelected()},scope:this}],store:this.store,columns:[{header:"",width:28,dataIndex:"icon",renderer:this.iconRenderer},{header:GO.lang.strName,dataIndex:"name",css:"white-space:normal;",sortable:true},{header:GO.lang.strType,dataIndex:"type",sortable:true,width:100},{header:GO.lang.strMtime,dataIndex:"mtime",sortable:true,width:100}],autoExpandMax:2500,autoExpandColumn:1,paging:true,layout:"fit",view:new Ext.grid.GridView({enableRowBody:true,showPreview:true,emptyText:GO.lang.strNoItems,getRowClass:function(C,F,E,D){if(this.showPreview&&C.data.description.length){E.body='<div class="go-links-panel-description">'+C.data.description+"</div>";return"x-grid3-row-expanded"}return"x-grid3-row-collapsed"}}),loadMask:{msg:GO.lang.waitMsgLoad},sm:new Ext.grid.RowSelectionModel({})};if(A.noOpenLinks){B.bbar=[GO.lang.strDescription+": "," ",this.linkDescriptionField=new GO.form.LinkDescriptionField({name:"description",width:320})]}this.searchGrid=new GO.grid.GridPanel(B);this.searchGrid.store.setDefaultSort("mtime","desc");if(!A.noTitle){this.searchGrid.store.on("load",function(){this.setTitle(GO.lang.strSearch+': "'+Ext.util.Format.htmlEncode(this.searchGrid.store.baseParams.query)+'"')},this)}if(!A.noOpenLinks){this.searchGrid.on("rowdblclick",function(E,F,G){var C=E.getSelectionModel();var D=C.getSelected();if(GO.linkHandlers[D.data.link_type]){GO.linkHandlers[D.data.link_type].call(this,D.data.id,D)}else{Ext.Msg.alert(GO.lang.strError,"No handler definded for link type: "+D.data.link_type)}},this)}A.items=[this.filterPanel,this.searchGrid];GO.grid.SearchPanel.superclass.constructor.call(this,A)};Ext.extend(GO.grid.SearchPanel,Ext.Panel,{afterRender:function(){GO.grid.SearchPanel.superclass.afterRender.call(this);this.load()},load:function(){if(!GO.linkTypeStore.loaded){GO.linkTypeStore.load({scope:this,callback:function(){this.load()}})}else{this.searchField.setValue(this.query);this.searchGrid.store.baseParams.query=this.query;this.searchGrid.store.load()}},iconRenderer:function(C,A,B){return'<div class="go-icon '+B.data.iconCls+' "></div>'}});Ext.ux.ManagedIFrame=function(){var C=Array.prototype.slice.call(arguments,0),D=Ext.get(C[0]),B=C[0];if(D&&D.dom&&D.dom.tagName=="IFRAME"){B=C[1]||{}}else{B=C[0]||C[1]||{};D=B.autoCreate?Ext.get(Ext.DomHelper.append(B.autoCreate.parent||document.body,Ext.apply({tag:"iframe",src:(Ext.isIE&&Ext.isSecure)?Ext.SSL_SECURE_URL:""},B.autoCreate))):null}if(!D||D.dom.tagName!="IFRAME"){return D}!!D.dom.name.length||(D.dom.name=D.dom.id);this.addEvents({domready:true,documentloaded:true,exception:true,message:true});if(B.listeners){this.listeners=B.listeners;Ext.ux.ManagedIFrame.superclass.constructor.call(this)}Ext.apply(D,this);D.addClass("x-managed-iframe");if(B.style){D.applyStyles(B.style)}D._maskEl=D.parent(".x-managed-iframe-mask")||D.parent().addClass("x-managed-iframe-mask");Ext.apply(D,{disableMessaging:B.disableMessaging===true,loadMask:Ext.apply({msg:"Loading..",msgCls:"x-mask-loading",maskEl:D._maskEl,hideOnReady:true,disabled:!B.loadMask},B.loadMask),_eventName:Ext.isIE?"onreadystatechange":"onload",_windowContext:null,eventsFollowFrameLinks:typeof B.eventsFollowFrameLinks=="undefined"?true:B.eventsFollowFrameLinks});D.dom[D._eventName]=D.loadHandler.createDelegate(D);if(document.addEventListener){Ext.EventManager.on(window,"DOMFrameContentLoaded",D.dom[D._eventName])}var A=D.updateManager=new Ext.UpdateManager(D,true);A.showLoadIndicator=B.showLoadIndicator||false;if(B.src){D.setSrc(B.src)}else{var E=B.html||B.content||false;if(E){D.update.defer(10,D,[E])}}return Ext.ux.ManagedIFrame.Manager.register(D)};Ext.extend(Ext.ux.ManagedIFrame,Ext.util.Observable,{src:null,setSrc:function(A,C,E){var B=Ext.isIE&&Ext.isSecure?Ext.SSL_SECURE_URL:"";var D=A||this.src||B;if(Ext.isOpera){this.dom.src=B}this._windowContext=null;this._hooked=this._domReady=this._domFired=false;this._callBack=E||false;this.showMask();(function(){var G=typeof D=="function"?D()||"":D;try{this._frameAction=true;this.dom.src=G;this.frameInit=true;this.checkDOM()}catch(F){this.fireEvent("exception",this,F)}}).defer(10,this);if(C!==true){this.src=D}return this},reset:function(A,B){this.setSrc(A||(Ext.isIE&&Ext.isSecure?Ext.SSL_SECURE_URL:""),true,B)},scriptRE:/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,update:function(B,A,D){A=A||this.getUpdateManager().loadScripts||false;B=Ext.DomHelper.markup(B||"");B=A===true?B:B.replace(this.scriptRE,"");var C;if(C=this.getDocument()){this._frameAction=!!B.length;this._windowContext=this.src=null;this._callBack=D||false;this._hooked=this._domReady=this._domFired=false;this.showMask();C.open();C.write(B);C.close();this.frameInit=true;if(this._frameAction){this.checkDOM()}else{this.hideMask(true);if(this._callBack){this._callBack()}}}else{this.hideMask(true);if(this._callBack){this._callBack()}}return this},disableMessaging:true,_XFrameMessaging:function(){var A={"$":[]};var B=function(D,C){return D===null||D===undefined||(!C?D==="":false)};window.sendMessage=function(K,L,J){var F;if(F=arguments.callee.manager){if(K._fromHost){var I,M;var C=K.tag||L||null;var D=!B(C)?A[C.toLowerCase()]||[]:A["$"];for(var G=0,E=D.length;G<E;G++){if(I=D[G]){M=I.apply(I.__scope,arguments)===false?false:M;if(I.__single){D[G]=null}if(M===false){break}}}return M}else{K={type:B(L)?"message":"message:"+L.toLowerCase().replace(/^\s+|\s+$/g,""),data:K,domain:J||document.domain,uri:document.documentURI,source:window,tag:B(L)?null:L.toLowerCase()};try{return F.disableMessaging!==true?F.fireEvent.call(F,K.type,F,K):null}catch(H){}return null}}};window.onhostmessage=function(F,E,G,C){if(typeof F=="function"){if(!B(F.__index)){throw"onhostmessage: duplicate handler definition"+(C?" for tag:"+C:"")}var D=B(C)?"$":C.toLowerCase();A[D]||(A[D]=[]);Ext.apply(F,{__tag:D,__single:G||false,__scope:E||window,__index:A[D].length});A[D].push(F)}else{throw"onhostmessage: function required"}};window.unhostmessage=function(D){if(typeof D=="function"&&typeof D.__index!="undefined"){var C=D.__tag||"$";A[C][D.__index]=null}}},_renderHook:function(){this._windowContext=null;this._hooked=false;try{if(this.writeScript('(function(){(window.hostMIF = parent.Ext.get("'+this.dom.id+'"))._windowContext='+(Ext.isIE?"window":"{eval:function(s){return eval(s);}}")+";})();")){if(this.disableMessaging!==true){this.loadFunction({name:"XMessage",fn:this._XFrameMessaging},false,true);var B;if(B=this.getWindow().sendMessage){B.manager=this}}}return this.domWritable()}catch(A){}return false},sendMessage:function(C,A,B){var D;if(this.disableMessaging!==true&&(D=this.getWindow())){A||(A=C.tag||"");A=A.toLowerCase();C=Ext.applyIf(C.data?C:{data:C},{type:Ext.isEmpty(A)?"message":"message:"+A,domain:B||document.domain,uri:document.documentURI,source:window,tag:A||null,_fromHost:this});return D.sendMessage?D.sendMessage.call(null,C,A,B):null}return null},_windowContext:null,getDocument:function(){return this.getWindow()?this.getWindow().document:null},getDocumentURI:function(){var A;try{A=this.src?this.getDocument().location.href:null}catch(B){}return A||this.src},getWindow:function(){var A=this.dom;return A?A.contentWindow||window.frames[A.name]:null},print:function(){try{var B=this.getWindow();if(Ext.isIE){B.focus()}B.print()}catch(A){throw"print exception: "+(A.description||A.message||A)}},destroy:function(){this.removeAllListeners();if(this.dom){if(document.addEventListener){Ext.EventManager.un(window,"DOMFrameContentLoaded",this.dom[this._eventName])}this.dom[this._eventName]=null;this._windowContext=null;if(Ext.isIE&&this.dom.src){this.dom.src="javascript:false"}this._maskEl=null;Ext.removeNode(this.dom)}Ext.apply(this.loadMask,{masker:null,maskEl:null});Ext.ux.ManagedIFrame.Manager.deRegister(this)},domWritable:function(){return !!this._windowContext},execScript:function(block,useDOM){try{if(this.domWritable()){if(useDOM){this.writeScript(block)}else{return this._windowContext.eval(block)}}else{throw"execScript:non-secure context"}}catch(ex){this.fireEvent("exception",this,ex);return false}return true},writeScript:function(G,B){B=Ext.apply({},B||{},{type:"text/javascript",text:G});try{var D,A,F=this.getDocument();if(F&&F.getElementsByTagName){if(!(D=F.getElementsByTagName("head")[0])){D=F.createElement("head");F.getElementsByTagName("html")[0].appendChild(D)}if(D&&(A=F.createElement("script"))){for(var E in B){if(B.hasOwnProperty(E)&&E in A){A[E]=B[E]}}return !!D.appendChild(A)}}}catch(C){this.fireEvent("exception",this,C)}return false},loadFunction:function(D,B,C){var A=D.name||D;var D=D.fn||window[D];this.execScript(A+"="+D,B);if(C){this.execScript(A+"()")}},showMask:function(D,C,B){var A;if((A=this.loadMask)&&(!A.disabled||B)){if(A._vis){return }A.masker||(A.masker=Ext.get(A.maskEl||this.dom.parentNode||this.wrap({tag:"div",style:{position:"relative"}})));A._vis=true;A.masker.mask.defer(A.delay||5,A.masker,[D||A.msg,C||A.msgCls])}},hideMask:function(B){var A;if((A=this.loadMask)&&!A.disabled&&A.masker){if(!B&&(A.hideOnReady!==true&&this._domReady)){return }A._vis=false;A.masker.unmask.defer(A.delay||5,A.masker)}},loadHandler:function(B){if(!this.frameInit||(!this._frameAction&&!this.eventsFollowFrameLinks)){return }var A=(B&&typeof B.type!=="undefined"?B.type:this.dom.readyState);switch(A){case"loading":case"interactive":break;case"DOMFrameContentLoaded":if(this._domFired||(B&&B.target!==this.dom)){return }case"domready":if(this._domFired){return }if(this._domFired=this._hooked=this._renderHook()){this._frameAction=(this.fireEvent("domready",this)===false?false:this._frameAction)}case"domfail":this._domReady=true;this.hideMask();break;case"load":case"complete":if(!this._domFired){this.loadHandler({type:"domready"})}this.hideMask(true);if(this._frameAction||this.eventsFollowFrameLinks){this.fireEvent.defer(50,this,["documentloaded",this])}this._frameAction=false;if(this.eventsFollowFrameLinks){this._domFired=this._domReady=false}if(this._callBack){this._callBack(this)}break;default:}},checkDOM:function(D){if(Ext.isOpera){return }var F=0,D=D||this.getWindow(),C=this,B=false,A=100;var E=function(){try{B=false;var I=D.document,G;if(!C._domReady){B=(I&&I.getElementsByTagName);B=B&&(G=I.getElementsByTagName("body")[0])&&!!G.innerHTML.length}}catch(H){F=A}if(!C._frameAction||C._domReady){return }if(F++<A&&!B){setTimeout(arguments.callee,10);return }C.loadHandler({type:B?"domready":"domfail"})};setTimeout(E,50)}});Ext.ux.ManagedIFrame.Manager=function(){var B={},A={};return{shimCls:"x-frame-shim",register:function(C){C.manager=this;return B[C.id]=A[C.dom.name||C.id]=C},deRegister:function(C){delete B[C.id];delete A[C.dom.name||C.id]},hideDragMask:function(){if(!this.shimApplied){return }Ext.select("."+this.shimCls,true).removeClass(this.shimCls+"-on");this.shimApplied=false},showDragMask:function(){if(!this.shimApplied){this.shimApplied=true;Ext.select("."+this.shimCls,true).addClass(this.shimCls+"-on")}},getFrameById:function(C){return B[C]||null},getFrameByName:function(C){return A[C]||null}}}();Ext.ux.ManagedIframePanel=Ext.extend(Ext.Panel,{defaultSrc:null,bodyStyle:{height:"100%",width:"100%",position:"relative"},frameStyle:{overflow:"auto"},frameConfig:null,hideMode:!Ext.isIE?"nosize":"display",shimCls:Ext.ux.ManagedIFrame.Manager.shimCls,shimUrl:null,loadMask:false,animCollapse:Ext.isIE,autoScroll:false,closable:true,ctype:"Ext.ux.ManagedIframePanel",showLoadIndicator:false,unsupportedText:"Inline frames are NOT enabled/supported by your browser.",initComponent:function(){var A=this.unsupportedText?{html:this.unsupportedText}:false;this.bodyCfg||(this.bodyCfg={tag:"div",cls:"x-panel-body",children:[{cls:"x-managed-iframe-mask",children:[Ext.apply(Ext.apply({tag:"iframe",frameborder:0,cls:"x-managed-iframe",style:this.frameStyle||null},this.frameConfig),A,Ext.isIE&&Ext.isSecure?{src:Ext.SSL_SECURE_URL}:false),{tag:"img",src:this.shimUrl||Ext.BLANK_IMAGE_URL,cls:this.shimCls}]}]});this.autoScroll=false;this.items=null;if(this.stateful!==false){this.stateEvents||(this.stateEvents=["documentloaded"])}Ext.ux.ManagedIframePanel.superclass.initComponent.call(this);this.monitorResize||(this.monitorResize=this.fitToParent);this.addEvents({documentloaded:true,domready:true,message:true,exception:true});this.addListener=this.on},doLayout:function(){if(this.fitToParent&&!this.ownerCt){var B=this.getPosition(),A=(Ext.get(this.fitToParent)||this.getEl().parent()).getViewSize();this.setSize(A.width-B[0],A.height-B[1])}Ext.ux.ManagedIframePanel.superclass.doLayout.apply(this,arguments)},beforeDestroy:function(){if(this.rendered){if(this.tools){for(var A in this.tools){Ext.destroy(this.tools[A])}}if(this.header&&this.headerAsText){var B;if(B=this.header.child("span")){B.remove()}this.header.update("")}Ext.each(["iframe","header","topToolbar","bottomToolbar","footer","loadMask","body","bwrap"],function(C){if(this[C]){if(typeof this[C].destroy=="function"){this[C].destroy()}else{Ext.destroy(this[C])}this[C]=null;delete this[C]}},this)}Ext.ux.ManagedIframePanel.superclass.beforeDestroy.call(this)},onDestroy:function(){Ext.Panel.superclass.onDestroy.call(this)},onRender:function(B,A){Ext.ux.ManagedIframePanel.superclass.onRender.call(this,B,A);if(this.iframe=this.body.child("iframe.x-managed-iframe")){var D=Ext.Element;var E=D[this.hideMode.toUpperCase()]||"x-hide-nosize";Ext.each([this[this.collapseEl],this.floating?null:this.getActionEl(),this.iframe],function(F){if(F){F.setVisibilityMode(E)}},this);if(this.loadMask){this.loadMask=Ext.apply({disabled:false,maskEl:this.body,hideOnReady:true},this.loadMask)}if(this.iframe=new Ext.ux.ManagedIFrame(this.iframe,{loadMask:this.loadMask,showLoadIndicator:this.showLoadIndicator,disableMessaging:this.disableMessaging,style:this.frameStyle})){this.loadMask=this.iframe.loadMask;this.iframe.ownerCt=this;this.relayEvents(this.iframe,["documentloaded","domready","exception","message"].concat(this._msgTagHandlers||[]));delete this._msgTagHandlers}this.getUpdater().showLoadIndicator=this.showLoadIndicator||false;var C=this.ownerCt;while(C){C.on("afterlayout",function(F,I){var G=Ext.ux.ManagedIFrame.Manager,H=false;Ext.each(["north","south","east","west"],function(K){var J;if((J=I[K])&&J.splitEl){H=true;if(!J.split._splitTrapped){J.split.on("beforeresize",G.showDragMask,G);J.split._splitTrapped=true}}},this);if(H&&!this._splitTrapped){this.on("resize",G.hideDragMask,G);this._splitTrapped=true}},this,{single:true});C=C.ownerCt}}this.shim=Ext.get(this.body.child(".x-frame-shim"))},toggleShim:function(){if(this.shim&&this.shimCls){this.shim.toggleClass(this.shimCls)}},afterRender:function(A){var B=this.html;delete this.html;Ext.ux.ManagedIframePanel.superclass.afterRender.call(this);if(this.iframe){if(this.defaultSrc){this.setSrc()}else{if(B){this.iframe.update(typeof B=="object"?Ext.DomHelper.markup(B):B)}}}},sendMessage:function(){if(this.iframe){this.iframe.sendMessage.apply(this.iframe,arguments)}},on:function(B){var D=/^message\:/i,C=null;if(typeof B=="object"){for(var A in B){if(!this.filterOptRe.test(A)&&D.test(A)){C||(C=[]);C.push(A.toLowerCase())}}}else{if(D.test(B)){C=[B.toLowerCase()]}}if(this.getFrame()&&C){this.relayEvents(this.iframe,C)}else{this._msgTagHandlers||(this._msgTagHandlers=[]);if(C){this._msgTagHandlers=this._msgTagHandlers.concat(C)}}Ext.ux.ManagedIframePanel.superclass.on.apply(this,arguments)},setSrc:function(A,B,D){A=A||this.defaultSrc||false;if(!A){return this}if(A.url){D=A.callback||false;B=A.discardUrl||false;A=A.url||false}var C=A||(Ext.isIE&&Ext.isSecure?Ext.SSL_SECURE_URL:"");if(this.rendered&&this.iframe){this.iframe.setSrc(C,B,D)}return this},getState:function(){var A=this.iframe?this.iframe.getDocumentURI()||null:null;return Ext.apply(Ext.ux.ManagedIframePanel.superclass.getState.call(this)||{},A?{defaultSrc:typeof A=="function"?A():A}:null)},getUpdater:function(){return this.rendered?(this.iframe||this.body).getUpdater():null},getFrame:function(){return this.rendered?this.iframe:null},getFrameWindow:function(){return this.rendered&&this.iframe?this.iframe.getWindow():null},getFrameDocument:function(){return this.rendered&&this.iframe?this.iframe.getDocument():null},load:function(B){var A;if(A=this.getUpdater()){if(B&&B.renderer){A.setRenderer(B.renderer);delete B.renderer}A.update.apply(A,arguments)}return this},doAutoLoad:function(){this.load(typeof this.autoLoad=="object"?this.autoLoad:{url:this.autoLoad})}});Ext.reg("iframepanel",Ext.ux.ManagedIframePanel);Ext.ux.ManagedIframePortlet=Ext.extend(Ext.ux.ManagedIframePanel,{anchor:"100%",frame:true,collapseEl:"bwrap",collapsible:true,draggable:true,cls:"x-portlet"});Ext.reg("iframeportlet",Ext.ux.ManagedIframePortlet);Ext.apply(Ext.Element.prototype,{setVisible:function(D,A){if(!A||!Ext.lib.Anim){if(this.visibilityMode==Ext.Element.DISPLAY){this.setDisplayed(D)}else{if(this.visibilityMode==Ext.Element.VISIBILITY){this.fixDisplay();this.dom.style.visibility=D?"visible":"hidden"}else{this[D?"removeClass":"addClass"](String(this.visibilityMode))}}}else{var C=this.dom;var B=this.visibilityMode;if(D){this.setOpacity(0.01);this.setVisible(true)}this.anim({opacity:{to:(D?1:0)}},this.preanim(arguments,1),null,0.35,"easeIn",function(){if(!D){if(B==Ext.Element.DISPLAY){C.style.display="none"}else{if(B==Ext.Element.VISIBILITY){C.style.visibility="hidden"}else{Ext.get(C).addClass(String(B))}}Ext.get(C).setOpacity(1)}})}return this},isVisible:function(A){var B=!(this.getStyle("visibility")=="hidden"||this.getStyle("display")=="none"||this.hasClass(this.visibilityMode));if(A!==true||!B){return B}var C=this.dom.parentNode;while(C&&C.tagName.toLowerCase()!="body"){if(!Ext.fly(C,"_isVisible").isVisible()){return false}C=C.parentNode}return true}});Ext.onReady(function(){var A=Ext.util.CSS,B=[];A.getRule(".x-managed-iframe")||(B.push(".x-managed-iframe {height:100%;width:100%;overflow:auto;}"));A.getRule(".x-managed-iframe-mask")||(B.push(".x-managed-iframe-mask{width:100%;height:100%;position:relative;}"));if(!A.getRule(".x-frame-shim")){B.push(".x-frame-shim {z-index:9000;position:absolute;top:0px;left:0px;background:transparent!important;overflow:hidden;display:none;}");B.push(".x-frame-shim-on{width:100%;height:100%;display:block;zoom:1;}");B.push(".ext-ie6 .x-frame-shim{margin-left:5px;margin-top:3px;}")}A.getRule(".x-hide-nosize")||(B.push(".x-hide-nosize,.x-hide-nosize object,.x-hide-nosize iframe{height:0px!important;width:0px!important;border:none;}"));if(!!B.length){A.createStyleSheet(B.join(" "))}});GO.CheckerWindow=function(B){if(!B){B={}}B.title=GO.lang.reminders;B.maximizable=true;B.layout="fit";B.modal=false;B.resizable=true;B.closeAction="hide";if(!B.width){B.width=400}if(!B.height){B.height=500}B.buttons=[{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];var A=new Ext.menu.Menu({items:[{text:"5 "+GO.lang.strMinutes,handler:function(){this.doTask("snooze_reminders",1800)},scope:this},{text:"10 "+GO.lang.strMinutes,handler:function(){this.doTask("snooze_reminders",1800)},scope:this},{text:"20 "+GO.lang.strMinutes,handler:function(){this.doTask("snooze_reminders",1800)},scope:this},{text:"30 "+GO.lang.strMinutes,handler:function(){this.doTask("snooze_reminders",1800)},scope:this},{text:"1 "+GO.lang.strHour,handler:function(){this.doTask("snooze_reminders",3600)},scope:this},{text:"2 "+GO.lang.strHours,handler:function(){this.doTask("snooze_reminders",7200)},scope:this},{text:"3 "+GO.lang.strHours,handler:function(){this.doTask("snooze_reminders",10800)},scope:this},{text:"1 "+GO.lang.strDay,handler:function(){this.doTask("snooze_reminders",86400)},scope:this},{text:"2 "+GO.lang.strDays,handler:function(){this.doTask("snooze_reminders",2*86400)},scope:this},{text:"3 "+GO.lang.strDays,handler:function(){this.doTask("snooze_reminders",3*86400)},scope:this},{text:"4 "+GO.lang.strDays,handler:function(){this.doTask("snooze_reminders",4*86400)},scope:this},{text:"5 "+GO.lang.strDays,handler:function(){this.doTask("snooze_reminders",5*86400)},scope:this},{text:"6 "+GO.lang.strDays,handler:function(){this.doTask("snooze_reminders",6*86400)},scope:this},{text:"7 "+GO.lang.strDays,handler:function(){this.doTask("snooze_reminders",7*86400)},scope:this}]});B.tbar=[{iconCls:"btn-delete",text:GO.lang.dismiss,handler:function(){this.doTask("dismiss_reminders")},scope:this},{iconCls:"btn-dismiss",text:GO.lang.snooze,menu:A},"-",{iconCls:"btn-select-all",text:GO.lang.selectAll,handler:function(){this.checkerGrid.getSelectionModel().selectAll()},scope:this}];this.checkerGrid=new GO.CheckerPanel();B.items=this.checkerGrid;GO.CheckerWindow.superclass.constructor.call(this,B);this.addEvents({changed:true})};Ext.extend(GO.CheckerWindow,Ext.Window,{doTask:function(A,E){var D=this.checkerGrid.selModel.getSelections();if(!D.length){Ext.MessageBox.alert(GO.lang.strError,GO.lang.noItemSelected)}else{var B=[];for(var C=0;C<D.length;C++){B.push(D[C].get("id"))}Ext.Ajax.request({url:BaseHref+"action.php",params:{task:A,snooze_time:E,reminders:Ext.encode(B)},callback:function(){for(var F=0;F<D.length;F++){this.checkerGrid.store.remove(D[F])}if(!this.checkerGrid.store.getRange().length){this.hide()}},scope:this})}}});GO.CheckerPanel=Ext.extend(function(A){if(!A){A={}}A.layout="fit";A.store=new Ext.data.GroupingStore({reader:new Ext.data.JsonReader({totalProperty:"count",root:"results",id:"id",fields:["id","name","description","link_id","link_type","link_type_name","local_time","iconCls","time"]}),groupField:"link_type_name",sortInfo:{field:"time",direction:"ASC"}});A.cm=new Ext.grid.ColumnModel([{dataIndex:"link_type_name"},{header:"",width:28,dataIndex:"icon",renderer:this.iconRenderer},{header:GO.lang.strTime,dataIndex:"local_time",width:50},{header:GO.lang.strName,dataIndex:"name"}]);A.view=new Ext.grid.GroupingView({hideGroupedColumn:true,groupTextTpl:'{text} ({[values.rs.length]} {[values.rs.length > 1 ? "Items" : "Item"]})',emptyText:GO.lang.strNoItems,showGroupName:false});A.selModel=new Ext.grid.RowSelectionModel();A.loadMask=true;A.autoExpandColumn=3;GO.grid.GridPanel.superclass.constructor.call(this,A);this.on("rowdblclick",function(E,D){var B=E.getSelectionModel();var C=B.getSelected();if(GO.linkHandlers[C.data.link_type]){GO.linkHandlers[C.data.link_type].call(this,C.data.link_id)}else{Ext.Msg.alert(GO.lang.strError,"No handler definded for link type: "+C.data.link_type)}},this)},GO.grid.GridPanel,{iconRenderer:function(C,A,B){return'<div class="go-icon '+B.data.iconCls+' "></div>'}});GO.Checker=function(){this.addEvents({alert:true,startcheck:true,endcheck:true});this.checkerWindow=new GO.CheckerWindow();this.reminderIcon=Ext.get("reminder-icon");this.reminderIcon.setDisplayed(false);this.reminderIcon.on("click",function(){this.checkerWindow.show()},this)};Ext.extend(GO.Checker,Ext.util.Observable,{interval:300000,init:function(){if(this.checkerWindow.isVisible()){this.init.defer(this.interval,this)}else{this.fireEvent("startcheck",this);Ext.Ajax.request({url:BaseHref+"json.php",params:{task:"checker"},callback:function(B,D,A){if(!D){}else{var C=Ext.decode(A.responseText);if(C){this.fireEvent("alert",C);if(C.reminders){this.checkerWindow.checkerGrid.store.loadData({results:C.reminders});if(!this.reminderIcon.isDisplayed()){GO.playAlarm();this.checkerWindow.show();this.reminderIcon.setDisplayed(true)}}else{this.reminderIcon.setDisplayed(false)}}}this.fireEvent("endcheck",this);this.init.defer(this.interval,this)},scope:this})}}});